function _eC(e,t,i){window.error_catcher&&error_catcher.send_error(e,t,i||{});var n="";if("undefined"!=typeof i&&i.trace&&1==getCookie("show_me_debug")){var a="trace"+999999999*Math.random();n='<div style="margin-top:10px;"><a style="color: #0af;padding: 10px 0 0;" onclick="var el=document.getElementById(\''+a+"'); if(el){el.style.display=('none'==el.style.display)?'block':'none';}\">Подробнее &raquo;</a></div><div id=\""+a+'" style="margin-top:10px;display: none;"><ul>';for(var o=0;o<i.trace.length;o++)n+="<li>"+i.trace[o]+"</li>";n+="</ul></div>"}$('<div id="locked_screen" style="overflow:auto"><div class="wnd" style="text-align:left;margin:60px auto;"><div class="header">Ошибка'+(e.code>0?" #"+e.code:"")+'!</div><div style="font-size:16px;margin:30px 0 0;padding: 20px;background: rgba(0,0,0,.05);border-radius: 3px;">'+e.message+"</div>"+n+(t>0?'<div style="color:#ccc;margin-top:10px;font-size:10px;">(catcher '+t+")</div>":"")+'<div class="btn_wrap"><div class="btn-m btn-default btn-ghost" onclick="window.location.href=window.location.href;">Перезагрузить страницу</div></div></div></div>').appendTo($("body")),setTimeout(function(){throw e},0)}function trim(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")}function ge(e){return"string"==typeof e||"number"==typeof e?document.getElementById(e):e}function geByTag(e,t){return(t||document).getElementsByTagName(e)}function geByTag1(e,t){return t=t||document,t.querySelector&&t.querySelector(e)||geByTag(e,t)[0]}function geByClass(e,t,i){if(t=t||document,i=i||"*",!browser.msie8&&t.querySelectorAll&&"*"!=i)return t.querySelectorAll(i+"."+e);var n=[];if(t.getElementsByClassName){var a=t.getElementsByClassName(e);if("*"!=i){i=i.toUpperCase();for(var o=0,r=a.length;o<r;++o)a[o].tagName.toUpperCase()==i&&n.push(a[o]);o=r=null}else n=Array.prototype.slice.call(a);a=null}else{for(var s=geByTag(i,t),l=new RegExp("(^|\\s)"+e+"(\\s|$)"),o=0,r=s.length;o<r;++o)l.test(s[o].className)&&n.push(s[o]);s=l=o=r=0}return n}function geByClass1(e,t,i){return t=t||document,i=i||"*",!browser.msie8&&t.querySelector&&t.querySelector(i+"."+e)||geByClass(e,t,i)[0]}function ce(e,t,i){var n=document.createElement(e);return t&&extend(n,t),i&&setStyle(n,i),n}function re(e){return e=ge(e),e&&e.parentNode&&e.parentNode.removeChild(e),e}function se(e){var t=document.createElement("div");return t.innerHTML=e,t.firstChild}function rs(e,t){return each(t,function(t,i){e=e.replace(new RegExp("%"+t+"%","g"),i)}),e}function insertBefore(e,t){e.parentNode.insertBefore(t,e)}function insertAfter(e,t){e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t)}function domEL(e,t){for(t=t?"previousSibling":"nextSibling";e&&!e.tagName;)e=e[t];return e}function domNS(e){return domEL((e||{}).nextSibling)}function domPS(e){return domEL((e||{}).previousSibling,1)}function domFC(e){return domEL((e||{}).firstChild)}function domLC(e){return domEL((e||{}).lastChild,1)}function domPN(e){return(e||{}).parentNode}function show(e){if(arguments.length>1){for(var t=0;t<arguments.length;++t)show(arguments[t]);t=null}else{if("string"==typeof e&&(e=ge(e)),!e||!e.style)return;if("none"==getStyle(e,"display")){var i=e.olddisplay,n="block",a=e.tagName.toLowerCase();e.style.display=i||"",n=hasClass(e,"inline")?"inline":"tr"!=a||browser.msie()?"table"!=a||browser.msie()?"block":"table":"table-row",e.style.display=e.olddisplay=n,i=n=a=null}}}function hide(e){if(arguments.length>1){for(var t=0;t<arguments.length;++t)hide(arguments[t]);t=null}else{if("string"==typeof e&&(e=ge(e)),!e||!e.style)return;var i=getStyle(e,"display");"none"!=i&&(e.olddisplay=i,e.style.display="none"),i=null}}function isVisible(e){return e=ge(e),!(!e||!e.style)&&"none"!=getStyle(e,"display")}function toggle(e){isVisible(e)?hide(e):show(e)}function isFunction(e){return"[object Function]"===Object.prototype.toString.call(e)}function isArray(e){return"[object Array]"===Object.prototype.toString.call(e)}function intval(e){return e===!0?1:parseInt(e)||0}function floatval(e){return e===!0?1:parseFloat(e)||0}function each(e,t){var i,n=0,a=e.length;if(void 0===a){for(i in e)if(t.call(e[i],i,e[i])===!1)break}else for(var o=e[0];n<a&&t.call(o,n,o)!==!1;o=e[++n]);return e}function extend(){var e,t=arguments,i=t[0]||{},n=1,a=t.length,o=!1;for("boolean"==typeof i&&(o=i,i=t[1]||{},n=2),"object"==typeof i||isFunction(i)||(i={});n<a;++n)if(null!=(e=t[n]))for(var r in e){var s=i[r],l=e[r];i!==l&&(o&&l&&"object"==typeof l&&!l.nodeType?i[r]=extend(o,s||(null!=l.length?[]:{}),l):void 0!==l&&(i[r]=l))}return i}function hasClass(e,t){return e=ge(e),e&&new RegExp("(\\s|^)"+t+"(\\s|$)").test(e.className)}function hotKeysIsAllowed(){return!hasClass(document.documentElement,"wind_opened")}function addClass(e,t){if(isArray(e)){for(var i in e)addClass(e[i],t);return void(i=null)}"string"==typeof e&&(e=ge(e)),e.className||(e.className=""),hasClass(e,t)||(e.className=(e.className?e.className+" ":"")+t)}function removeClass(e,t){if(isArray(e)){for(var i in e)removeClass(e[i],t);return void(i=null)}"string"==typeof e&&(e=ge(e)),e&&(e.className=trim((e.className||"").replace(new RegExp("(\\s|^)"+t+"(\\s|$)")," ")))}function toggleClass(e,t,i){return"undefined"==typeof i&&(i=!hasClass(e,t)),window[i?"addClass":"removeClass"](e,t)}function closest(e,t){if(!e)return null;for(var i=e,n=0;;){if(!i.parentNode)return null;if(i=i.parentNode,!i||"body"===i.nodeName.toLowerCase()||++n>100){i=null;break}if(hasClass(i,t))break}return n=null,i}function getStyle(e,t,i){if(e=ge(e),isArray(t)){var n={};return each(t,function(t,i){n[i]=getStyle(e,i)}),n}if(void 0===i&&(i=!0),!i&&"opacity"==t&&browser.msie){var a=e.style.filter;return a?a.indexOf("opacity=")>=0?parseFloat(a.match(/opacity=([^)]*)/)[1])/100+"":"1":""}if(!i&&e.style&&(e.style[t]||"height"==t))return e.style[t];var o,r=document.defaultView||window;if(r.getComputedStyle){t=t.replace(/([A-Z])/g,"-$1").toLowerCase();var s=r.getComputedStyle(e,null);s&&(o=s.getPropertyValue(t))}else if(e.currentStyle){if("opacity"==t&&browser.msie){var a=e.currentStyle.filter;return a&&a.indexOf("opacity=")>=0?parseFloat(a.match(/opacity=([^)]*)/)[1])/100+"":"1"}var l=t.replace(/\-(\w)/g,function(e,t){return t.toUpperCase()});if(o=e.currentStyle[t]||e.currentStyle[l],"auto"==o&&(o=0),!/^\d+(px)?$/i.test(o)&&/^\d/.test(o)){var d=e.style,c=d.left,u=e.runtimeStyle.left;e.runtimeStyle.left=e.currentStyle.left,d.left=o||0,o=d.pixelLeft+"px",d.left=c,e.runtimeStyle.left=u}}if(i&&("width"==t||"height"==t)){var f=getSize(e,!0)[{width:0,height:1}[t]];o=(intval(o)?Math.max(floatval(o),f):f)+"px"}return o}function setStyle(e,t,i){if(e=ge(e)){if("object"==typeof t)return each(t,function(t,i){setStyle(e,t,i)});if("opacity"==t)browser.msie&&((i+"").length?1!==i?e.style.filter="alpha(opacity="+100*i+")":e.style.filter="":e.style.cssText=e.style.cssText.replace(/filter\s*:[^;]*/gi,""),e.style.zoom=1),e.style.opacity=i;else{var n="number"==typeof i;n&&/height|width/i.test(t)&&(i=Math.abs(i)),e.style[t]=n&&!/z-?index|font-?weight|opacity|zoom|line-?height/i.test(t)?i+"px":i}}}function attr(e,t,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&2!==e.nodeType){if("undefined"==typeof i){if("undefined"==typeof e.getAttribute)throw"elem has no getAttribute";return e.getAttribute(t)}if(null!==i){try{e.setAttribute(t,i+"")}catch(t){try{e.name=i+""}catch(e){}}return i}e.removeAttribute(t)}}function getWindowSize(){return{width:window.innerWidth||document.documentElement.clientWidth||document.getElementsByTagName("body")[0].clientWidth,height:window.innerHeight||document.documentElement.clientHeight||document.getElementsByTagName("body")[0].clientHeight}}function rnd(){return window.rnd_seed=(9301*window.rnd_seed+49297)%233280,window.rnd_seed/233280}function random(e){return Math.ceil(rnd()*e)}function irand(e,t){return Math.floor(rand(e,t))}function consoleDbg(e){window.dbgMode&&window.console&&console.log(e)}function cwarn(){if(window.dbgMode&&window.console){var e=Array.prototype.slice.call(arguments);console.warn.apply(window,e)}}function getRandomInt(e,t){return Math.floor(Math.random()*(t-e+1))+e}function genPass(e,t){e=e||7,t=t||"qwertyuiopasdfghjklzxcvbnm0123456789";for(var i=t.length,n="",a=0;a<e;a++){for(;;){var o=t[getRandomInt(0,i-1)];if(n.substr(-1,1)!=o)break}n+=o}return n}function isset(e){return"undefined"!=typeof e}function extendClass(e,t){e.prototype=new t,e.prototype.constructor=e}function htmlentities(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function htmlspecialchars(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function htmlspecialchars_decode(e,t){var i=0,n=0,a=!1;"undefined"==typeof t&&(t=2),e=e.toString().replace(/&lt;/g,"<").replace(/&gt;/g,">");var o={ENT_NOQUOTES:0,ENT_HTML_QUOTE_SINGLE:1,ENT_HTML_QUOTE_DOUBLE:2,ENT_COMPAT:2,ENT_QUOTES:3,ENT_IGNORE:4};if(0===t&&(a=!0),"number"!=typeof t){for(t=[].concat(t),n=0;n<t.length;n++)0===o[t[n]]?a=!0:o[t[n]]&&(i|=o[t[n]]);t=i}return t&o.ENT_HTML_QUOTE_SINGLE&&(e=e.replace(/&#0*39;/g,"'")),a||(e=e.replace(/&quot;/g,'"')),e=e.replace(/&amp;/g,"&")}function setcookie(e,t,i,n,a,o){document.cookie=e+"="+escape(t)+(i?"; expires="+new Date(i):"")+(n?"; path="+n:"")+(a?"; domain="+a:"")+(o?"; secure":"")}function _initCookies(){window._cookies={};for(var e=document.cookie.split(";"),t=0,i="",n="",a=0,o=e.length;a<o;a++)t=e[a].indexOf("="),t>0&&(i=e[a].substr(0,t),n=e[a].substr(t+1),window._cookies[trim(i)]=unescape(trim(n)))}function getCookie(e){return _initCookies(),window._cookies[e]}function setCookie(e,t,i,n){var a="";if(i){var o=new Date;o.setTime(o.getTime()+24*i*60*60*1e3),a="; expires="+o.toGMTString()}document.cookie=e+"="+escape(t)+a+"; path=/"+(window.baseDomain?"; domain=."+window.baseDomain:"")+(n&&window.isHttps?"; secure":"")}function clone(e){if(null==e||"object"!=typeof e)return e;if(e instanceof Date){var t=new Date;return t.setTime(e.getTime()),t}if(e instanceof Array){for(var t=[],i=0,n=e.length;i<n;i++)t[i]=clone(e[i]);return t}if(e instanceof Object){var t={};for(var a in e)e.hasOwnProperty(a)&&e[a]!==document&&(t[a]=clone(e[a]));return t}throw new Error("Unable to copy obj! Its type isn't supported.")}function generateUUID(){var e=(new Date).getTime(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var i=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?i:7&i|8).toString(16)});return t}function fileUploaded(e){isset(e.type)&&FE.run("file_uploaded_"+e.type,e)}function fileUploadFail(e){isset(e.type)&&FE.run("file_upload_fail_"+e.type,e)}function makeBtnDisabled(e,t){return"undefined"==typeof $(e).data("clicked")&&(t=t||"Загружается...",$(e).val(t).text(t).addClass("disabled").data("clicked",!0),!0)}function toggleDropdown(e){$(".dropdown_part:visible").hide();var t=$(e).closest(".inp_wrap"),i=t.children(".dropdown_part");i.css({width:t.width()}),i.removeClass("dropped_down dropped_up"),t.offset().top+t.outerHeight()+i.outerHeight()<$(window).height()?(i.css({top:t.outerHeight()-1}),i.addClass("dropped_down")):(i.css({top:-i.outerHeight()}),i.addClass("dropped_up")),i.show()}function initDropdown(){window.curDropDown=null;var e=$("html");e.click(function(){$(".dropdown_part:visible").hide()}),e.find(".dropdown_part").click(function(e){$(this).is(":visible")&&e.stopPropagation()}),e.find(".joined").click(function(e){$(this).closest(".sel_wrap").find(".dropdown_part").is(":visible")&&e.stopPropagation()})}function setStateCookie(e,t){"function"==typeof $.cookie&&($.removeCookie(e),$.cookie(e,t,{expires:360,path:"/"}))}function ColorLuminance(e,t){e=String(e).replace(/[^0-9a-f]/gi,""),e.length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),t=t||0;var i,n,a="#";for(n=0;n<3;n++)i=parseInt(e.substr(2*n,2),16),i=Math.round(Math.min(Math.max(0,i+i*t),255)).toString(16),a+=("00"+i).substr(i.length);return a}function convertToHex(e){var t={hex:null,opacity:1};if(/(^#?[0-9A-F]{6}$)|(^#?[0-9A-F]{3}$)/i.test(e))t.hex="#"+e.replace("#","");else{var i=e.match(/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(.+)\)$/);if(i)t.hex="#"+("0"+parseInt(i[1],10).toString(16)).slice(-2)+("0"+parseInt(i[2],10).toString(16)).slice(-2)+("0"+parseInt(i[3],10).toString(16)).slice(-2),t.opacity=parseFloat(i[4]);else if("transparent"==e)t.opacity=0;else{var n=rgb2hex(e);null!=n&&(t.hex=n)}}return(null==t.opacity||isNaN(t.opacity))&&(t.opacity=1),t}function rgb2hex(e){return e?(e=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),e?"#"+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2):null):null}function hex2rgb(e){var t=parseInt(e.indexOf("#")>-1?e.substring(1):e,16),i=t>>16,n=(65280&t)>>8,a=255&t;return[i,n,a]}function rgba2parts(e){var t,i,n="#FFFFFF",a=1;return null!=e&&(i=e.match(/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(.+)\)$/),i?(n="#"+("0"+parseInt(i[1],10).toString(16)).slice(-2)+("0"+parseInt(i[2],10).toString(16)).slice(-2)+("0"+parseInt(i[3],10).toString(16)).slice(-2),a=parseFloat(i[4]),(null==a||isNaN(a))&&(a=1)):"transparent"==e?a=0:(t=rgb2hex(e),null!=t&&(n=t))),{color:n,opacity:a}}function escapeRus(e){var t=[];e+="";for(var i=1040;i<=1103;i++)t[i]=i-848;t[1025]=168,t[1105]=184;var n=[];for(i=0;i<e.length;i++){var a=e.charCodeAt(i);"undefined"!=typeof t[a]&&(a=t[a]),a<=255&&(n[i]=escape(String.fromCharCode(a))),8470==a&&(n[i]="%B9"),43==a&&(n[i]="%2B")}return n.join("")}function getUrlVars(){var e=window.location.href.slice(window.location.href.indexOf("?")+1);if(""==e||window.baseUrl==e)return e=null,{};for(var t,i={},n=e.split("&"),a=0;a<n.length;a++)t=n[a].split("="),i[t[0]]=t[1];return t=n=e=null,i}function jAlert(e,t){t=$.extend({id:"jAlert",html:!0,showCloseBtn:!1,width:!1,okText:!1,btnCls:"ibtn-blue",btnWidth:100,onOk:function(){},headerText:!1,hideOnBlackoutClick:!1,alertClass:"",mobileAdapt:!1},t);var i=$("#"+t.id);if(i.length){if(i.attr("class",i.attr("class").replace(/^custom-/g,"")),t.alertClass.length)for(var n=t.alertClass.split(/\s+/g),a=0,o=n.length;a<o;a++)i.addClass("custom-"+n[a]);!1!==t.headerText?i.find(".iblk_header").show().find(".h5-fake").text(t.headerText):i.find(".iblk_header").hide(),i.find(".wind-btn-apply").text(t.okText||"OK").attr("class","btn wind-btn-apply "+t.btnCls).css("width",t.btnWidth),i.find("#jAlertBody")[!0===t.html?"html":"text"](e),i.wind("setApplyFunc",function(){t.onOk()}),t.onCancel&&"function"==typeof t.onCancel&&(i.wind("setCancelFunc",t.onCancel),i.wind("setCloseFunc",t.onCancel)),t.hideOnBlackoutClick&&i.on("click",function(){return!1}),!1!==t.width&&i.css({width:t.width}),t.mobileAdapt&&quizMobileView.adaptWind(i),i.wind("show")}i=null}function jConfirm(e,t,i){t=$.extend({width:500,html:!0,okText:"OK",cancelText:"Отмена",btnWidth:94,okClass:"ibtn-green",cancelClass:"",onOk:function(){},onCancel:function(){},headerText:!1,showClose:!0},t);var n;n=i===!0?$("#"+t.id):$("#jConfirm"),n.length&&(!1!==t.headerText?n.find(".iblk_header").show().find(".h5-fake").text(t.headerText):n.find(".iblk_header").hide(),!0===t.html?n.find("#jConfirmBody").html(e):n.find("#jConfirmBody").text(e),n.find("#jConfirmOk").attr("class","ibtn wind-btn-apply "+t.okClass).text(t.okText).css("min-width",t.btnWidth),n.find("#jConfirmCancel").attr("class","ibtn wind-btn-cancel ml1 "+t.cancelClass).text(t.cancelText).css("min-width",t.btnWidth),n.find(".wind-close")[t.showClose?"show":"hide"](),n.css({width:t.width}),n.wind("setApplyFunc",t.onOk),n.wind("setCancelFunc",t.onCancel),t.onClose&&"function"==typeof t.onClose?n.wind("setCloseFunc",t.onClose):n.wind("setCloseFunc",t.onCancel),n.wind("show")),n=null}function showDoneBox(e,t){var i=$('<div class="pp_mes_wrap"><div class="pp_mes">'+e+"</div></div>");t=$.extend({width:380,top:"40%",fadeIn:100,showTime:2e3,fadeOut:500,cls:"",el:i},t),i.css({width:t.width,"margin-left":-1*Math.round(t.width/2),top:t.top,opacity:0}),t.cls.length&&i.addClass(t.cls),i.appendTo($("body")),i.animate({opacity:1},t.fadeIn,function(){setTimeout(function(){t.el.animate({opacity:0},t.fadeOut,function(){$(this).remove()})},t.showTime)}),i=null}function goTo(e){window.location.href=window.baseUrl+e}function getUrl(){return window.location.href.replace(window.baseUrl,"")}function if_var_val(e,t,i){for(var n in t)if(e==n)return n=null,t[n];return n=null,i||!1}function plural(e,t,i,n){if(e<0&&(e=-1*e),"undefined"==typeof n)return 1==e?t:i;var a=e%10,o=e%100;return 1==e||1==a&&11!=o?(a=o=null,t):a>1&&a<5&&12!=o&&13!=o&&14!=o?(a=o=null,i):(a=o=null,n)}function strtr(e,t){for(var i in t)e=e.replace(new RegExp(i,"g"),t[i]);return i=null,e}function number_format(e,t,i,n){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var a=isFinite(+e)?+e:0,o=isFinite(+t)?Math.abs(t):0,r="undefined"==typeof n?" ":n,s="undefined"==typeof i?".":i,l="",d=function(e,t){var i=Math.pow(10,t);return""+Math.round(e*i)/i};return l=(o?d(a,o):""+Math.round(a)).split("."),l[0].length>3&&(l[0]=l[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,r)),(l[1]||"").length<o&&(l[1]=l[1]||"",l[1]+=new Array(o-l[1].length+1).join("0")),l.join(s)}function formatFileSize(e,t){if(0==e)return"0 байт";"undefined"==typeof t&&(t=0);var i=t+1||3,n=["байт","KB","MB","GB","TB","PB","EB","ZB","YB"],a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(i))+" "+n[a]}function reachGoal(e){if("undefined"!=typeof window.Ya){var t;if("undefined"!=typeof Ya.Metrika2)t=Ya.Metrika2.counters();else{if("undefined"==typeof Ya.Metrika)return void slackErrorDump(new Error("Error #4911"));t=Ya.Metrika.counters()}for(var i in t)window["yaCounter"+t[i].id]?(window["yaCounter"+t[i].id].reachGoal(e),consoleDbg("reachGoal "+e)):consoleDbg("notFound yaCounter"+t[i].id);t=i=null}}function reachGoalByAttr(e,t){var i=e.attr(t);"undefined"!=typeof i&&i.length&&reachGoal(i),i=null}function popoverForm(e){try{var t=$(e),i=t.closest(".blk"),n=t.closest(".blk_form_wrap"),a=$("#formPopover"),o=a.children(".wind-body");if(o.children("form").hide(),n.hasClass("is_popover")){var r=n.children("form.user_form"),s=t.parent().hasClass("quiz-form");r.length?r.appendTo(a).addClass("is_popover"):r=a.children("form[id=frm"+i.attr("id")+"]"),s?(a.addClass("quiz-form").parent().css("overflow-y","auto"),quizMobileView.toQuizView(r)):a.removeClass("quiz-form").parent().removeAttr("style");var l=a.find(".user_form_regulation");1===l.data("is-regulation-enabled")&&l.addClass("hidden"),r.length&&(reachGoalByAttr(r,"goal-popover"),a.children().hide(),r.show(),a.wind("show"),s&&(quizMobileView.getSmartHeader().recalcHeaderHeight(),sitesMan.adaptQuizContent(sitesMan.quizForm(a))))}}catch(e){consoleDbg(e)}return!1}function initSlick(e){var t=e.find(".slider:first"),i=e.closest(".blk_box_slider");if(i.find(".slide").removeClass("hidden-slide"),t.hasClass("slick-initialized"))return t.slick("unslick"),void t.slick(adapterManager.slickOpt[i.attr("id")]);var n=e.children(".settings-slick:first"),a={touchMove:!1,infinite:!0,speed:parseInt(n.attr("slide-aspeed"))||300,dots:1===parseInt(n.attr("slide-circle")),customPaging:function(){return"<p>&nbsp;</p>"},arrows:1===parseInt(n.attr("slide-arrow")),nextArrow:'<div class="next-slide"><div></div></div>',prevArrow:'<div class="prev-slide"><div></div></div>',slidesToShow:1};1===parseInt(n.attr("slide-auto"))&&1!=n.attr("in-af")&&(a.autoplay=!0,a.autoplaySpeed=1e3*parseFloat(n.attr("slide-pspeed"))||2e3),"crossfade"==n.attr("slide-anim")&&(a.fade=!0,a.cssEase="linear"),t.slick(a),window.animManager.onScroll(),window.adapterManager.slickOpt[i.attr("id")]=a}function hideSectionPopup(e){var t=$("#popup_list > #"+e),i=/\?af_popup/i.test(window.location.href);return!i&&(t.removeClass("open"),window._isEditor||t.find(".blk.blk_video .video.autoplay iframe").each(function(){$(this).attr("src","")}),reInitVideoIFrame(t),window.active_fixed_sections&&$.each(window.active_fixed_sections,function(){$(this).css({"z-index":999})}),$("body").css("margin-right",0).removeClass("open_popup"),$("body>.navbar>.navbar-inner").css("padding-right",0),void FE.run("sectionPopup_hide"))}function clickButtonLink(e,t,i){insertJavaScript(e,t,function(){var e=$(i);e.attr("href")&&("_blank"==e.attr("target")?window.open(e.attr("href")):window.location.href=e.attr("href"))})}function insertJavaScript(e,t,i){if(!e||!t)return void("function"==typeof i&&i());var n=document.getElementById(t);return n?void("function"==typeof i&&i()):(n=document.createElement("script"),n.type="text/javascript",n.src=e,n.id=t,"function"==typeof i&&(n.onload=i),void document.getElementsByTagName("body")[0].appendChild(n))}function btnPopupWnd(e){var t=$(e).closest(".blk"),i=t.attr("id"),n=$("#btnPopupWnd"),a=n.attr("cur-blk"),o=t.find(".wnd_data:first");if("undefined"==typeof a||a!=i){var r=parseInt(o.attr("wnd_width"))||600;"undefined"==typeof adapterManager||adapterManager.isPC()||(r=adapterManager.getSettings(adapterManager.type).window_popover_width),n.width(r),n.find(".wind-header h3, .wind-header .div_h3").text(o.find(".wnd_data_title").text()),n.find(".wind-body").html(o.find(".wnd_data_text").html()),n.attr("cur-blk",i),consoleDbg("btnPopupWnd: move content")}n.wind("show"),n=null}function showExpiredWind(e){var t=$("#sessionExpired form#frmlogin");t.find("#frmlogin__magic").val(e),$("#sessionExpired").wind("show").find("#frmlogin__username").focus()}function ExpiredWindbeforeSend(){var e=$("#sessionExpired #frmlogin__password"),t=$("#sessionExpired #frmlogin__magic");e.val($.sha1($.sha1(e.val())+t.val())),e=t=null}function truncate(e,t){return"string"==typeof e?e.length<t?e:e.slice(0,t):e}function arrayRemoveByName(e,t){var i=e.indexOf(t),n=!1;return-1!=i&&(e=e.splice(i,1),n=!0),i=null,n}function arrayInsertBeforeItem(e,t,i){var n=e.indexOf(t),a=!1;return-1!=n&&(e.splice(n,0,i),a=!0),n=null,a}function arrayInsertAfterItem(e,t,i){var n=e.indexOf(t),a=!1;return-1!=n&&(n==e.length-1?e.push(i):e.splice(n+1,0,i),a=!0),n=null,a}function arrayInsertItemUniq(e,t){-1==e.indexOf(t)&&e.push(t)}function arrayMoveItemBefore(e,t,i){return!(!arrayRemoveByName(e,t)||!arrayInsertBeforeItem(e,i,t))}function arrayMoveItemAfter(e,t,i){return!(!arrayRemoveByName(e,t)||!arrayInsertAfterItem(e,i,t))}function arraySubset(e,t,i){var n=e.indexOf(t),a=e.indexOf(i),o=[];return-1!=n&&-1!=a&&(n>a&&(n+=a,a=n-a,n-=a),o=e.slice(n,a+1)),n=a=null,o}function guid(){return uuid.v4().replace(/-/g,"")}function ajaxLoad(ops){var o={type:"POST",ops:ops,cache:!1,timeout:4e4,url:window.baseUrl+ops.url,dataType:"json",data:ops.data?ops.data:null,beforeSend:function(e,t){this.ops.onBeforeSend&&"function"==typeof this.ops.onBeforeSend&&this.ops.onBeforeSend(this.ops)},success:function(data){if(!this.ops.onBeforeSuccess||"function"!=typeof this.ops.onBeforeSuccess||this.ops.onBeforeSuccess(data,this.ops)){if(isset(data.error)&&("object"==typeof data.error.name?alert(data.error.name):alert(data.error)),data.html&&this.ops.block&&$(this.ops.block).html(data.html),isset(data.script))try{eval(data.script)}catch(e){window.console&&window.dbgMode&&(console.log(e),console.log("[_Ошибка JS_] "+e.stack),alert("Смотри ошибку в консоли"))}this.ops.onSuccess&&"function"==typeof this.ops.onSuccess&&this.ops.onSuccess(data,this.ops),window.dbgMode&&console.log(data)}},error:function(e,t,i){switch(console.log(t),t){case"timeout":alert("Ошибка! Нет связи с сервером. Проверьте подключение к интернету и попробуйте снова.");break;case"error":case"parsererror":alert("Извините, на сервере возникла ошибка!\n\nПожалуйста, напишите нам в тех-поддержку support@lpmotor.ru"),window.dbgMode&&(console.log(e),console.log(i))}}};return beforeQueryAjax(o,ops),$.ajax(o)}function beforeQueryAjax(e,t){var i=getCsrfHeaderName(),n=getCsrfCookieName(),a=getCookie(n);a&&(e.headers||(e.headers={}),e.headers[i]=a,t.withCredentials=!0),t.withCredentials&&(e.xhrFields={withCredentials:!0},delete t.withCredentials)}function getCsrfHeaderName(){return"X-Csrf-Token"}function getCsrfCookieName(){return"csrf_token"}function getAxios(e){if(!axios)return consoleDbg("axios is undefined"),{request:function(e){},get:function(e,t){},delete:function(e,t){},head:function(e,t){},options:function(e,t){},post:function(e,t,i){},put:function(e,t,i){},patch:function(e,t,i){}};e||(e={}),e.headers||(e.headers={}),e.headers["X-Requested-With"]="XMLHttpRequest",e.xsrfHeaderName=getCsrfHeaderName(),e.xsrfCookieName=getCsrfCookieName();var t=getCookie(e.xsrfCookieName);return t&&(e.headers[e.xsrfHeaderName]=t,e.withCredentials=!0),axios.create(e)}function scrollTop(){return document.body.scrollTop||document.documentElement.scrollTop}function cancelEvent(e){if(e=e||window.e,!e)return!1;for(;e.originalEvent;)e=e.originalEvent;return e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0,e.returnValue=!1,!1}function initTabs(e,t){if(t=extend({itemTag:"a",tabsClass:"itab",activeClass:"active",tabsContainer:null},t),"string"==typeof e&&(e=$(e)),e.length&&!e.hasClass("itabs-inited")){var i=e.children(t.itemTag);i.length&&(i.click({ops:t},function(e){var i=$(this),n="."+t.tabsClass+"[id="+i.attr("itab-id")+"]",a=null;null===t.tabsContainer?a=$(n):("string"==typeof t.tabsContainer&&(t.tabsContainer=$(t.tabsContainer)),t.tabsContainer.length&&(a=t.tabsContainer.children(n))),a.length&&(a.parent().children("."+t.tabsClass+"."+t.activeClass).removeClass(t.activeClass),a.addClass(t.activeClass),i.parent().children(t.itemTag+"."+t.activeClass).removeClass(t.activeClass),i.addClass(t.activeClass)),e.preventDefault(),e.stopPropagation(),i=a=n=null}),e.addClass("itabs-inited")),i=null}}function helpSlider(e,t){var i="string"==typeof e?$(e):e;if(i.length){i.addClass("help-slider-inited"),i.find(".prev_slide, .next_slide").click(function(){helpSliderRoll($(this).closest(".help-slider-inited"),$(this).hasClass("next_slide")?"next":"prev")});var n=i.find(".slides_container");n.css({overflow:"hidden",position:"relative"}),n.children().css({cursor:"pointer"}).click(function(){helpSliderRoll($(this).closest(".help-slider-inited"),"next")})}i=null}function helpSliderRoll(e,t){var i=e.find(".slides_container"),n=i.children(),a=n.filter(":visible"),o=null,r=null,s=a.height();if(!a.is(":animated"))if(i.css({height:s}),a.css({position:"absolute",top:0,left:0}),"prev"===t){if(o=a.prev(),!o.length)return;r=o.width(),o.css({position:"absolute",opacity:1,left:-r}).show(),a.animate({left:r,opacity:.5},400,function(){$(this).hide()}),o.animate({left:0},400,function(){$(this).css({position:"static"})}),0==o.prev().length&&o.closest(".help-slider-inited").find(".prev_slide").hide(),o.closest(".help-slider-inited").find(".next_slide").show()}else if("next"===t){if(o=a.next(),!o.length)return;r=o.width(),o.css({position:"absolute",opacity:1,left:r}).show(),a.animate({left:-r,opacity:.5},400,function(){$(this).hide()}),o.animate({left:0},400,function(){$(this).css({position:"static"})}),0==o.next().length&&o.closest(".help-slider-inited").find(".next_slide").hide(),o.closest(".help-slider-inited").find(".prev_slide").show()}i=n=a=o=r=s=null}function initImgSlider(e){return e=extend({obj:null,editorMode:!0,showBalls:!1,delayBeforeChange:2e3,changeOnClick:!1,changeSpeed:1e3,changeType:"slide",pauseOnHover:!0},e),null===e.obj?0:"string"!=typeof e.obj||(e.obj=$(e.obj),e.obj.length)?(e._animating=!1,e.$slider=e.obj.find(".slider_images:first"),e.$ar_L=e.$slider.find(".arrow_left:first"),e.$ar_R=e.$slider.find(".arrow_right:first"),e.$balls=e.$slider.find(".balls:first"),e.$imgs=e.$slider.find(".imgs:first"),e.$resizer=e.$slider.find(".imgslider_resizer:first"),window.imgSlider?++window.imgSlider.cnt:window.imgSlider={cnt:1,collection:{}},window.imgSlider.collection[window.imgSlider.cnt]=e,e._cnt=window.imgSlider.cnt,e.$slider.attr("slider",window.imgSlider.cnt),e.showBalls&&e.$balls.show(),e.$ar_L.click(function(){imgSliderChange(parseInt($(this).closest(".slider_images").attr("slider")),"prev")}),e.$ar_R.click(function(){imgSliderChange(parseInt($(this).closest(".slider_images").attr("slider")),"next")}),e.pauseOnHover&&e.$slider.find(".arrow,.imgs:first").mouseover(function(){imgSliderKillTimer($(this).closest(".slider_images").addClass("over_slide").attr("slider"))}).mouseout(function(){imgSliderSetTimer($(this).closest(".slider_images").removeClass("over_slide").attr("slider"))}),e.editorMode?(e.delayBeforeChange=0,e.$resizer.show(),$(document).mousedown(function(e){$(e.target).hasClass("imgslider_resizer")&&(window.imgSliderResize=!0,window.imgSliderResizeTop=e.pageY,window.imgSliderResizeH=$())}),$(document).mousemove(function(e){window.imgSliderResize&&console.log("move ",e.pageY-window.imgSliderResizeTop)}),$(document).mouseup(function(e){window.imgSliderResize&&(window.imgSliderResize=!1,console.log("stop ",e.pageY-window.imgSliderResizeTop),window.imgSliderResizeTop=null)})):imgSliderSetTimer(e),"ok"):1}function imgSliderSetTimer(e){if("string"==typeof e){if(e=parseInt(e),!window.imgSlider.collection[e])return;e=window.imgSlider.collection[e]}e.delayBeforeChange&&(e._timer&&clearTimeout(e._timer),e._timer=setTimeout("imgSliderChange("+e._cnt+",'next');",e.delayBeforeChange))}function imgSliderKillTimer(e){if("string"==typeof e){if(e=parseInt(e),!window.imgSlider.collection[e])return;e=window.imgSlider.collection[e]}e._timer&&clearTimeout(e._timer),e._timer="off"}function imgSliderChange(e,t){console.log("run slider animation. id=",e,", direction=",t);var i=window.imgSlider.collection[e];if(!i._animating){switch(i.changeType){case"slide":i._animating=!0;var n=i.$imgs.children("a:visible"),a=null,o=i.$imgs.width();"next"==t?(a=n.next(),a.length||(a=i.$imgs.children("a:first")),a.css({left:o}).show(),n.animate({left:-o},i.changeSpeed,function(){$(this).hide(),window.imgSlider.collection[e]._animating=!1}),a.animate({left:0},i.changeSpeed)):"prev"==t&&(a=n.prev(),a.length||(a=i.$imgs.children("a:last")),a.css({left:-o}).show(),n.animate({left:o},i.changeSpeed,function(){$(this).hide(),window.imgSlider.collection[e]._animating=!1}),a.animate({left:0},i.changeSpeed)),n=a=o=null}i.$slider.hasClass("over_slide")||imgSliderSetTimer(i)}i=null}function enlargeImage(e){function t(e){var t=$('<div class="svg_wrap"><div class="svg_container"></div> </div>');return t.find(".svg_container").append(e),t}function i(e){_eh.origSize={w:$(this).get(0).naturalWidth,h:$(this).get(0).naturalHeight},"svg"===n?_eh.$newImg=t(e.firstElementChild):_eh.$newImg=$(this),_eh.wndSize={w:_eh.$wnd.width()-2*_eh.step,h:_eh.$wnd.height()-2*_eh.step},_eh.newSize={w:0,h:0,x:0,y:0},_eh.origSize.w>_eh.wndSize.w&&_eh.origSize.h>_eh.wndSize.h&&(_eh.origSize.h=_eh.wndSize.w*_eh.origSize.h/_eh.origSize.w,_eh.origSize.w=_eh.wndSize.w),_eh.origSize.w<=_eh.wndSize.w&&_eh.origSize.h<=_eh.wndSize.h?(_eh.newSize.w=_eh.origSize.w,_eh.newSize.h=_eh.origSize.h,_eh.newSize.x=Math.floor((_eh.wndSize.w-_eh.origSize.w)/2)+_eh.step,_eh.newSize.y=Math.floor((_eh.wndSize.h-_eh.origSize.h)/2)+_eh.step):_eh.origSize.w>_eh.wndSize.w&&_eh.origSize.h<=_eh.wndSize.h?(_eh.newSize.w=_eh.wndSize.w,_eh.newSize.h=Math.floor(_eh.newSize.w*_eh.origSize.h/_eh.origSize.w),_eh.newSize.x=_eh.step,_eh.newSize.y=Math.floor((_eh.wndSize.h-_eh.newSize.h)/2)+_eh.step):_eh.origSize.w<=_eh.wndSize.w&&_eh.origSize.h>_eh.wndSize.h&&(_eh.newSize.h=_eh.wndSize.h,_eh.newSize.w=Math.floor(_eh.newSize.h*_eh.origSize.w/_eh.origSize.h),_eh.newSize.x=Math.floor((_eh.wndSize.w-_eh.newSize.w)/2)+_eh.step,_eh.newSize.y=_eh.step),"svg"===n&&(_eh.newSize.w=window.innerHeight,_eh.newSize.h=window.innerHeight,_eh.newSize.x=_eh.wndSize.w/2-window.innerHeight/2,_eh.newSize.y=0),_eh.bodyWidth=_eh.$body.width(),_eh.$container.show(),$("html").addClass("wind_opened"),_eh.$body.css("margin-right",_eh.$body.width()-_eh.bodyWidth);scrollTop();_eh.$newImg.appendTo(_eh.$container).css({position:"absolute",display:"block",top:_eh.curSize.y,left:_eh.curSize.x,width:_eh.curSize.w,height:_eh.curSize.h}).animate({left:_eh.newSize.x,top:_eh.newSize.y,width:_eh.newSize.w,height:_eh.newSize.h},_eh.speed)}var n=$(e).attr("src").split(".").pop();if(_eh.$body||(_eh.$body=$("body")),
_eh.$wnd||(_eh.$wnd=$(window)),_eh.$container||(_eh.$container=$('<div id="image-enlarge-cont"></div>'),_eh.$container.appendTo(_eh.$body),_eh.$container.click(function(){_eh.$newImg&&_eh.$newImg.animate({top:_eh.curSize.y,left:_eh.curSize.x,width:_eh.curSize.w,height:_eh.curSize.h},_eh.speed,function(){_eh.$container.hide(),$("html").removeClass("wind_opened"),_eh.$body.css("margin-right",0),_eh.$newImg.remove(),_eh.$newImg=!1})})),_eh.$img=$(e),_eh.$img.length){var a=_eh.$img.offset();if(_eh.curSize={w:_eh.$img.width(),h:_eh.$img.height(),x:a.left,y:a.top-scrollTop()},a=null,"svg"==n){var o="undefined"!=typeof _eh.$img.attr("original-src")?_eh.$img.attr("original-src"):_eh.$img.attr("src");$.get(o,i)}else{var r=$(new Image);r.unbind("load").bind("load",i),r.attr("src","undefined"!=typeof _eh.$img.attr("original-src")?_eh.$img.attr("original-src"):_eh.$img.attr("src"))}}}function mxSetup(e){!function(e,t){if(!t.__SV){var i,n,a,o;window.mixpanel=t,t._i=[],t.init=function(e,i,n){function r(e,t){var i=t.split(".");2==i.length&&(e=e[i[0]],t=i[1]),e[t]=function(){e.push([t].concat(Array.prototype.slice.call(arguments,0)))}}var s=t;for("undefined"!=typeof n?s=t[n]=[]:n="mixpanel",s.people=s.people||[],s.toString=function(e){var t="mixpanel";return"mixpanel"!==n&&(t+="."+n),e||(t+=" (stub)"),t},s.people.toString=function(){return s.toString(1)+".people (stub)"},a="disable track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.track_charge people.clear_charges people.delete_user".split(" "),o=0;o<a.length;o++)r(s,a[o]);t._i.push([e,i,n])},t.__SV=1.2,i=e.createElement("script"),i.type="text/javascript",i.async=!0,i.src=("https:"===e.location.protocol?"https:":"http:")+"//cdn.mxpnl.com/libs/mixpanel-2.2.min.js",n=e.getElementsByTagName("script")[0],n.parentNode.insertBefore(i,n)}}(document,window.mixpanel||[]),mixpanel.init("14bbe5ece6a7ad1216c5ea30a5194a28"),window.console&&console.log("Mix Panel init"),"undefined"!=typeof e&&(mixpanel.identify(e),window.console&&console.log("Mix Panel identify id="+e))}function mxt(e,t){return"undefined"==typeof window._kmq?void console.log("Kissmetrics track: ",e,", params: ",t):void("undefined"==typeof t?_kmq.push(["record",e]):_kmq.push(["record",e,t]))}function mxGetSourceLink(){var e=window.location.href.replace(window.baseUrl,""),t=null;return t=""==e||"sites/list"==e?"раздел Сайты":"sites/create"==e?"раздел Создание сайта":"profile/balance"==e?"раздел Баланс":e.indexOf("pages/edit")>0?"раздел Редактор сайта":e,e=null,t}function getURLParam(e){return decodeURI((RegExp(e+"=(.+?)(&|$)").exec(location.search)||[,null])[1])}function getURLParam2(e){var t=RegExp(e+"=(.+?)(&|$)").exec(location.search);return null!==t&&"undefined"!=typeof t[1]?t[1]:null}function insertPixel(e){$(document).ready(function(){$("body").append($('<img src="'+e.replace("{order_id}",getURLParam("order_id"))+'" width="1" height="1" style="position: absolute;left:-9999px;"/>'))})}function stVisit(){var e=getCookie("LPmagCode"),t={ref:document.referrer};"undefined"==typeof e?t.new=1:t.id=e,$.ajax({url:window.baseUrl+"stat/visit",data:t,cache:!1,success:function(e){var t=JSON.parse(e);if(console.log(t),"undefined"!=typeof t.res)switch(t.res){case"0":console.log(t.mes);break;case"1":if("undefined"!=typeof t.id)stVisitPropagate(t.id);else{var i=getCookie("_magCode");"undefined"!=typeof i&&stVisitPropagate(i)}}}})}function stVisitPropagate(e){var t,i=["lpmotor.ru","lpmotor.org","bm360.ru","admin.lpmotor.ru"];for(var n in i)t=document.createElement("img"),t.className="mag_img",t.src=("https:"==document.location.protocol?"https:":"http:")+"/"+i[n]+"/stat/magcode.png?id="+e,t.onload=function(){this.parentNode.removeChild(this)},document.getElementsByTagName("body")[0].appendChild(t);t=n=i=null}function stLpcidPropagate(){var e=getCookie("_lpcid");if("undefined"!=typeof e){var t,i,n=document.getElementsByTagName("body")[0];for(t in window._lpcid_hosts)window._lpcid_hosts[t].replace(/^http(|s):\/\//,"")!=document.location.host&&(i=new Image,i.className="mag_img",i.onload=stVisImgRemove,i.src=window._lpcid_hosts[t]+"/stat/cid.gif?v="+e+"&t="+ +new Date,n.appendChild(i));t=i=n=null}}function stVisImgRemove(){this.parentNode&&this.parentNode.removeChild(this)}function stVisImgLoaded(){stLpcidPropagate(),this.parentNode&&this.parentNode.removeChild(this)}function stVis(e){"undefined"==typeof e&&(e="landing");var t=new Image,i=getURLParam2("p");t.className="mag_img",t.onload=stVisImgLoaded,t.src=("https:"==document.location.protocol?"https:":"http:")+"//"+document.location.host+"/stat/vis.gif?type="+e+"&ref="+document.referrer+(null===i?"":"&p="+encodeURI(i))+"&t="+ +new Date,document.getElementsByTagName("body")[0].appendChild(t),t=null}function animInit(){}function createFrame(e,t){var i=document.createElement("iframe");i.className="mag_frame",i.src=e+"/tracer/frame/cid:"+t+"?_="+1*new Date,document.body.appendChild(i)}function gaSpread(e){console.log("gaSpread...");var t=getCookie("_ga_cid");if("undefined"!=typeof t)switch(console.log("gaSpread=",e),createFrame("https://admin.lpmotor.ru",t),e){case"lpmotor":createFrame("http://bm360.ru",t);break;case"bm360":createFrame("http://lpmotor.ru",t)}}function analyticSendEvent(e,t){if(!window.carrotquest)return!1;if(t="undefined"==typeof t?{}:t,"undefined"!=typeof t.delay&&t.delay>0)return setTimeout(function(){analyticSendEvent(e,t)},t.delay),delete t.delay,!0;if("undefined"!=typeof t.check_cookie){var i=getCookie(t.check_cookie);if("undefined"==typeof i)return!1;if("undefined"!=typeof t.value_cookie&&t.value_cookie!=i)return!1}if("undefined"!=typeof t.once&&t.once===!0)try{var n=localStorage.getItem("analytic_event");if(n=null==n||"undefined"==typeof n?{}:JSON.parse(n),"undefined"!=typeof n[e])return!1;n[e]=1,localStorage.setItem("analytic_event",JSON.stringify(n))}catch(e){console.log(e)}carrotquest.track(e,t),dbgMode&&console.log("send event [",e,"] ",t)}function funnelEvent(e,t){$.ajax({url:window.baseUrl+"funnel/event",method:"post",dataType:"json",data:{funnel:e,step:t},success:function(i){"undefined"!=typeof i.status&&console.log("funnel:",e,", step:",t,", status:",i.status),"undefined"!=typeof i.exception&&alert("Funnel error\n"+(i.exception.code?"#"+i.exception.code+"\n":"")+i.exception.message)}})}function var_dump(){var e="",t=" ",i=2,n=0,a=0,o=function(e){var t=/\W*function\s+([\w\$]+)\s*\(/.exec(e);return t?t[1]:"(Anonymous)"},r=function(e,t){for(var i="",n=0;n<e;n++)i+=t;return i},s=function(e,t){var i="";if(null===e)i="NULL";else if("boolean"==typeof e)i="bool("+e+")";else if("string"==typeof e)i="string("+e.length+') "'+e+'"';else if("number"==typeof e)i=parseFloat(e)==parseInt(e,10)?"int("+e+")":"float("+e+")";else if("undefined"==typeof e)i="undefined";else if("function"==typeof e)i+="function "+o(e);else if(e instanceof Date)i="Date("+e+")";else if(e instanceof RegExp)i="RegExp("+e+")";else if(e.nodeName)switch(e.nodeType){case 1:i="undefined"==typeof e.namespaceURI||"http://www.w3.org/1999/xhtml"===e.namespaceURI?'HTMLElement("'+e.nodeName+'")':'XML Element("'+e.nodeName+'")';break;case 2:i="ATTRIBUTE_NODE("+e.nodeName+")";break;case 3:i="TEXT_NODE("+e.nodeValue+")";break;case 4:i="CDATA_SECTION_NODE("+e.nodeValue+")";break;case 5:i="ENTITY_REFERENCE_NODE";break;case 6:i="ENTITY_NODE";break;case 7:i="PROCESSING_INSTRUCTION_NODE("+e.nodeName+":"+e.nodeValue+")";break;case 8:i="COMMENT_NODE("+e.nodeValue+")";break;case 9:i="DOCUMENT_NODE";break;case 10:i="DOCUMENT_TYPE_NODE";break;case 11:i="DOCUMENT_FRAGMENT_NODE";break;case 12:i="NOTATION_NODE"}return i},l=function(e,t,i,a){var d="";t>0&&t++;var c=r(i*(t-1),a),u=r(i*(t+1),a),f="",p="";if("object"==typeof e&&null!==e)if(e.jquery)f+=(e.selector?"jQuery('"+e.selector+"')":"[jQuery object]")+"\n";else{if(e.constructor&&"PHPJS_Resource"===o(e.constructor))return e.var_dump();n=0;for(d in e)n++;f+="array("+n+") {\n";for(var h in e){var m=e[h];"object"!=typeof m||null===m||m instanceof Date||m instanceof RegExp||m.nodeName?(p=s(m,u),f+=u+"["+h+"] => "+p+"\n"):f+=u+"["+h+"] => "+l(m,t+1,i,a)}f+=c+"}\n"}else f=s(e,u);return f};for(e=l(arguments[0],0,i,t),a=1;a<arguments.length;a++)e+="\n"+l(arguments[a],0,i,t);return e}function lockScreen(e,t){t=extend({show_animation:!1,show_timer:!1,show_btn_close:!1,delay_before:0,css_class:"",hide_bg:!1,v2:!1},t);var i={},n=$('<div class="locker" style="display: none"><div class="locker-background"></div><div class="locker-content"><div class="locker-btn-list"><div class="locker-close-btn"></div></div><div class="locker-animation"></div><div class="locker-text"></div><div class="locker-timer"></div></div></div>');t.v2&&(n=$('<div class="screen-lock"> <div class="screen-lock__loader-wrap"> <div class="screen-lock__loader"></div><div class="screen-lock__text"></div> </div> </div>'),t.bg&&n.find(".screen-lock__loader-wrap").css("background",t.bg)),t.hide_bg&&n.find(".locker-background").hide(),t.css_class.length>0&&n.addClass(t.css_class);var a=generateUUID();if(n.attr("id",a),n.find(".locker-close-btn:first").bind("click",function(){unlockScreen(a)}),"undefined"!=typeof e&&e.length>0&&(t.v2?n.find(".screen-lock__text").text(e):(i["l-show-text"]=!0,n.find(".locker-content .locker-text:first").html(e))),t.show_animation===!0&&(i["l-show-animation"]=!0),t.show_timer===!0&&(i["l-show-timer"]=!0),t.show_btn_close===!0&&(i["l-show-btn-close"]=!0),Object.keys(i).length>0&&(i["l-show-content"]=!0,n.addClass(Object.keys(i).join(" "))),$("body").append(n),t.delay_before>0){var o=setTimeout(function(){n.show()},t.delay_before);n.attr("timeout_id",o)}else n.show();return n.attr("id")}function unlockScreen(e){var t=$("");t="undefined"!=typeof e?$("#"+e):$("body").children(".locker:last"),"undefined"!=typeof t.attr("timeout_id")&&clearTimeout(t.attr("timeout_id")),t.remove()}function processingBlockInCells(e){"undefined"!=typeof adapterManager&&adapterManager.updateCells(e.closest(".blk_container")),(!0===window._isEditor||"undefined"!=typeof adapterManager&&adapterManager.isEditor())&&e.find(".blk_image_ext").each(function(){pages_editor.setZoomImgExt($(this).attr("id"),$(this).find("img:first"))}),e.find(".blk_image").each(function(){var e=$(this).find("img:first"),t=$(this).parent().width(),i={w:e.width(),h:e.height()};t<=e.attr("prod_w")?(t=t<2?2:t,t=t>e.attr("real_w")?e.attr("real_w"):t,e.css({width:t,height:"auto"}),e.height()<2&&(t=Math.ceil(2*i.w/i.h),e.css({width:t}))):e.css({width:e.attr("prod_w"),height:"auto"}),e=null}),e.find(".blk_video").each(function(){var e=20,t=$(this).find("iframe:first"),i=$(this).parent().width();i<=parseInt(t.css("width"))?(i=i<e?e:i,i=i>t.attr("data-width")?t.attr("data-width"):i,t.css({width:i})):t.css({width:t.attr("data-width")}),t=null})}function sliderEditorExtend(e){e.prototype.reinitFotorama=function(e,t){var i=[];if(e.find("img").each(function(){var e=$(this);i.push({img_id:e.attr("id")||"",width:e.attr("width")||"",height:e.attr("height")||"",url:e.attr("src")||""}),e=null}),0!==i.length){var n=!1;t&&e.data("fotorama")&&(n=e.data("fotorama").activeIndex);var a=e.closest(".blk_slider_data_wrap");0==a.length&&(a=e.closest(".blk-data"));var o=e.attr("data-minwidth"),r=e.attr("data-minheight"),s="100%"===o&&"100%"===r,l=e.attr("data-ratio"),d=e.attr("data-fit"),c=e.attr("data-loop"),u=e.attr("data-width"),f=e.attr("data-maxwidth"),p=e.attr("data-maxheight"),h=e.attr("data-transition"),m=e.attr("data-transitionduration"),_=e.attr("data-autoplay"),w=e.attr("data-arrows"),g=e.attr("data-nav"),v=e.closest(".blk.blk_slider").height(),b=e.closest(".blk_section").hasClass("is_absolute");s||(isHybrid()||b?(f="100%",p="100%"):(f=0,p=0)),isHybrid()||b||a.css("height",e.outerHeight()),e.remove(),a.find(".fotorama--hidden").remove(),e=$("<div></div>").addClass("fotorama"),e.attr("data-transition",h),e.attr("data-transitionduration",m),e.attr("data-autoplay",_),e.attr("data-arrows",w),e.attr("data-nav",g),e.attr("data-fit",d),(isHybrid()||b)&&e.attr("data-height",v),c&&e.attr("data-loop",c),u&&e.attr("data-width",u),f&&e.attr("data-maxwidth",f),p&&e.attr("data-maxheight",p),o&&e.attr("data-minwidth",o),r&&e.attr("data-minheight",r),l&&e.attr("data-ratio",l);for(var y=0;y<i.length;y++)this.createFotoramaImage(i[y],e);a.prepend(e),e.on("fotorama:load",function(){$(this).addClass("fotorama-is-ready");var e=$(this).closest(".blk_slider_data_wrap");return 0==e.length&&(e=$(this).closest(".blk-data")),isHybrid()||b||e.css("height","auto"),!0}).fotorama(),isset(n)&&n!==!1&&e.data("fotorama").show(n),a=i=null}},e.prototype.createFotoramaImage=function(e,t){var i={};i.id=e.img_id,e.width&&(i.width=e.width),e.height&&(i.height=e.height);var n=$('<img style="display:none;" />').attr(i);n.load(function(){n=$(this),n.unbind("load"),n.show(),n=null}),n.attr("src",e.url),t.append(n),i=n=null}}function reInitYandexMap(e,t,i){if(null!=window.ymaps&&ymaps.Map){window.ymaps_map_instances||(window.ymaps_map_instances={});var n=window.ymaps_map_instances,a=$("#map_"+e),o=a.hasClass("map-bg"),r=a.closest(".blk_section");if(n[e]&&(n[e].destroy(),delete n[e],o&&r.addClass("empty_map")),a.empty(),ymaps&&i&&t){try{n[e]=new ymaps.Map("map_"+e,{center:[t,i],zoom:17,controls:["zoomControl"]}),n[e].geoObjects.add(new ymaps.Placemark([t,i]))}catch(e){consoleDbg(e)}o&&r.removeClass("empty_map")}}}function reInitVideoIFrame(e){var t=e.hasClass("blk_video")?e:e.find(".blk_video");t.each(function(){var e=$(this).find(".video iframe:first");e.attr("src",e.attr("src"))})}function initFileFields(e,t){window._isEditor?$(document).on("click",".user_form .userfiles_btn",function(e){return e.preventDefault(),!1}):($(".user_form .userfiles_input").on("click",function(){$(this).closest(".field_wrap").find(".userfiles_btn input[type=file]").click()}),$(".user_form .userfiles_clear").on("click",function(e){e.stopPropagation();var t=$(this).closest(".field_wrap").find(".userfiles_btn input[type=file]");confirm("Удалить загруженный вами файл?")&&(t.val(null).trigger("change",e),t=null)}),$(".user_form .userfiles_btn input[type=file]").on("change",function(i){var n,a=$(this),o=a.closest(".field_wrap"),r=o.find(".userfiles_selected_text");if(a.val()){var s="Файл выбран";if(this.files&&this.files[0]){if(t>0&&this.files.length>t)return a.val(null),o=a=null,alert("Можно выбрать не более "+t+" файл"+plural(t,"а","ов","ов")),!1;for(s=[],n=0;this.files.length>n;n++){if(e>0&&this.files[n].size>e)return a.val(null),o=a=null,alert("Файл должен быть не более "+formatFileSize(e)),!1;s.push(htmlspecialchars(this.files[n].name))}s=s.join(", ")}r.text(s).attr("title",s),o.addClass("userfiles_selected")}else r.text("").attr("title",""),r.removeAttr("style"),o.removeClass("userfiles_selected");o.find(".ui_error").hide(),o=a=null}))}function includeFiles(e){function t(e){d.indexOf(e.href)==-1&&(d.push(e.href),d.length>=s.length&&FE.runAndClr("css_dynamically_loaded"),f++,n())}function i(e){e.forEach(function(e){var i=document.createElement("link");i.setAttribute("rel","stylesheet"),i.setAttribute("type","text/css"),i.setAttribute("href",e),i.onload=function(){t(i)},i.addEventListener&&i.addEventListener("load",function(){t(i)},!1),i.onreadystatechange=function(){var e=i.readyState;"loaded"!==e&&"complete"!==e||(i.onreadystatechange=null,t(i))},document.getElementsByTagName("head")[0].appendChild(i)})}function n(){if(f==u)return FE.run("all_files_dynamically_loaded"),!0}function a(){n()||r(l[c])}function o(e){for(var t in e)"css"==t?isArray(e[t])?(u+=e[t].length,e[t].forEach(function(i){s.push(e[t])})):(u++,s.push(e[t])):"js"==t?isArray(e[t])?(u+=e[t].length,e[t].forEach(function(e){l.push(e)})):(u++,l.push(e[t])):"object"==typeof e[t]&&o(e[t])}function r(e){var t=document.createElement("script");document.head.appendChild(t),t.onload=function(){c++,f++,c==l.length?n():a(e)},t.src=e}var s=[],l=[],d=[],c=0,u=0,f=0;o(e),s.length&&i(s),l.length&&r(l[c]),n()}function isHybrid(){return null==window.__isHybrid&&(window.__isHybrid=$("body").hasClass("hybrid")),window.__isHybrid}function initAnchors(){$(document).on("click","a[href*=#]",function(e){var t=$(this).attr("href"),i=t.match(/#(.*)$/i),n=!1,a=$("#sections_list .blk_section.is_fixed:visible:first"),o=0;if(a.length&&(o=a.outerHeight()-1),null!==i&&i[1]){var r=$("#"+i[1]);if(r.length)$("html,body").stop().animate({scrollTop:r.offset().top-o},600),n=!0;else{var s=t.replace(new RegExp("^#","gi"),""),l=$("a[name="+s+"]");l.length&&($("html,body").stop().animate({scrollTop:l.offset().top-o},600),n=!0)}if(n)return e.preventDefault(),!1}})}function hashString(e,t,i){var n,a,o=void 0===i?2166136261:i;for(n=0,a=e.length;n<a;n++)o^=e.charCodeAt(n),o+=(o<<1)+(o<<4)+(o<<7)+(o<<8)+(o<<24);return t?("0000000"+(o>>>0).toString(16)).substr(-8):o>>>0}function jsLog(e){if(userHasTag("js_log")&&window.userId){var t={userId:window.userId,url:window.location.href};window.siteId&&(t.siteId=window.siteId),e.filename&&(t.path=e.filename),e.description&&(t.description=e.description),e.error&&(t.message=e.error.toString(),"object"==typeof e.error&&e.error.stack&&(t.stack=e.error.stack)),$.ajax({url:window.baseUrl+"debug/js_log",data:t,method:"POST",async:!0})}}function sendSlackMessage(e,t,i){if(window.$){"undefined"==typeof i&&(i="Bot");var n={text:t,username:i};$.post(e,{payload:JSON.stringify(n)})}}function slackDebug(e){sendSlackMessage("https://hooks.slack.com/services/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",e)}function slackErrorDump(e,t){var i="https://hooks.slack.com/services/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",n="[JS] "+e.toString();sendSlackMessage(i,n,t)}function checkProtocolInUrl(e){var t=new RegExp("^http(s*)://");return!!t.test(e)&&2===e.split("://").length}function inputUrlProcessing(e){var t="https";return e=e.trim(),e.length>6&&checkProtocolInUrl(e)?e:e.length>3&&0==/^http/.test(e)?t+"://"+e:e}function formatMoney(e){"number"!=typeof e&&(e=parseFloat(e));var t=Math.round(e),i=e.toFixed(1),n=e.toFixed(2),a=parseFloat(i),o=parseFloat(n);return a!==o?n:t!==a?i:t.toFixed(0)}function ucfirst(e){var t=e.charAt(0).toUpperCase();return t+e.substr(1,e.length-1)}function lcfirst(e){var t=e.charAt(0).toLowerCase();return t+e.substr(1,e.length-1)}function convertUnderScoreToStudlyCaps(e){e=e.toLowerCase();for(var t=e.split("_"),i="",n=0;t.length>n;n++){var a=t[n];""!==a&&(i+=ucfirst(a))}return i}function convertUnderScoreToCamelCase(e){return e=convertUnderScoreToStudlyCaps(e),lcfirst(e)}function F_wind(e,t){this.ops=t,this.$el=$(e),this.params={},this.hidePrevWnd=!0,this.whiteBg=!1,this.closeOutside=!1,this.isShown=!1,this.$btnClose=this.$el.find("a.wind-close"),this.$btnApply=this.$el.find(".wind-btn-apply:first"),this.$btnCancel=this.$el.find(".wind-btn-cancel:first"),this.$el.on("click","a.wind-close, .wnd-hide",this,function(e){e.preventDefault(),e.data.clickBtnClose()}),this.$btnApply.click(this,function(e){e.preventDefault(),e.data.clickBtnApply()}),this.$btnCancel.click(this,function(e){e.preventDefault(),e.data.clickBtnCancel()}),this.applyFunc=function(){return!0}}function showWind(e,t){var i=$.extend({},{width:500,title:"Заголовок",cont:""},"object"==typeof t&&t);'<div class="wind hidden bp0" id="'+e+'" tabindex="-1" style="width:'+i.w+'px;"><div class="wind-header"><a class="wind-close"><i class="icon-remove"></i></a><h3 class="fnt">'+i.title+'</h3></div><div class="wind-body">'+i.cont+'</div><div class="wind-footer"><button class="btn wind-btn-apply btn-primary">OK</button><button class="btn wind-btn-cancel btn-link">Отмена</button></div>'}function shakeWnd(e){e=$(e);var t=e.css("position");e.css("position","relative"),e.animate({left:-10},50,function(){$(this).animate({left:10},100,function(){$(this).animate({left:0},50,function(){$(this).css("position",t),t=null})})})}function FanimManager(){this.is_ready=!1,this.data={},this.visible_elements={},this.animated_blocks={},this.height_window=0,this.ready=function(){this.is_ready=!0,FE.runAndClr("animManager/ready")},this.init=function(e){var t=!1;if(window.animManager.data=e,window.animManager.height_window=window.innerHeight,!$.isEmptyObject(window.animManager.data))for(var i in window.animManager.data)t=$("#"+window.animManager.data[i].block_id),t.length>0&&(window.animManager.animated_blocks[i]=t);var n=!1;$(window).on("resize",function(e){n===!1&&(n=setTimeout(function(){n=!1,window.animManager.h=window.innerHeight,window.animManager.onScroll(e)},500))}),$(document).on("scroll",function(e){window.animManager.onScroll(e)}),$("#popup_list .section_popup").on("scroll",function(e){window.animManager.onScroll(e)}),FE.add("show_section_popup",function(){window.animManager.onScroll()}),window.animManager.onScroll()},this.getAnimatedObject=function(e){var t=$("#"+e);if(0==t.length)return!1;switch(t.attr("blk_class")){case"blk_image":t=t.find("img:first");break;case"blk_form":t=t.find(".blk_form_wrap:first");break;case"blk_text":t=t.find(".blk-data:first");break;case"blk_video":t=t.find(".video_container:first");break;case"blk_slider":t=t.find(".fotorama:first");break;case"blk_button":t=t.find("a:first")}return t},this.setStyle=function(e,t,i){var n=e[0],a=window.getComputedStyle(n),o="";o=a.getPropertyValue("-webkit-animation-delay")?"-webkit-animation-delay":a.getPropertyValue("-moz-animation-delay")?"-moz-animation-delay":a.getPropertyValue("-o-animation-delay")?"-o-animation-delay":"animation-delay",n.style.setProperty(o,"0s"),o=a.getPropertyValue("-webkit-animation-duration")?"-webkit-animation-duration":a.getPropertyValue("-moz-animation-duration")?"-moz-animation-duration":a.getPropertyValue("-o-animation-duration")?"-o-animation-duration":"animation-duration",n.style.setProperty(o,i+"s")},this.setClass=function(e,t){e.hasClass(t)||e.addClass(t)},this.onScroll=function(e){var t=self.pageYOffset||document.documentElement&&document.documentElement.scrollTop||document.body&&document.body.scrollTop,i=window.animManager.height_window/100*5;window.animManager.visible_elements={};for(var n in window.animManager.animated_blocks){var a=window.animManager.animated_blocks[n],o=window.animManager.getAnimatedObject(window.animManager.data[n].block_id);a!==!1&&o!==!1&&(o.closest(".blk_box_slider_self").length>0?(window.animManager.setClass(o,window.animManager.data[n].animation_type),a.removeClass("is_animated_block")):o.offset().top<=t+window.animManager.height_window-i&&o.offset().top+o.outerHeight()>=t+i&&(window.animManager.visible_elements[n]=a,window.animManager.startAnimation(a,o,window.animManager.data[n]),window.animManager.animated_blocks[n]=!1))}},this.startAnimation=function(e,t,i){window.animManager.setStyle(t,i.delay,i.duration);var n=function(){window.animManager.setClass(t,i.animation_type),e.removeClass("is_animated_block")};parseFloat(i.delay)>0?setTimeout(n,1e3*parseFloat(i.delay)):n()}}if(window.rnd_seed=(new Date).getTime(),!window._ua)var _ua=navigator.userAgent.toLowerCase();var browser={version:(_ua.match(/.+(?:me|ox|on|rv|it|era|ie)[\/: ]([\d.]+)/)||[0,"0"])[1],opera:/opera/i.test(_ua),msie:/msie/i.test(_ua)&&!/opera/i.test(_ua),msie6:/msie 6/i.test(_ua)&&!/opera/i.test(_ua),msie7:/msie 7/i.test(_ua)&&!/opera/i.test(_ua),msie8:/msie 8/i.test(_ua)&&!/opera/i.test(_ua),msie9:/msie 9/i.test(_ua)&&!/opera/i.test(_ua),mozilla:/firefox/i.test(_ua),chrome:/chrome/i.test(_ua),safari:!/chrome/i.test(_ua)&&/webkit|safari|khtml/i.test(_ua),iphone:/iphone/i.test(_ua),ipod:/ipod/i.test(_ua),iphone4:/iphone.*OS 4/i.test(_ua),ipod4:/ipod.*OS 4/i.test(_ua),ipad:/ipad/i.test(_ua),android:/android/i.test(_ua),bada:/bada/i.test(_ua),mobile:/iphone|ipod|ipad|opera mini|opera mobi|iemobile|android/i.test(_ua),msie_mobile:/iemobile/i.test(_ua),safari_mobile:/iphone|ipod|ipad/i.test(_ua),opera_mobile:/opera mini|opera mobi/i.test(_ua),opera_mini:/opera mini/i.test(_ua),mac:/mac/i.test(_ua)};Array.prototype.forEach||(Array.prototype.forEach=function(e,t){for(var i=0,n=this.length;i<n;++i)e.call(t,this[i],i,this)}),Date.prototype.toISOString||(Date.prototype.toISOString=function(){function e(e){return e<10?"0"+e:e}return this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"."+e(this.getUTCMilliseconds())+"Z"}),FE.add("onready","initDropdown()"),window.jQuery&&(jQuery.fn.outerHTML=function(e){return e?this.before(e).remove():jQuery("<div></div>").append(this.eq(0).clone()).html()}),$("body").popover({trigger:"hover",selector:".has_popover",placement:"top",html:"true",delay:"100"}),$(document).on("click",".btn-smart",function(){if(!$(this).data("button")){var e=$(this).attr("data-loading");$(this).button({loadingText:e?e:"Загрузка..."})}$(this).button("loading")}),$(document).on("click","form.frm_lead:not(.editor)",function(e){e.stopPropagation()}),$(document).on("click",".wrap-for-formPopover",function(e){$("#formPopover").wind("hide")}),$(document).on("submit","form.frm_lead",function(e){var id=$(this).attr("id");id||(id=$(this).attr("frm-id"));var frm=$(this),$parent=$(frm).parent(),isQuiz=$parent.hasClass("quiz-form"),quizForm;isQuiz&&(quizForm=sitesMan.quizForm(frm));var inp_track=frm.find("input.inp_track");if(inp_track.length||(inp_track=$('<input type="hidden" class="inp_track" name="inp_track" value=""/>'),inp_track.appendTo(frm)),inp_track.val(escapeRus(getCookie("bm360track"))),!frm.find("input.inp_utm").length){$('<input type="hidden" class="inp_utm" name="has_utm" value="1"/>').appendTo(frm);var params=getUrlVars();for(var k in params)$('<input type="hidden" class="inp_utm" name="'+k+'" value="'+params[k]+'"/>').appendTo(frm)}var data_mes_url=parseInt(frm.attr("data-mes-url")),ajax_cfg={frm:$(this),type:"POST",cache:!1,timeout:4e4,url:(null!==window.baseUrl.match(/lpmotor.ru\/admin\/$/)?window.baseUrl.replace(/^http(|s):/,window.location.protocol).replace(/\/$/,""):"")+$(this).attr("action")+"/frm:"+id,beforeSend:function(e,t){var i=t.frm.find("input.ui_btn, input.btn-submit");if(i.css({width:i.outerWidth()}),!i.data("button")){var n=i.attr("lang");i.button({loadingText:n&&"en"==n?"Loading...":"Загрузка...",defText:i.val()}),n=null}i.button("loading")},success:function(data){var isQuiz=frm.parent().hasClass("quiz-form");if(frm.find(".ui_has_error").removeClass("ui_has_error"),frm.find(".ui_error").hide().html(""),frm.find("input.ui_btn, input.btn-submit").button("def"),"function"==typeof data.split&&(data=JSON.parse(data)),isset(data.error)){var firstErr=!1;for(var attrId in data.error){var $attr=frm.find("#"+frm.attr("id")+"__"+attrId),$attrErr=frm.find(".ui_error[for="+frm.attr("id")+"__"+attrId+"]");if($attr.length&&($attr.addClass("ui_has_error"),!1===firstErr&&($attr.focus(),firstErr=!0,isQuiz&&quizForm))){var $steps=frm.find(".quiz"),index=$steps.index($attr.closest(".quiz"));sitesMan.toQuizStep(quizForm,index),FE.run("quiz-validate-error",{step:$steps.eq(index)})}data.error.hasOwnProperty(attrId)&&$attrErr.length&&($attrErr.show(),$attrErr.html("<div>"+data.error[attrId].join("</div><div>")+"</div>"))}}if(isset(data.exception)&&window.dbgMode&&alert(data.exception),isset(data.script))try{eval(data.script)}catch(e){window.console&&window.dbgMode&&(console.log(e),console.log("[_Ошибка JS_] "+e.stack))}if(isset(data.post_data))try{$.ajax({url:data.post_data.url,data:data.post_data.params,method:"POST",async:!0})}catch(e){window.console&&window.dbgMode&&(console.log(e),console.log("[_POST_request_error_] "+e.stack))}if(isset(data.res))if(1==data.res){reachGoalByAttr(frm,"goal-submitted");var mes=!1,f_show_msg=function(e){if(mes=e.attr("suссess-message"),mes.length||(mes="Спасибо!\\nВаша заявка принята.\\nВ ближайшее время мы с вами свяжемся!"),isset(data.lead_preview)){mes+='<div class="lead_preview"><div class="c_text">--------[ ВНИМАНИЕ ]--------</div><div class="c_text">(В предпросмотре заявка не создается)</div><div class="l_text mt1">Данные, принятые с формы:</div><ul class="l_text mb0">';for(var t in data.lead_preview)mes+="<li><b>"+data.lead_preview[t].name+"</b>: "+(null===data.lead_preview[t].val?"":data.lead_preview[t].val)+"</li>";mes+="</ul></div>"}};switch(data_mes_url){case 1:f_show_msg(frm);break;case 2:var loc=frm.attr("data-goto-url");if(loc.length){/^http(|s):\/\//.test(loc)!==!0&&(loc="http://"+loc);var inp;return-1!==loc.indexOf("{name}")&&(inp=frm.find(".field.fname:first input.inp"),inp.length&&(loc=loc.replace("{name}",encodeURIComponent(inp.val())))),-1!==loc.indexOf("{email}")&&(inp=frm.find(".field.femail:first input.inp"),inp.length&&(loc=loc.replace("{email}",encodeURIComponent(inp.val())))),-1!==loc.indexOf("{phone}")&&(inp=frm.find(".field.fphone:first input.inp"),inp.length&&(loc=loc.replace("{phone}",encodeURIComponent(inp.val())))),-1!==loc.indexOf("{order_id}")&&data.id_lead&&(loc=loc.replace("{order_id}",data.id_lead)),void(window.location.href=loc)}loc=null;break;case 3:var frm_id=frm.attr("frm-id"),lead_id=data.id_lead,key=data.key;if($("#ymis_"+frm_id).length>0){var c_ops={id:"j_lead_confirm",html:!0,width:null,okText:"Яндекс.Деньги",cancelText:"Банковская карта",btnWidth:120,okClass:"n-btn n-btn-success btn-round",cancelClass:"n-btn n-btn-success btn-round",onOk:function(){ymis_manager.submitLeadForm(frm_id,lead_id,key,"PC")},onCancel:function(){ymis_manager.submitLeadForm(frm_id,lead_id,key,"AC")},headerText:!1,showClose:!0};jConfirm("Выберите способ оплаты",c_ops,!0),$("#j_lead_confirm").find("#jConfirmOk").removeClass("ibtn wind-btn-apply")}else f_show_msg(frm);break;case 4:var leadId=data.id_lead,signature=data.signature,frmId=frm.attr("frm-id"),robokassaForm=$("#robokassa_"+frmId);robokassaForm.length>0?(robokassaForm.find("input[name=InvId]").val(leadId),robokassaForm.find("input[name=SignatureValue]").val(signature),robokassaForm.submit()):f_show_msg(frm);break;case 5:data.ya_kassa_res&&data.ya_kassa_res.confirmation_url?window.location.href=data.ya_kassa_res.confirmation_url:(consoleDbg(data.ya_kassa_res),f_show_msg(frm));break;case 6:data.pay_pal_res&&data.pay_pal_res.approval_link?window.location.href=data.pay_pal_res.approval_link:(consoleDbg(data.pay_pal_res),f_show_msg(frm));break;default:console.log("FORM has action type = "+data_mes_url+" (it is not defined)")}isQuiz&&quizForm&&sitesMan.toQuizStep(quizForm,0),frm.find("input.inp,textarea.inp").val(""),frm.find("input[type=checkbox]").prop("checked",!1),frm.find(".fradio input:first").prop("checked",!0),frm.find(".fselect option:first").prop("selected","selected"),frm.find("input[type=file]").val(null).trigger("change",e);var w=frm.closest(".wind");if(w.length&&w.wind("hide"),w=null,!1!==mes){if(window.jAlert){var wnd_width="undefined"==typeof adapterManager||adapterManager.isPC()?400:340;$("#wind_container").addClass("j_alert"),jAlert(mes.replace(/\\n/g,"<br/>"),{id:"j_lead_alert",showCloseBtn:!0,btnCls:"btn",width:wnd_width,btnWidth:"auto",hideOnBlackoutClick:!0,html:!0,mobileAdapt:isQuiz&&!quizMobileView.isMobileInPreview(),onOk:function(){$("#wind_container").removeClass("j_alert")}})}else alert(mes.replace(/\\n/g,"\n"));mes=null}}else if(data.show_alert)switch(data.show_alert){case"empty_data":alert("Нужно заполнить хотя бы одно поле");break;default:alert("Error: "+data.show_alert)}window.dbgMode&&console.log(data)},error:function(e,t,i){switch(console.log(t),t){case"timeout":alert("Ошибка! Нет связи с сервером. Проверьте подключение к интернету и попробуйте снова.");break;case"error":case"parsererror":alert("Извините, на сервере возникла ошибка!\n\nПожалуйста, напишите нам в тех-поддержку support@lpmotor.ru"),window.dbgMode&&(console.log(e),console.log(i))}frm.find("input.ui_btn, input.btn-submit").button("def")}};if(frm.find("input[type=file]").length>0){if(!window.FormData)return alert("Ошибка № 2876 Ваш браузер не поддерживает объект FormData, попробуйте воспользоваться современной версией браузера"),!1;ajax_cfg.data=new FormData(this),ajax_cfg.processData=!1,ajax_cfg.contentType=!1}else ajax_cfg.dataType="json",ajax_cfg.data=$(this).serialize();return 6==data_mes_url&&lockScreen("Сейчас произойдет переход к оплате",{
show_animation:!0}),$.ajax(ajax_cfg),id=null,!1}),window._eh={step:20,speed:300,$container:!1,$body:!1,$wnd:!1,bodyWidth:0,$img:null,$newImg:null,curSize:null,origSize:null,wndSize:null,newSize:null},window._lpcid_hosts=["http://lpmotor.ru","http://lpmotor.org","http://bm360.ru","https://admin.lpmotor.ru"],window.userHasTag=function(e){return"undefined"!=typeof window.__user_tags&&"undefined"!=typeof window.__user_tags[e]},window.userAddTag=function(e,t){"undefined"!=typeof window.__user_tags&&"undefined"==typeof window.__user_tags[e]&&window.$&&$.ajax({url:baseUrl+"tests/ajax/do:add_tag",data:{tag:e},dataType:"json",method:"post",_funcParams:{callback:t||!1},success:function(t){var i=!1;t.res&&1==t.res&&t.cnt&&t.cnt>0&&(window.__user_tags[e]=1,i=!0),"function"==typeof this._funcParams.callback&&this._funcParams.callback.apply(this,[i,t])}})},function(e){function t(t){return f=lockScreen("Секундочку...",{show_animation:!0}),$.get("http://"+e.baseDomain+"/"+window.siteId+"/api/popup",{popup_id:t},"JSON")}function i(e,t){var i=$(e);return c.append(i),u[t]=i,i}function n(e){console.error("Error num: [#4481]. Не удалось получить всплывающую секцию. Сервер вернул: ",e)}function a(e){var t,i=u[e],n=$("#sections_list").find(" .blk_section.is_fixed"),a=$("body"),o=a.width();a.addClass("open_popup"),t=a.width()-o,a.css("margin-right",t),$("body>.navbar>.navbar-inner").css("padding-right",t),"undefined"!=typeof window.module_geotarget&&window.module_geotarget.city.length&&i.find(".geotarget_module").text(window.module_geotarget.city).removeClass("hidden"),n.length&&(window.active_fixed_sections=n,$.each(n,function(){$(this).css({"z-index":5})})),i.addClass("open"),i.hasClass("initSlick")||(i.find(".blk_box_slider_self").each(function(){var e=$(this);initSlick(e)}),i.addClass("initSlick")),FE.run("show_section_popup",{section_id:e})}function o(e){try{var t=JSON.parse(e)}catch(e){return(new $.Deferred).reject(e)}return t.data?t.data:(new $.Deferred).reject(e)}function r(e){e.find(".blk_yandex_map").each(function(){var e=$(this).attr("id"),t="init_ymap_"+e;return window[t]?void window[t]():void console.error("Функция "+t+" не была найдена в window. [#4502]")})}function s(e){e.find(".is_animated_block").each(function(){window.animManager.animated_blocks[$(this).attr("id")]=$(this)})}function l(e){var l=function(){window._isEditor||$("#"+e).find(".blk.blk_video .video.autoplay iframe").each(function(){$(this).attr("src",$(this).attr("src-temp"))})};isset(u[e])?(a(e),l()):t(e).then(o).then(function(t){var n=i(t,e);return r(n),s(n),window.adapterManager.initFotorama(),unlockScreen(f),f=null,sitesMan.initQuiz(n,!0),e},n).then(a).then(l)}function d(e){var t=$("#"+e);t.length||console.error("Не найдена секция #"+e+". Ошибка [#4482]"),u[e]=t}var c=$("#popup_list"),u={},f=null;c.find(".blk_section").each(function(){u[$(this).attr("id")]=$(this)}),e.showSectionPopup=l,e.registerPopup=d}(window),function(e){"use strict";function t(t){e(n).each(function(){FE.run("hide_custom_dropdown",t,{$btn:e(this),$wrap:i(e(this)).removeClass("open")})})}function i(e){return e.parent()}var n=".custom-dropdown-btn",a="click.custom-dropdown.data-api",o="keydown.custom-dropdown.data-api",r=function(t){var i=e(t).on(a,this.toggle);e("html").on(a,function(e){FE.run("hide_custom_dropdown",e,{$btn:i,$wrap:i.parent().removeClass("open")})})};r.prototype={constructor:r,toggle:function(n){var a,o,r=e(this);if(!r.is(".disabled, :disabled"))return a=i(r),o=a.hasClass("open"),t(n),o||("ontouchstart"in document.documentElement,FE.run("show_custom_dropdown",n,{$btn:r,$wrap:a.toggleClass("open")})),r.focus(),!1},keydown:function(t){var a,o,r;if(/(38|40|27)/.test(t.keyCode)&&(a=e(this),t.preventDefault(),t.stopPropagation(),!a.is(".disabled, :disabled")))return o=i(a),r=o.hasClass("open"),!r||r&&27==t.keyCode?(27==t.which&&o.find(n).focus(),a.click()):void 0}};var s=e.fn.customDropdown;e.fn.customDropdown=function(t){return this.each(function(){var i=e(this),n=i.data("customDropdown");n||i.data("customDropdown",n=new r(this)),"string"==typeof t&&n[t].call(i)})},e.fn.customDropdown.Constructor=r,e.fn.customDropdown.noConflict=function(){return e.fn.customDropdown=s,this},e(document).on(a,t).on(a,".custom-dropdown-menu",function(e){e.stopPropagation()}).on(a,n,r.prototype.toggle).on(o,n,r.prototype.keydown)}(window.jQuery),function(){$("#popup_list").on("click",".blk_section.section_popup.open",function(e){if("click"==e.type&&$(e.target).hasClass("section_popup"))return hideSectionPopup($(e.currentTarget).attr("id")),!1})}(),function(){var e=function(){var e=$("#gift-for-user img");if(e.length>0){var t=e.attr("classes-animate");e.addClass(t);var i=function(){e.removeClass(t)};setTimeout(i,1e3)}};$("#gift-for-user").length>0&&setInterval(e,3e3)}(),Math.radians=function(e){return e*Math.PI/180},Math.degrees=function(e){return 180*e/Math.PI},function(){var e=$(".widgets__all-sites");e.length&&e.on("click",function(){window.sessionStorage.clear("widgets/siteId")})}(),function(e){function t(t,i,n){var a=new $.Deferred;return FE.add("__lpmExtensions/"+i+"/included",function(){e.__lpmExtensions.appendHtml(t.res.html),$.when(e.__lpmExtensions.run(i,n)).then(function(e){a.resolve(e)})}),includeFiles(t.res),a}e.__lpmExtensions={isInited:!1,get:function(i,n){var a=1,o=n?n:e.siteId;return e.dbgMode&&(a=(new Date).getTime()),lockScreen("Секундочку...",{show_animation:!0}),$.get(window.baseUrl+o+"/settings/ajax/frm:get_extension",{v:a,exName:i,includeMain:intval(0==intval(isset(e.__lpmExtensions)&&e.__lpmExtensions.isInited))}).then(function(e){return t(JSON.parse(e),i,o)})}}}(window),function(){userHasTag("js_log")&&(console.log("init: Error Event Listener"),window.addEventListener("error",jsLog))}(),function(e){var t,i=$("body"),n=$("#formPopover"),a=function(){function e(){this.setMobileView=function(){i=t.attr("content"),t.attr("content",n)},this.rollbackView=function(){t.attr("content",i)}}var t=$('head meta[name="viewport"]'),i="",n="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=0";return e}(),o=new a,r=function(){function e(){a=o.css("width"),o.css("width","100%")}function t(){o.css("width",a)}function i(i){o=i,r=o.is(".wind")?o:o.closest(".wind"),this.resetFormMinWidth=function(){n=o.css("minWidth"),o.css("minWidth",0)},this.rollbackFormMinWidth=function(){o.css("minWidth",n)},this.getElement$=function(){return i},this.adaptWind=function(){e(),o.addClass(s)},this.rollbackWind=function(){t(),o.removeClass(s)},this.adaptInPreview=function(){r.addClass(l)},this.rollbackInPreview=function(){r.removeClass(l)}}var n,a,o,r,s="mobile-view",l="preview-adapt";return i}(),s=function(){function e(e){var i,n=e.step;a=n.find(".error_wrapper"),i=a.find(".ui_error"),n.hasClass("fname")||n.hasClass("fselect")||n.hasClass("femail")||n.hasClass("fphone")||(r=!0,o=!1,"none"==i.css("display")&&i.css("display","flex"),quizMobileView.isMobile()?a.css("bottom",t.getElement$().find(".wind-footer").outerHeight()):(a.css("top",u.getVisiblePart()),o=1),a.addClass("floated-error").fadeIn(400,function(){setTimeout(function(){a.fadeOut(400,function(){a.removeClass("floated-error"),r=!1})},3500)}))}function i(){this.subscribeOnEvent=function(){FE.add(n,e)},this.changePosition=function(e){o&&r&&a.css("top",e)},this.unsubscribe=function(){FE.clr(n)}}var n="quiz-validate-error",a=$(),o=!1,r=!1;return i}(),l=new s,d=function(){function e(){quizMobileView.isMobile()&&(i.removeClass("quiz-mobile-view"),o.rollbackView(),t.rollbackFormMinWidth()),quizMobileView.isMobileInPreview()&&t.rollbackInPreview(),l.unsubscribe()}function a(){quizMobileView.isMobile()&&(i.removeClass("quiz-mobile-view"),o.rollbackView(),t.rollbackWind())}function s(e,t){c.indexOf(e.attr("id"))===-1&&(e.wind("setAfterCloseFunc",t),c.push(e.attr("id")))}function d(){this.toQuizView=function(a){t=new r(a),this.isMobile()&&(o.setMobileView(),i.addClass("quiz-mobile-view"),t.resetFormMinWidth(),this.isMobileInPreview()&&t.adaptInPreview()),l.subscribeOnEvent(),u.initialize(),s(n,e)},this.adaptWind=function(e){this.isMobile()&&(t=new r(e),t.adaptWind(),o.setMobileView(),i.addClass("quiz-mobile-view"),s(e,a))},this.isMobile=function(){return browser.mobile||this.isMobileInPreview()},this.isMobileInPreview=function(){return adapterManager.isPreview()&&!adapterManager.isPC()},this.getSmartHeader=function(){return u}}var c=[];return d}(),c=function(){function e(){s=$(this).scrollTop(),s>r?i():n(),l.changePosition(u.getVisiblePart()),r=s}function i(){d>0?(d-=s-r,o.css({top:-(f-d)})):d=0,c=s}function n(){d+=r-s,d>f&&(d=f),o.css({top:d<=f?-(f-d):0}),0==s?(c=0,o.removeClass("shadow")):c>f&&o.addClass("shadow")}function a(){this.initialize=function(){var i=t.getElement$(),n=i.attr("id");h.indexOf(n)===-1&&(o=i.find(".wind-header"),d=f=o.outerHeight()+p,i.find(".wind-body").on("scroll",e),h.push(n))},this.getVisiblePart=function(){return d},this.recalcHeaderHeight=function(){d=f=o.outerHeight()+p}}var o,r=0,s=0,d=0,c=0,f=0,p=4,h=[];return a}(),u=new c;e.quizMobileView=new d}(window),window._wind_cnt=0,F_wind.prototype.toggle=function(){return this[this.isShown?"hide":"show"]()},F_wind.prototype.show=function(){if(this.ops.showFunc(this)){window._wind_cnt<=0&&($("#wind_container").show(),window._wind_cnt<0&&(window._wind_cnt=0));var e=this.$el.attr("id");this.$el.parent().hasClass("wind-wrap")?this.$wrap||(this.$wrap=this.$el.closest(".wind-wrap")):(this.$el.wrap('<div class="wind-wrap hidden'+(this.whiteBg?" wind-wrap-white":"")+(e?" wrap-for-"+e:"")+'"></div>'),this.$el.removeClass("hidden"),this.$wrap=this.$el.parent()),this.$wrap.css({"z-index":window._wind_cnt+1}),this.$wrap.removeClass("hidden"),this.isShown=!0,this.$el.trigger("show");var t=$("body").width(),i=null;if($("html").addClass("wind_opened"),i=$("body").width()-t,$("body").css("margin-right",i),$("body>.navbar>.navbar-inner").css("padding-right",i),this.ops.afterShowFunc(this),window.lpm_hints){var n=window.lpm_hints.getHintsManager();if(n&&n.currentDisplayedHint){var a=n.currentDisplayedHint;a&&a.settings&&a.settings.name&&setTimeout(function(){n.offHint(n.currentDisplayedHint)},500)}}this.$el.hasClass("wind--close-outside")&&(this.$wrap.on("click",this.clickOutside),this.closeOutside=!0),t=i=null,window._wind_cnt++}},F_wind.prototype.hide=function(){window._wind_cnt>0?window._wind_cnt--:window._wind_cnt=0,this.$wrap&&this.$wrap.addClass("hidden"),0==$("#wind_container > div:visible").length&&$("#wind_container").hide(),this.isShown=!1,this.$el.trigger("hide"),$("body").css("margin-right",0),$("body>.navbar>.navbar-inner").css("padding-right",0),$("html").removeClass("wind_opened"),this.closeOutside&&this.$wrap.off("click",this.clickOutside),this.ops.afterCloseFunc(this)},F_wind.prototype.setHidePrevWnd=function(e){this.hidePrevWnd=!!e},F_wind.prototype.setWhiteBg=function(e){this.whiteBg=!!e},F_wind.prototype.setApplyFunc=function(e){"function"==typeof e&&(this.ops.applyFunc=e)},F_wind.prototype.setCancelFunc=function(e){"function"==typeof e&&(this.ops.cancelFunc=e)},F_wind.prototype.setCloseFunc=function(e){"function"==typeof e?this.ops.closeFunc=e:this.ops.closeFunc=null},F_wind.prototype.setAfterCloseFunc=function(e){"function"==typeof e&&(this.ops.afterCloseFunc=e)},F_wind.prototype.setShowFunc=function(e){"function"==typeof e&&(this.ops.showFunc=e)},F_wind.prototype.setAfterShowFunc=function(e){"function"==typeof e&&(this.ops.afterShowFunc=e)},F_wind.prototype.setParams=function(e){this.params=e},F_wind.prototype.clickBtnApply=function(){!1!==this.ops.applyFunc(this)&&this.hide()},F_wind.prototype.clickBtnClose=function(){"function"==typeof this.ops.closeFunc?!1!==this.ops.closeFunc(this)&&this.hide():this.clickBtnCancel()},F_wind.prototype.clickOutside=function(e){return 0!==$(e.target).closest(".wind").length||void $(this).children(".wind").wind("clickBtnClose")},F_wind.prototype.clickBtnCancel=function(){!1!==this.ops.cancelFunc(this)&&this.hide()},jQuery.fn.wind=function(e){var t=$(this),i=$.extend({},$.fn.wind.defaults,"object"==typeof e&&e),n=t.data("wind");return n||t.data("wind",n=new F_wind(this,i)),"string"==typeof e?arguments[1]?n[e](arguments[1]):n[e]():i.show&&n.show(),t=n=i=null,this},jQuery.fn.wind.defaults={show:!1,container:$("body > #wind_container"),applyFunc:function(){return!0},cancelFunc:function(){return!0},closeFunc:null,showFunc:function(){return!0},afterCloseFunc:function(){},afterShowFunc:function(){}},function(){"use strict";var e=function(){var e=window.location.href.match(/form:([a-f0-9]{32})/i);if(null!==e){var t=e[1],i=$("form#frm"+t+":visible");i.length||(i=$(".blk#"+t+" .blk_form_wrap"));var n=function(e){e.css("outline","5px dashed #FFC119").animate({outlineColor:"#FF7519"},500).animate({outlineColor:"#FFC119"},500).animate({outlineColor:"#FF7519"},500).animate({outlineColor:"#FFC119"},500)};if(i.length){var a=i.closest(".blk_section.section_popup"),o=$("body");$();if(a.length>0){var r=a.attr("id");n(i),i=$("[data-popup-id="+r+"]").closest("div.blk")}var s=i.offset().top,l=0;l=s>90?s-90-20:s-100,o.scrollTo(l,function(){n(i)},500)}else alert("Такой формы нет на сайте :( \nВозможно вы ее уже удалили")}},t=function(){var e=$(".preview_btn_responsive");e.click(function(){var t=$(this);e.removeClass("active"),t.addClass("active"),adapterManager.setVersion(t.data("adapter-type"))})};FE.runOnReady(function(){var i=lockScreen(" ",{show_animation:!0,show_timer:!0,delay_before:1e3});$(document).ready(function(){e(),unlockScreen(i)}),t()})}(),fotoramaVersion="4.6.4",function(e,t,i,n,a){"use strict";function o(e){var t="bez_"+n.makeArray(arguments).join("_").replace(".","p");if("function"!=typeof n.easing[t]){var i=function(e,t){var i=[null,null],n=[null,null],a=[null,null],o=function(o,r){return a[r]=3*e[r],n[r]=3*(t[r]-e[r])-a[r],i[r]=1-a[r]-n[r],o*(a[r]+o*(n[r]+o*i[r]))},r=function(e){return a[0]+e*(2*n[0]+3*i[0]*e)},s=function(e){for(var t,i=e,n=0;++n<14&&(t=o(i,0)-e,!(Math.abs(t)<.001));)i-=t/r(i);return i};return function(e){return o(s(e),1)}};n.easing[t]=function(t,n,a,o,r){return o*i([e[0],e[1]],[e[2],e[3]])(n/r)+a}}return t}function r(){}function s(e,t,i){return Math.max(isNaN(t)?-1/0:t,Math.min(isNaN(i)?1/0:i,e))}function l(e){return e.match(/ma/)&&e.match(/-?\d+(?!d)/g)[e.match(/3d/)?12:4]}function d(e){return jt?+l(e.css("transform")):+e.css("left").replace("px","")}function c(e){var t={};return jt?t.transform="translate3d("+e+"px,0,0)":t.left=e,t}function u(e){return{"transition-duration":e+"ms"}}function f(e,t){return isNaN(e)?t:e}function p(e,t){return f(+String(e).replace(t||"px",""))}function h(e){return/%$/.test(e)?p(e,"%"):a}function m(e,t){return f(h(e)/100*t,p(e))}function _(e){return(!isNaN(p(e))||!isNaN(p(e,"%")))&&e}function w(e,t,i,n){return(e-(n||0))*(t+(i||0))}function g(e,t,i,n){return-Math.round(e/(t+(i||0))-(n||0))}function v(e){var t=e.data();if(!t.tEnd){var i=e[0],n={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",msTransition:"MSTransitionEnd",transition:"transitionend"};W(i,n[bt.prefixed("transition")],function(e){t.tProp&&e.propertyName.match(t.tProp)&&t.onEndFn()}),t.tEnd=!0}}function b(e,t,i,n){var a,o=e.data();o&&(o.onEndFn=function(){a||(a=!0,clearTimeout(o.tT),i())},o.tProp=t,clearTimeout(o.tT),o.tT=setTimeout(function(){o.onEndFn()},1.5*n),v(e))}function y(e,t){if(e.length){var i=e.data();jt?(e.css(u(0)),i.onEndFn=r,clearTimeout(i.tT)):e.stop();var n=k(t,function(){return d(e)});return e.css(c(n)),n}}function k(){for(var e,t=0,i=arguments.length;i>t&&(e=t?arguments[t]():arguments[t],"number"!=typeof e);t++);return e}function $(e,t){return Math.round(e+(t-e)/1.5)}function x(){return x.p=x.p||("https:"===i.protocol?"https://":"http://"),x.p}function C(e){var i=t.createElement("a");return i.href=e,i}function S(e,t){if("string"!=typeof e)return e;e=C(e);var i,n;if(e.host.match(/youtube\.com/)&&e.search){if(i=e.search.split("v=")[1]){var a=i.indexOf("&");-1!==a&&(i=i.substring(0,a)),n="youtube"}}else e.host.match(/youtube\.com|youtu\.be/)?(i=e.pathname.replace(/^\/(embed\/|v\/)?/,"").replace(/\/.*/,""),n="youtube"):e.host.match(/vimeo\.com/)&&(n="vimeo",i=e.pathname.replace(/^\/(video\/)?/,"").replace(/\/.*/,""));return i&&n||!t||(i=e.href,n="custom"),!!i&&{id:i,type:n,s:e.search.replace(/^\?/,""),p:x()}}function T(e,t,i){var a,o,r=e.video;return"youtube"===r.type?(o=x()+"img.youtube.com/vi/"+r.id+"/default.jpg",a=o.replace(/\/default.jpg$/,"/hqdefault.jpg"),e.thumbsReady=!0):"vimeo"===r.type?n.ajax({url:x()+"vimeo.com/api/v2/video/"+r.id+".json",dataType:"jsonp",success:function(n){e.thumbsReady=!0,M(t,{img:n[0].thumbnail_large,thumb:n[0].thumbnail_small},e.i,i)}}):e.thumbsReady=!0,{img:a,thumb:o}}function M(e,t,i,a){for(var o=0,r=e.length;r>o;o++){var s=e[o];if(s.i===i&&s.thumbsReady){var l={videoReady:!0};l[Yt]=l[Jt]=l[Kt]=!1,a.splice(o,1,n.extend({},s,l,t));break}}}function E(e){function t(e,t,a){var o=e.children("img").eq(0),r=e.attr("href"),s=e.attr("src"),l=o.attr("src"),d=t.video,c=!!a&&S(r,d===!0);c?r=!1:c=d,i(e,o,n.extend(t,{video:c,img:t.img||r||s||l,thumb:t.thumb||l||s||r}))}function i(e,t,i){var a=i.thumb&&i.img!==i.thumb,o=p(i.width||e.attr("width")),r=p(i.height||e.attr("height"));n.extend(i,{width:o,height:r,thumbratio:q(i.thumbratio||p(i.thumbwidth||t&&t.attr("width")||a||o)/p(i.thumbheight||t&&t.attr("height")||a||r))})}var a=[];return e.children().each(function(){var e=n(this),o=H(n.extend(e.data(),{id:e.attr("id")}));if(e.is("a, img"))t(e,o,!0);else{if(e.is(":empty"))return;i(e,null,n.extend(o,{html:this,_html:e.html()}))}a.push(o)}),a}function F(e){return 0===e.offsetWidth&&0===e.offsetHeight}function P(e){return!n.contains(t.documentElement,e)}function I(e,t,i,n){return I.i||(I.i=1,I.ii=[!0]),n=n||I.i,"undefined"==typeof I.ii[n]&&(I.ii[n]=!0),e()?t():I.ii[n]&&setTimeout(function(){I.ii[n]&&I(e,t,i,n)},i||100),I.i++}function z(e){i.replace(i.protocol+"//"+i.host+i.pathname.replace(/^\/?/,"/")+i.search+"#"+e)}function j(e,t,i,n){var a=e.data(),o=a.measures;if(o&&(!a.l||a.l.W!==o.width||a.l.H!==o.height||a.l.r!==o.ratio||a.l.w!==t.w||a.l.h!==t.h||a.l.m!==i||a.l.p!==n)){var r=o.width,l=o.height,d=t.w/t.h,c=o.ratio>=d,u="scaledown"===i,f="contain"===i,p="cover"===i,h=X(n);c&&(u||f)||!c&&p?(r=s(t.w,0,u?r:1/0),l=r/o.ratio):(c&&p||!c&&(u||f))&&(l=s(t.h,0,u?l:1/0),r=l*o.ratio),e.css({width:r,height:l,left:m(h.x,t.w-r),top:m(h.y,t.h-l)}),a.l={W:o.width,H:o.height,r:o.ratio,w:t.w,h:t.h,m:i,p:n}}return!0}function D(e,t){var i=e[0];i.styleSheet?i.styleSheet.cssText=t:e.html(t)}function L(e,t,i){return t!==i&&(t>=e?"left":e>=i?"right":"left right")}function N(e,t,i,n){if(!i)return!1;if(!isNaN(e))return e-(n?0:1);for(var a,o=0,r=t.length;r>o;o++){var s=t[o];if(s.id===e){a=o;break}}return a}function O(e,t,i){i=i||{},e.each(function(){var e,a=n(this),o=a.data();o.clickOn||(o.clickOn=!0,n.extend(ie(a,{onStart:function(t){e=t,(i.onStart||r).call(this,t)},onMove:i.onMove||r,onTouchEnd:i.onTouchEnd||r,onEnd:function(i){i.moved||t.call(this,e)}}),{noMove:!0}))})}function A(e,t){return'<div class="'+e+'">'+(t||"")+"</div>"}function B(e){for(var t=e.length;t;){var i=Math.floor(Math.random()*t--),n=e[t];e[t]=e[i],e[i]=n}return e}function R(e){return"[object Array]"==Object.prototype.toString.call(e)&&n.map(e,function(e){return n.extend({},e)})}function U(e,t,i){e.scrollLeft(t||0).scrollTop(i||0)}function H(e){if(e){var t={};return n.each(e,function(e,i){t[e.toLowerCase()]=i}),t}}function q(e){if(e){var t=+e;return isNaN(t)?(t=e.split("/"),+t[0]/+t[1]||a):t}}function W(e,t,i,n){t&&(e.addEventListener?e.addEventListener(t,i,!!n):e.attachEvent("on"+t,i))}function V(e){return!!e.getAttribute("disabled")}function Q(e){return{tabindex:-1*e+"",disabled:e}}function G(e,t){W(e,"keyup",function(i){V(e)||13==i.keyCode&&t.call(e,i)})}function Y(e,t){W(e,"focus",e.onfocusin=function(i){t.call(e,i)},!0)}function K(e,t){e.preventDefault?e.preventDefault():e.returnValue=!1,t&&e.stopPropagation&&e.stopPropagation()}function J(e){return e?">":"<"}function X(e){return e=(e+"").split(/\s+/),{x:_(e[0])||ti,y:_(e[1])||ti}}function Z(e,t){var i=e.data(),a=Math.round(t.pos),o=function(){i.sliding=!1,(t.onEnd||r)()};"undefined"!=typeof t.overPos&&t.overPos!==t.pos&&(a=t.overPos,o=function(){Z(e,n.extend({},t,{overPos:t.pos,time:Math.max(Ut,t.time/2)}))});var s=n.extend(c(a),t.width&&{width:t.width});i.sliding=!0,jt?(e.css(n.extend(u(t.time),s)),t.time>10?b(e,"transform",o,t.time):o()):e.stop().animate(s,t.time,Zt,o)}function ee(e,t,i,a,o,s){var l="undefined"!=typeof s;if(l||(o.push(arguments),Array.prototype.push.call(arguments,o.length),!(o.length>1))){e=e||n(e),t=t||n(t);var d=e[0],c=t[0],u="crossfade"===a.method,f=function(){if(!f.done){f.done=!0;var e=(l||o.shift())&&o.shift();e&&ee.apply(this,e),(a.onEnd||r)(!!e)}},p=a.time/(s||1);i.removeClass(He+" "+Ue),e.stop().addClass(He),t.stop().addClass(Ue),u&&c&&e.fadeTo(0,0),e.fadeTo(u?p:0,1,u&&f),t.fadeTo(p,0,f),d&&u||c||f()}}function te(e){var t=(e.touches||[])[0]||e;e._x=t.pageX,e._y=t.clientY,e._now=n.now()}function ie(e,i){function a(e){return f=n(e.target),b.checked=m=_=g=!1,c||b.flow||e.touches&&e.touches.length>1||e.which>1||ai&&ai.type!==e.type&&ri||(m=i.select&&f.is(i.select,v))?m:(h="touchstart"===e.type,_=f.is("a, a *",v),p=b.control,w=b.noMove||b.noSwipe||p?16:b.snap?0:4,te(e),u=ai=e,oi=e.type.replace(/down|start/,"move").replace(/Down/,"Move"),(i.onStart||r).call(v,e,{control:p,$target:f}),c=b.flow=!0,void((!h||b.go)&&K(e)))}function o(e){if(e.touches&&e.touches.length>1||At&&!e.isPrimary||oi!==e.type||!c)return c&&s(),void(i.onTouchEnd||r)();te(e);var t=Math.abs(e._x-u._x),n=Math.abs(e._y-u._y),a=t-n,o=(b.go||b.x||a>=0)&&!b.noSwipe,l=0>a;h&&!b.checked?(c=o)&&K(e):(K(e),(i.onMove||r).call(v,e,{touch:h})),!g&&Math.sqrt(Math.pow(t,2)+Math.pow(n,2))>w&&(g=!0),b.checked=b.checked||o||l}function s(e){(i.onTouchEnd||r)();var t=c;b.control=c=!1,t&&(b.flow=!1),!t||_&&!b.checked||(e&&K(e),ri=!0,clearTimeout(si),si=setTimeout(function(){ri=!1},1e3),(i.onEnd||r).call(v,{moved:g,$target:f,control:p,touch:h,startEvent:u,aborted:!e||"MSPointerCancel"===e.type}))}function l(){b.flow||setTimeout(function(){b.flow=!0},10)}function d(){b.flow&&setTimeout(function(){b.flow=!1},Rt)}var c,u,f,p,h,m,_,w,g,v=e[0],b={};return At?(W(v,"MSPointerDown",a),W(t,"MSPointerMove",o),W(t,"MSPointerCancel",s),W(t,"MSPointerUp",s)):(W(v,"touchstart",a),W(v,"touchmove",o),W(v,"touchend",s),W(t,"touchstart",l),W(t,"touchend",d),W(t,"touchcancel",d),Ft.on("scroll",d),e.on("mousedown",a),Pt.on("mousemove",o).on("mouseup",s)),e.on("click","a",function(e){b.checked&&K(e)}),b}function ne(e,t){function i(i,n){S=!0,d=u=i._x,_=i._now,m=[[_,d]],f=p=E.noMove||n?0:y(e,(t.getPos||r)()),(t.onStart||r).call(T,i)}function a(e,t){g=E.min,v=E.max,b=E.snap,k=e.altKey,S=C=!1,x=t.control,x||M.sliding||i(e)}function o(n,a){E.noSwipe||(S||i(n),u=n._x,m.push([n._now,u]),p=f-(d-u),h=L(p,g,v),g>=p?p=$(p,g):p>=v&&(p=$(p,v)),E.noMove||(e.css(c(p)),C||(C=!0,a.touch||At||e.addClass(at)),(t.onMove||r).call(T,n,{pos:p,edge:h})))}function l(a){if(!E.noSwipe||!a.moved){S||i(a.startEvent,!0),a.touch||At||e.removeClass(at),w=n.now();for(var o,l,d,c,h,_,y,$,x,C=w-Rt,M=null,F=Ut,P=t.friction,I=m.length-1;I>=0;I--){if(o=m[I][0],l=Math.abs(o-C),null===M||d>l)M=o,c=m[I][1];else if(M===C||l>d)break;d=l}y=s(p,g,v);var z=c-u,j=z>=0,D=w-M,L=D>Rt,N=!L&&p!==f&&y===p;b&&(y=s(Math[N?j?"floor":"ceil":"round"](p/b)*b,g,v),g=v=y),N&&(b||y===p)&&(x=-(z/D),F*=s(Math.abs(x),t.timeLow,t.timeHigh),h=Math.round(p+x*F/P),b||(y=h),(!j&&h>v||j&&g>h)&&(_=j?g:v,$=h-_,b||(y=_),$=s(y+.03*$,_-50,_+50),F=Math.abs((p-$)/(x/P)))),F*=k?10:1,(t.onEnd||r).call(T,n.extend(a,{moved:a.moved||L&&b,pos:p,newPos:y,overPos:$,time:F}))}}var d,u,f,p,h,m,_,w,g,v,b,k,x,C,S,T=e[0],M=e.data(),E={};return E=n.extend(ie(t.$wrap,n.extend({},t,{onStart:a,onMove:o,onEnd:l})),E)}function ae(e,t){var i,a,o,s=e[0],l={prevent:{}};return W(s,Bt,function(e){var s=e.wheelDeltaY||-1*e.deltaY||0,d=e.wheelDeltaX||-1*e.deltaX||0,c=Math.abs(d)&&!Math.abs(s),u=J(0>d),f=a===u,p=n.now(),h=Rt>p-o;a=u,o=p,c&&l.ok&&(!l.prevent[u]||i)&&(K(e,!0),i&&f&&h||(t.shift&&(i=!0,clearTimeout(l.t),l.t=setTimeout(function(){i=!1},Ht)),(t.onEnd||r)(e,t.shift?u:d)))}),l}function oe(){n.each(n.Fotorama.instances,function(e,t){t.index=e})}function re(e){n.Fotorama.instances.push(e),oe()}function se(e){n.Fotorama.instances.splice(e.index,1),oe()}var le="fotorama",de="fullscreen",ce=le+"__wrap",ue=ce+"--css2",fe=ce+"--css3",pe=ce+"--video",he=ce+"--fade",me=ce+"--slide",_e=ce+"--no-controls",we=ce+"--no-shadows",ge=ce+"--pan-y",ve=ce+"--rtl",be=ce+"--only-active",ye=ce+"--no-captions",ke=ce+"--toggle-arrows",$e=le+"__stage",xe=$e+"__frame",Ce=xe+"--video",Se=$e+"__shaft",Te=le+"__grab",Me=le+"__pointer",Ee=le+"__arr",Fe=Ee+"--disabled",Pe=Ee+"--prev",Ie=Ee+"--next",ze=le+"__nav",je=ze+"-wrap",De=ze+"__shaft",Le=ze+"--dots",Ne=ze+"--thumbs",Oe=ze+"__frame",Ae=Oe+"--dot",Be=Oe+"--thumb",Re=le+"__fade",Ue=Re+"-front",He=Re+"-rear",qe=le+"__shadow",We=qe+"s",Ve=We+"--left",Qe=We+"--right",Ge=le+"__active",Ye=le+"__select",Ke=le+"--hidden",Je=le+"--fullscreen",Xe=le+"__fullscreen-icon",Ze=le+"__error",et=le+"__loading",tt=le+"__loaded",it=tt+"--full",nt=tt+"--img",at=le+"__grabbing",ot=le+"__img",rt=ot+"--full",st=le+"__dot",lt=le+"__thumb",dt=lt+"-border",ct=le+"__html",ut=le+"__video",ft=ut+"-play",pt=ut+"-close",ht=le+"__caption",mt=le+"__caption__wrap",_t=le+"__spinner",wt='" tabindex="0" role="button',gt=n&&n.fn.jquery.split(".");if(!gt||gt[0]<1||1==gt[0]&&gt[1]<8)throw"Fotorama requires jQuery 1.8 or later and will not run without it.";var vt={},bt=function(e,t,i){function n(e){w.cssText=e}function a(e,t){return typeof e===t}function o(e,t){return!!~(""+e).indexOf(t)}function r(e,t){for(var n in e){var a=e[n];if(!o(a,"-")&&w[a]!==i)return"pfx"!=t||a}return!1}function s(e,t,n){for(var o in e){var r=t[e[o]];if(r!==i)return n===!1?e[o]:a(r,"function")?r.bind(n||t):r}return!1}function l(e,t,i){var n=e.charAt(0).toUpperCase()+e.slice(1),o=(e+" "+b.join(n+" ")+n).split(" ");return a(t,"string")||a(t,"undefined")?r(o,t):(o=(e+" "+y.join(n+" ")+n).split(" "),s(o,t,i))}var d,c,u,f="2.6.2",p={},h=t.documentElement,m="modernizr",_=t.createElement(m),w=_.style,g=({}.toString," -webkit- -moz- -o- -ms- ".split(" ")),v="Webkit Moz O ms",b=v.split(" "),y=v.toLowerCase().split(" "),k={},$=[],x=$.slice,C=function(e,i,n,a){var o,r,s,l,d=t.createElement("div"),c=t.body,u=c||t.createElement("body");if(parseInt(n,10))for(;n--;)s=t.createElement("div"),s.id=a?a[n]:m+(n+1),d.appendChild(s);return o=["&#173;",'<style id="s',m,'">',e,"</style>"].join(""),d.id=m,(c?d:u).innerHTML+=o,u.appendChild(d),c||(u.style.background="",u.style.overflow="hidden",l=h.style.overflow,h.style.overflow="hidden",h.appendChild(u)),r=i(d,e),c?d.parentNode.removeChild(d):(u.parentNode.removeChild(u),h.style.overflow=l),!!r},S={}.hasOwnProperty;u=a(S,"undefined")||a(S.call,"undefined")?function(e,t){return t in e&&a(e.constructor.prototype[t],"undefined")}:function(e,t){return S.call(e,t)},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if("function"!=typeof t)throw new TypeError;var i=x.call(arguments,1),n=function(){if(this instanceof n){var a=function(){};a.prototype=t.prototype;var o=new a,r=t.apply(o,i.concat(x.call(arguments)));return Object(r)===r?r:o}return t.apply(e,i.concat(x.call(arguments)))};return n}),k.csstransforms3d=function(){var e=!!l("perspective");return e};for(var T in k)u(k,T)&&(c=T.toLowerCase(),p[c]=k[T](),$.push((p[c]?"":"no-")+c));return p.addTest=function(e,t){if("object"==typeof e)for(var n in e)u(e,n)&&p.addTest(n,e[n]);else{if(e=e.toLowerCase(),p[e]!==i)return p;t="function"==typeof t?t():t,"undefined"!=typeof enableClasses&&enableClasses&&(h.className+=" "+(t?"":"no-")+e),p[e]=t}return p},n(""),_=d=null,p._version=f,p._prefixes=g,p._domPrefixes=y,p._cssomPrefixes=b,p.testProp=function(e){return r([e])},p.testAllProps=l,p.testStyles=C,p.prefixed=function(e,t,i){return t?l(e,t,i):l(e,"pfx")},p}(e,t),yt={ok:!1,is:function(){return!1},request:function(){},cancel:function(){},event:"",prefix:""},kt="webkit moz o ms khtml".split(" ");if("undefined"!=typeof t.cancelFullScreen)yt.ok=!0;else for(var $t=0,xt=kt.length;xt>$t;$t++)if(yt.prefix=kt[$t],"undefined"!=typeof t[yt.prefix+"CancelFullScreen"]){yt.ok=!0;break}yt.ok&&(yt.event=yt.prefix+"fullscreenchange",yt.is=function(){switch(this.prefix){case"":return t.fullScreen;case"webkit":return t.webkitIsFullScreen;default:return t[this.prefix+"FullScreen"]}},yt.request=function(e){return""===this.prefix?e.requestFullScreen():e[this.prefix+"RequestFullScreen"]()},yt.cancel=function(){return""===this.prefix?t.cancelFullScreen():t[this.prefix+"CancelFullScreen"]()});var Ct,St={lines:12,length:5,width:2,radius:7,corners:1,rotate:15,color:"rgba(128, 128, 128, .75)",hwaccel:!0},Tt={top:"auto",left:"auto",className:""};!function(e,t){Ct=t()}(this,function(){function e(e,i){var n,a=t.createElement(e||"div");for(n in i)a[n]=i[n];return a}function i(e){for(var t=1,i=arguments.length;i>t;t++)e.appendChild(arguments[t]);return e}function n(e,t,i,n){var a=["opacity",t,~~(100*e),i,n].join("-"),o=.01+i/n*100,r=Math.max(1-(1-e)/t*(100-o),e),s=f.substring(0,f.indexOf("Animation")).toLowerCase(),l=s&&"-"+s+"-"||"";return h[a]||(m.insertRule("@"+l+"keyframes "+a+"{0%{opacity:"+r+"}"+o+"%{opacity:"+e+"}"+(o+.01)+"%{opacity:1}"+(o+t)%100+"%{opacity:"+e+"}100%{opacity:"+r+"}}",m.cssRules.length),h[a]=1),a}function o(e,t){var i,n,o=e.style;for(t=t.charAt(0).toUpperCase()+t.slice(1),n=0;n<p.length;n++)if(i=p[n]+t,o[i]!==a)return i;return o[t]!==a?t:void 0}function r(e,t){for(var i in t)e.style[o(e,i)||i]=t[i];return e}function s(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)e[n]===a&&(e[n]=i[n])}return e}function l(e){for(var t={x:e.offsetLeft,y:e.offsetTop};e=e.offsetParent;)t.x+=e.offsetLeft,t.y+=e.offsetTop;return t}function d(e,t){return"string"==typeof e?e:e[t%e.length]}function c(e){return"undefined"==typeof this?new c(e):void(this.opts=s(e||{},c.defaults,_))}function u(){function t(t,i){return e("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',i)}m.addRule(".spin-vml","behavior:url(#default#VML)"),c.prototype.lines=function(e,n){function a(){return r(t("group",{coordsize:c+" "+c,coordorigin:-l+" "+-l}),{width:c,height:c})}function o(e,o,s){i(f,i(r(a(),{rotation:360/n.lines*e+"deg",left:~~o}),i(r(t("roundrect",{arcsize:n.corners}),{width:l,height:n.width,left:n.radius,top:-n.width>>1,filter:s}),t("fill",{color:d(n.color,e),opacity:n.opacity}),t("stroke",{opacity:0}))))}var s,l=n.length+n.width,c=2*l,u=2*-(n.width+n.length)+"px",f=r(a(),{position:"absolute",top:u,left:u});if(n.shadow)for(s=1;s<=n.lines;s++)o(s,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(s=1;s<=n.lines;s++)o(s);return i(e,f)},c.prototype.opacity=function(e,t,i,n){var a=e.firstChild;n=n.shadow&&n.lines||0,a&&t+n<a.childNodes.length&&(a=a.childNodes[t+n],a=a&&a.firstChild,a=a&&a.firstChild,a&&(a.opacity=i))}}var f,p=["webkit","Moz","ms","O"],h={},m=function(){var n=e("style",{type:"text/css"});return i(t.getElementsByTagName("head")[0],n),n.sheet||n.styleSheet}(),_={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto",position:"relative"};c.defaults={},s(c.prototype,{spin:function(t){this.stop();var i,n,a=this,o=a.opts,s=a.el=r(e(0,{className:o.className}),{position:o.position,width:0,zIndex:o.zIndex}),d=o.radius+o.length+o.width;if(t&&(t.insertBefore(s,t.firstChild||null),n=l(t),i=l(s),r(s,{left:("auto"==o.left?n.x-i.x+(t.offsetWidth>>1):parseInt(o.left,10)+d)+"px",top:("auto"==o.top?n.y-i.y+(t.offsetHeight>>1):parseInt(o.top,10)+d)+"px"})),s.setAttribute("role","progressbar"),a.lines(s,a.opts),!f){var c,u=0,p=(o.lines-1)*(1-o.direction)/2,h=o.fps,m=h/o.speed,_=(1-o.opacity)/(m*o.trail/100),w=m/o.lines;!function e(){u++;for(var t=0;t<o.lines;t++)c=Math.max(1-(u+(o.lines-t)*w)%m*_,o.opacity),
a.opacity(s,t*o.direction+p,c,o);a.timeout=a.el&&setTimeout(e,~~(1e3/h))}()}return a},stop:function(){var e=this.el;return e&&(clearTimeout(this.timeout),e.parentNode&&e.parentNode.removeChild(e),this.el=a),this},lines:function(t,a){function o(t,i){return r(e(),{position:"absolute",width:a.length+a.width+"px",height:a.width+"px",background:t,boxShadow:i,transformOrigin:"left",transform:"rotate("+~~(360/a.lines*l+a.rotate)+"deg) translate("+a.radius+"px,0)",borderRadius:(a.corners*a.width>>1)+"px"})}for(var s,l=0,c=(a.lines-1)*(1-a.direction)/2;l<a.lines;l++)s=r(e(),{position:"absolute",top:1+~(a.width/2)+"px",transform:a.hwaccel?"translate3d(0,0,0)":"",opacity:a.opacity,animation:f&&n(a.opacity,a.trail,c+l*a.direction,a.lines)+" "+1/a.speed+"s linear infinite"}),a.shadow&&i(s,r(o("#000","0 0 4px #000"),{top:"2px"})),i(t,i(s,o(d(a.color,l),"0 0 1px rgba(0,0,0,.1)")));return t},opacity:function(e,t,i){t<e.childNodes.length&&(e.childNodes[t].style.opacity=i)}});var w=r(e("group"),{behavior:"url(#default#VML)"});return!o(w,"transform")&&w.adj?u():f=o(w,"animation"),c});var Mt,Et,Ft=n(e),Pt=n(t),It="quirks"===i.hash.replace("#",""),zt=bt.csstransforms3d,jt=zt&&!It,Dt=zt||"CSS1Compat"===t.compatMode,Lt=yt.ok,Nt=navigator.userAgent.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|Windows Phone/i),Ot=!jt||Nt,At=navigator.msPointerEnabled,Bt="onwheel"in t.createElement("div")?"wheel":t.onmousewheel!==a?"mousewheel":"DOMMouseScroll",Rt=250,Ut=300,Ht=1400,qt=5e3,Wt=2,Vt=64,Qt=500,Gt=333,Yt="$stageFrame",Kt="$navDotFrame",Jt="$navThumbFrame",Xt="auto",Zt=o([.1,0,.25,1]),ei=99999,ti="50%",ii={width:null,minwidth:null,maxwidth:"100%",height:null,minheight:null,maxheight:null,ratio:null,margin:Wt,glimpse:0,fit:"contain",position:ti,thumbposition:ti,nav:"dots",navposition:"bottom",navwidth:null,thumbwidth:Vt,thumbheight:Vt,thumbmargin:Wt,thumbborderwidth:Wt,thumbfit:"cover",allowfullscreen:!1,transition:"slide",clicktransition:null,transitionduration:Ut,captions:!0,hash:!1,startindex:0,loop:!1,autoplay:!1,stopautoplayontouch:!0,keyboard:!1,arrows:!0,click:!0,swipe:!0,trackpad:!1,enableifsingleframe:!1,controlsonstart:!0,shuffle:!1,direction:"ltr",shadows:!0,spinner:null},ni={left:!0,right:!0,down:!1,up:!1,space:!1,home:!1,end:!1};I.stop=function(e){I.ii[e]=!1};var ai,oi,ri,si;jQuery.Fotorama=function(e,a){function o(){n.each(xi,function(e,t){if(!t.i){t.i=pn++;var i=S(t.video,!0);if(i){var n={};t.video=i,t.img||t.thumb?t.thumbsReady=!0:n=T(t,xi,dn),M(xi,{img:n.img,thumb:n.thumb},t.i,dn)}}})}function r(e){return Ji[e]||dn.fullScreen}function l(e){var t="keydown."+le,i=le+cn,n="keydown."+i,o="resize."+i+" orientationchange."+i;e?(Pt.on(n,function(e){var t,i;Mi&&27===e.keyCode?(t=!0,fi(Mi,!0,!0)):(dn.fullScreen||a.keyboard&&!dn.index)&&(27===e.keyCode?(t=!0,dn.cancelFullScreen()):e.shiftKey&&32===e.keyCode&&r("space")||37===e.keyCode&&r("left")||38===e.keyCode&&r("up")?i="<":32===e.keyCode&&r("space")||39===e.keyCode&&r("right")||40===e.keyCode&&r("down")?i=">":36===e.keyCode&&r("home")?i="<<":35===e.keyCode&&r("end")&&(i=">>")),(t||i)&&K(e),i&&dn.show({index:i,slow:e.altKey,user:!0})}),dn.index||Pt.off(t).on(t,"textarea, input, select",function(e){!Et.hasClass(de)&&e.stopPropagation()}),Ft.on(o,dn.resize)):(Pt.off(n),Ft.off(o))}function d(t){t!==d.f&&(t?(e.html("").addClass(le+" "+un).append(wn).before(mn).before(_n),re(dn)):(wn.detach(),mn.detach(),_n.detach(),e.html(hn.urtext).removeClass(un),se(dn)),l(t),d.f=t)}function f(){xi=dn.data=xi||R(a.data)||E(e),Ci=dn.size=xi.length,!$i.ok&&a.shuffle&&B(xi),o(),Ln=x(Ln),Ci&&d(!0)}function h(){var e=2>Ci&&!a.enableifsingleframe||Mi;An.noMove=e||qi,An.noSwipe=e||!a.swipe,!Gi&&vn.toggleClass(Te,!a.click&&!An.noMove&&!An.noSwipe),At&&wn.toggleClass(ge,!An.noSwipe)}function v(e){e===!0&&(e=""),a.autoplay=Math.max(+e||qt,1.5*Qi)}function b(){function e(e,i){t[e?"add":"remove"].push(i)}dn.options=a=H(a),qi="crossfade"===a.transition||"dissolve"===a.transition,Oi=a.loop&&(Ci>2||qi&&(!Gi||"slide"!==Gi)),Qi=+a.transitionduration||Ut,Ki="rtl"===a.direction,Ji=n.extend({},a.keyboard&&ni,a.keyboard);var t={add:[],remove:[]};Ci>1||a.enableifsingleframe?(Ai=a.nav,Ri="top"===a.navposition,t.remove.push(Ye),$n.toggle(!!a.arrows)):(Ai=!1,$n.hide()),He(),Ti=new Ct(n.extend(St,a.spinner,Tt,{direction:Ki?-1:1})),It(),zt(),a.autoplay&&v(a.autoplay),Wi=p(a.thumbwidth)||Vt,Vi=p(a.thumbheight)||Vt,Bn.ok=Un.ok=a.trackpad&&!Ot,h(),ai(a,[On]),Bi="thumbs"===Ai,Bi?(ut(Ci,"navThumb"),Si=Mn,ln=Jt,D(mn,n.Fotorama.jst.style({w:Wi,h:Vi,b:a.thumbborderwidth,m:a.thumbmargin,s:cn,q:!Dt})),Cn.addClass(Ne).removeClass(Le)):"dots"===Ai?(ut(Ci,"navDot"),Si=Tn,ln=Kt,Cn.addClass(Le).removeClass(Ne)):(Ai=!1,Cn.removeClass(Ne+" "+Le)),Ai&&(Ri?xn.insertBefore(gn):xn.insertAfter(gn),kt.nav=!1,kt(Si,Sn,"nav")),Ui=a.allowfullscreen,Ui?(Fn.prependTo(gn),Hi=Lt&&"native"===Ui):(Fn.detach(),Hi=!1),e(qi,he),e(!qi,me),e(!a.captions,ye),e(Ki,ve),e("always"!==a.arrows,ke),Yi=a.shadows&&!Ot,e(!Yi,we),wn.addClass(t.add.join(" ")).removeClass(t.remove.join(" ")),Nn=n.extend({},a)}function $(e){return 0>e?(Ci+e%Ci)%Ci:e>=Ci?e%Ci:e}function x(e){return s(e,0,Ci-1)}function C(e){return Oi?$(e):x(e)}function F(e){return!!(e>0||Oi)&&e-1}function V(e){return!!(Ci-1>e||Oi)&&e+1}function X(){An.min=Oi?-1/0:-w(Ci-1,On.w,a.margin,Pi),An.max=Oi?1/0:-w(0,On.w,a.margin,Pi),An.snap=On.w+a.margin}function te(){Rn.min=Math.min(0,On.nw-Sn.width()),Rn.max=0,Sn.toggleClass(Te,!(Rn.noMove=Rn.min===Rn.max))}function ie(e,t,i){if("number"==typeof e){e=new Array(e);var a=!0}return n.each(e,function(e,n){if(a&&(n=e),"number"==typeof n){var o=xi[$(n)];if(o){var r="$"+t+"Frame",s=o[r];i.call(this,e,n,o,s,r,s&&s.data())}}})}function oe(e,t,i,n){(!Xi||"*"===Xi&&n===Ni)&&(e=_(a.width)||_(e)||Qt,t=_(a.height)||_(t)||Gt,dn.resize({width:e,ratio:a.ratio||i||e/t},0,n!==Ni&&"*"))}function Re(e,t,i,o,r,s){ie(e,t,function(e,l,d,c,u,f){function p(e){var t=$(l);oi(e,{index:t,src:k,frame:xi[t]})}function h(){v.remove(),n.Fotorama.cache[k]="error",d.html&&"stage"===t||!x||x===k?(!k||d.html||w?"stage"===t&&(c.trigger("f:load").removeClass(et+" "+Ze).addClass(tt),p("load"),oe()):(c.trigger("f:error").removeClass(et).addClass(Ze),p("error")),f.state="error",!(Ci>1&&xi[l]===d)||d.html||d.deleted||d.video||w||(d.deleted=!0,dn.splice(l,1))):(d[y]=k=x,Re([l],t,i,o,r,!0))}function m(){n.Fotorama.measures[k]=b.measures=n.Fotorama.measures[k]||{width:g.width,height:g.height,ratio:g.width/g.height},oe(b.measures.width,b.measures.height,b.measures.ratio,l),v.off("load error").addClass(ot+(w?" "+rt:"")).prependTo(c),j(v,(n.isFunction(i)?i():i)||On,o||d.fit||a.fit,r||d.position||a.position),n.Fotorama.cache[k]=f.state="loaded",setTimeout(function(){c.trigger("f:load").removeClass(et+" "+Ze).addClass(tt+" "+(w?it:nt)),"stage"===t?p("load"):(d.thumbratio===Xt||!d.thumbratio&&a.thumbratio===Xt)&&(d.thumbratio=b.measures.ratio,yi())},0)}function _(){var e=10;I(function(){return!rn||!e--&&!Ot},function(){m()})}if(c){var w=dn.fullScreen&&d.full&&d.full!==d.img&&!f.$full&&"stage"===t;if(!f.$img||s||w){var g=new Image,v=n(g),b=v.data();f[w?"$full":"$img"]=v;var y="stage"===t?w?"full":"img":"thumb",k=d[y],x=w?null:d["stage"===t?"thumb":"img"];if("navThumb"===t&&(c=f.$wrap),!k)return void h();n.Fotorama.cache[k]?!function e(){"error"===n.Fotorama.cache[k]?h():"loaded"===n.Fotorama.cache[k]?setTimeout(_,0):setTimeout(e,100)}():(n.Fotorama.cache[k]="*",v.on("load",_).on("error",h)),f.state="",g.src=k}}})}function Ue(e){Dn.append(Ti.spin().el).appendTo(e)}function He(){Dn.detach(),Ti&&Ti.stop()}function qe(){var e=Ei[Yt];e&&!e.data().state&&(Ue(e),e.on("f:load f:error",function(){e.off("f:load f:error"),He()}))}function at(e){G(e,gi),Y(e,function(){setTimeout(function(){U(Cn)},0),Ht({time:Qi,guessIndex:n(this).data().eq,minMax:Rn})})}function ut(e,t){ie(e,t,function(e,i,a,o,r,s){if(!o){o=a[r]=wn[r].clone(),s=o.data(),s.data=a;var l=o[0];"stage"===t?(a.html&&n('<div class="'+ct+'"></div>').append(a._html?n(a.html).removeAttr("id").html(a._html):a.html).appendTo(o),a.caption&&n(A(ht,A(mt,a.caption))).appendTo(o),a.video&&o.addClass(Ce).append(In.clone()),Y(l,function(){setTimeout(function(){U(gn)},0),mi({index:s.eq,user:!0})}),bn=bn.add(o)):"navDot"===t?(at(l),Tn=Tn.add(o)):"navThumb"===t&&(at(l),s.$wrap=o.children(":first"),Mn=Mn.add(o),a.video&&s.$wrap.append(In.clone()))}})}function gt(e,t,i,n){return e&&e.length&&j(e,t,i,n)}function vt(e){ie(e,"stage",function(e,t,i,o,r,s){if(o){var l=$(t),d=i.fit||a.fit,c=i.position||a.position;s.eq=l,qn[Yt][l]=o.css(n.extend({left:qi?0:w(t,On.w,a.margin,Pi)},qi&&u(0))),P(o[0])&&(o.appendTo(vn),fi(i.$video)),gt(s.$img,On,d,c),gt(s.$full,On,d,c)}})}function bt(e,t){if("thumbs"===Ai&&!isNaN(e)){var i=-e,o=-e+On.nw;Mn.each(function(){var e=n(this),r=e.data(),s=r.eq,l=function(){return{h:Vi,w:r.w}},d=l(),c=xi[s]||{},u=c.thumbfit||a.thumbfit,f=c.thumbposition||a.thumbposition;d.w=r.w,r.l+r.w<i||r.l>o||gt(r.$img,d,u,f)||t&&Re([s],"navThumb",l,u,f)})}}function kt(e,t,i){if(!kt[i]){var o="nav"===i&&Bi,r=0;t.append(e.filter(function(){for(var e,t=n(this),i=t.data(),a=0,o=xi.length;o>a;a++)if(i.data===xi[a]){e=!0,i.eq=a;break}return e||t.remove()&&!1}).sort(function(e,t){return n(e).data().eq-n(t).data().eq}).each(function(){if(o){var e=n(this),t=e.data(),i=Math.round(Vi*t.data.thumbratio)||Wi;t.l=r,t.w=i,e.css({width:i}),r+=i+a.thumbmargin}})),kt[i]=!0}}function $t(e){return e-Wn>On.w/3}function xt(e){return!(Oi||Ln+e&&Ln-Ci+e||Mi)}function It(){var e=xt(0),t=xt(1);yn.toggleClass(Fe,e).attr(Q(e)),kn.toggleClass(Fe,t).attr(Q(t))}function zt(){Bn.ok&&(Bn.prevent={"<":xt(0),">":xt(1)})}function Nt(e){var t,i,n=e.data();return Bi?(t=n.l,i=n.w):(t=e.position().left,i=e.width()),{c:t+i/2,min:-t+10*a.thumbmargin,max:-t+On.w-i-10*a.thumbmargin}}function Bt(e){var t=Ei[ln].data();Z(En,{time:1.2*e,pos:t.l,width:t.w-2*a.thumbborderwidth})}function Ht(e){var t=xi[e.guessIndex][ln];if(t){var i=Rn.min!==Rn.max,n=e.minMax||i&&Nt(Ei[ln]),a=i&&(e.keep&&Ht.l?Ht.l:s((e.coo||On.nw/2)-Nt(t).c,n.min,n.max)),o=i&&s(a,Rn.min,Rn.max),r=1.1*e.time;Z(Sn,{time:r,pos:o||0,onEnd:function(){bt(o,!0)}}),ui(Cn,L(o,Rn.min,Rn.max)),Ht.l=a}}function Wt(){Zt(ln),Hn[ln].push(Ei[ln].addClass(Ge))}function Zt(e){for(var t=Hn[e];t.length;)t.shift().removeClass(Ge)}function ti(e){var t=qn[e];n.each(Fi,function(e,i){delete t[$(i)]}),n.each(t,function(e,i){delete t[e],i.detach()})}function ii(e){Pi=Ii=Ln;var t=Ei[Yt];t&&(Zt(Yt),Hn[Yt].push(t.addClass(Ge)),e||dn.show.onEnd(!0),y(vn,0,!0),ti(Yt),vt(Fi),X(),te())}function ai(e,t){e&&n.each(t,function(t,i){i&&n.extend(i,{width:e.width||i.width,height:e.height,minwidth:e.minwidth,maxwidth:e.maxwidth,minheight:e.minheight,maxheight:e.maxheight,ratio:q(e.ratio)})})}function oi(t,i){e.trigger(le+":"+t,[dn,i])}function ri(){clearTimeout(si.t),rn=1,a.stopautoplayontouch?dn.stopAutoplay():nn=!0}function si(){rn&&(a.stopautoplayontouch||(li(),di()),si.t=setTimeout(function(){rn=0},Ut+Rt))}function li(){nn=!(!Mi&&!an)}function di(){if(clearTimeout(di.t),I.stop(di.w),!a.autoplay||nn)return void(dn.autoplay&&(dn.autoplay=!1,oi("stopautoplay")));dn.autoplay||(dn.autoplay=!0,oi("startautoplay"));var e=Ln,t=Ei[Yt].data();di.w=I(function(){return t.state||e!==Ln},function(){di.t=setTimeout(function(){if(!nn&&e===Ln){var t=Li,i=xi[t][Yt].data();di.w=I(function(){return i.state||t!==Li},function(){nn||t!==Li||dn.show(Oi?J(!Ki):Li)})}},a.autoplay)})}function ci(){dn.fullScreen&&(dn.fullScreen=!1,Lt&&yt.cancel(fn),Et.removeClass(de),Mt.removeClass(de),e.removeClass(Je).insertAfter(_n),On=n.extend({},on),fi(Mi,!0,!0),wi("x",!1),dn.resize(),Re(Fi,"stage"),U(Ft,en,Zi),oi("fullscreenexit"))}function ui(e,t){Yi&&(e.removeClass(Ve+" "+Qe),t&&!Mi&&e.addClass(t.replace(/^|\s/g," "+We+"--")))}function fi(e,t,i){t&&(wn.removeClass(pe),Mi=!1,h()),e&&e!==Mi&&(e.remove(),oi("unloadvideo")),i&&(li(),di())}function pi(e){wn.toggleClass(_e,e)}function hi(e){if(!An.flow){var t=e?e.pageX:hi.x,i=t&&!xt($t(t))&&a.click;hi.p!==i&&gn.toggleClass(Me,i)&&(hi.p=i,hi.x=t)}}function mi(e){clearTimeout(mi.t),a.clicktransition&&a.clicktransition!==a.transition?setTimeout(function(){var t=a.transition;dn.setOptions({transition:a.clicktransition}),Gi=t,mi.t=setTimeout(function(){dn.show(e)},10)},0):dn.show(e)}function _i(e,t){var i=e.target,o=n(i);o.hasClass(ft)?dn.playVideo():i===Pn?dn.toggleFullScreen():Mi?i===jn&&fi(Mi,!0,!0):t?pi():a.click&&mi({index:e.shiftKey||J($t(e._x)),slow:e.altKey,user:!0})}function wi(e,t){An[e]=Rn[e]=t}function gi(e){var t=n(this).data().eq;mi({index:t,slow:e.altKey,user:!0,coo:e._x-Cn.offset().left})}function vi(e){mi({index:$n.index(this)?">":"<",slow:e.altKey,user:!0})}function bi(e){Y(e,function(){setTimeout(function(){U(gn)},0),pi(!1)})}function yi(){if(f(),b(),!yi.i){yi.i=!0;var e=a.startindex;(e||a.hash&&i.hash)&&(Ni=N(e||i.hash.replace(/^#/,""),xi,0===dn.index||e,e)),Ln=Pi=Ii=zi=Ni=C(Ni)||0}if(Ci){if(ki())return;Mi&&fi(Mi,!0),Fi=[],ti(Yt),yi.ok=!0,dn.show({index:Ln,time:0}),dn.resize()}else dn.destroy()}function ki(){return!ki.f===Ki?(ki.f=Ki,Ln=Ci-1-Ln,dn.reverse(),!0):void 0}function $i(){$i.ok||($i.ok=!0,oi("ready"))}Mt=n("html"),Et=n("body");var xi,Ci,Si,Ti,Mi,Ei,Fi,Pi,Ii,zi,ji,Di,Li,Ni,Oi,Ai,Bi,Ri,Ui,Hi,qi,Wi,Vi,Qi,Gi,Yi,Ki,Ji,Xi,Zi,en,tn,nn,an,on,rn,sn,ln,dn=this,cn=n.now(),un=le+cn,fn=e[0],pn=1,hn=e.data(),mn=n("<style></style>"),_n=n(A(Ke)),wn=n(A(ce)),gn=n(A($e)).appendTo(wn),vn=(gn[0],n(A(Se)).appendTo(gn)),bn=n(),yn=n(A(Ee+" "+Pe+wt)),kn=n(A(Ee+" "+Ie+wt)),$n=yn.add(kn).appendTo(gn),xn=n(A(je)),Cn=n(A(ze)).appendTo(xn),Sn=n(A(De)).appendTo(Cn),Tn=n(),Mn=n(),En=(vn.data(),Sn.data(),n(A(dt)).appendTo(Sn)),Fn=n(A(Xe+wt)),Pn=Fn[0],In=n(A(ft)),zn=n(A(pt)).appendTo(gn),jn=zn[0],Dn=n(A(_t)),Ln=!1,Nn={},On={},An={},Bn={},Rn={},Un={},Hn={},qn={},Wn=0,Vn=[];wn[Yt]=n(A(xe)),wn[Jt]=n(A(Oe+" "+Be+wt,A(lt))),wn[Kt]=n(A(Oe+" "+Ae+wt,A(st))),Hn[Yt]=[],Hn[Jt]=[],Hn[Kt]=[],qn[Yt]={},wn.addClass(jt?fe:ue).toggleClass(_e,!a.controlsonstart),hn.fotorama=this,dn.startAutoplay=function(e){return dn.autoplay?this:(nn=an=!1,v(e||a.autoplay),di(),this)},dn.stopAutoplay=function(){return dn.autoplay&&(nn=an=!0,di()),this},dn.show=function(e){var t;"object"!=typeof e?(t=e,e={}):t=e.index,t=">"===t?Ii+1:"<"===t?Ii-1:"<<"===t?0:">>"===t?Ci-1:t,t=isNaN(t)?N(t,xi,!0):t,t="undefined"==typeof t?Ln||0:t,dn.activeIndex=Ln=C(t),ji=F(Ln),Di=V(Ln),Li=$(Ln+(Ki?-1:1)),Fi=[Ln,ji,Di],Ii=Oi?t:Ln;var i=Math.abs(zi-Ii),n=k(e.time,function(){return Math.min(Qi*(1+(i-1)/12),2*Qi)}),o=e.overPos;e.slow&&(n*=10);var r=Ei;dn.activeFrame=Ei=xi[Ln];var l=r===Ei&&!e.user;fi(Mi,Ei.i!==xi[$(Pi)].i),ut(Fi,"stage"),vt(Ot?[Ii]:[Ii,F(Ii),V(Ii)]),wi("go",!0),l||oi("show",{user:e.user,time:n}),nn=!0;var d=dn.show.onEnd=function(t){if(!d.ok){if(d.ok=!0,t||ii(!0),l||oi("showend",{user:e.user}),!t&&Gi&&Gi!==a.transition)return dn.setOptions({transition:Gi}),void(Gi=!1);qe(),Re(Fi,"stage"),wi("go",!1),zt(),hi(),li(),di()}};if(qi){var c=Ei[Yt],u=Ln!==zi?xi[zi][Yt]:null;ee(c,u,bn,{time:n,method:a.transition,onEnd:d},Vn)}else Z(vn,{pos:-w(Ii,On.w,a.margin,Pi),overPos:o,time:n,onEnd:d});if(It(),Ai){Wt();var f=x(Ln+s(Ii-zi,-1,1));Ht({time:n,coo:f!==Ln&&e.coo,guessIndex:"undefined"!=typeof e.coo?f:Ln,keep:l}),Bi&&Bt(n)}return tn="undefined"!=typeof zi&&zi!==Ln,zi=Ln,a.hash&&tn&&!dn.eq&&z(Ei.id||Ln+1),this},dn.requestFullScreen=function(){return Ui&&!dn.fullScreen&&(Zi=Ft.scrollTop(),en=Ft.scrollLeft(),U(Ft),wi("x",!0),on=n.extend({},On),e.addClass(Je).appendTo(Et.addClass(de)),Mt.addClass(de),fi(Mi,!0,!0),dn.fullScreen=!0,Hi&&yt.request(fn),dn.resize(),Re(Fi,"stage"),qe(),oi("fullscreenenter")),this},dn.cancelFullScreen=function(){return Hi&&yt.is()?yt.cancel(t):ci(),this},dn.toggleFullScreen=function(){return dn[(dn.fullScreen?"cancel":"request")+"FullScreen"]()},W(t,yt.event,function(){!xi||yt.is()||Mi||ci()}),dn.resize=function(e){if(!xi)return this;var t=arguments[1]||0,i=arguments[2];ai(dn.fullScreen?{width:"100%",maxwidth:null,minwidth:null,height:"100%",maxheight:null,minheight:null}:H(e),[On,i||dn.fullScreen||a]);var n=On.width,o=On.height,r=On.ratio,l=Ft.height()-(Ai?Cn.height():0);return _(n)&&(wn.addClass(be).css({width:n,minWidth:On.minwidth||0,maxWidth:On.maxwidth||ei}),n=On.W=On.w=wn.width(),On.nw=Ai&&m(a.navwidth,n)||n,a.glimpse&&(On.w-=Math.round(2*(m(a.glimpse,n)||0))),vn.css({width:On.w,marginLeft:(On.W-On.w)/2}),o=m(o,l),o=o||r&&n/r,o&&(n=Math.round(n),o=On.h=Math.round(s(o,m(On.minheight,l),m(On.maxheight,l))),gn.stop().animate({width:n,height:o},t,function(){wn.removeClass(be)}),ii(),Ai&&(Cn.stop().animate({width:On.nw},t),Ht({guessIndex:Ln,time:t,keep:!0}),Bi&&kt.nav&&Bt(t)),Xi=i||!0,$i())),Wn=gn.offset().left,this},dn.setOptions=function(e){return n.extend(a,e),yi(),this},dn.shuffle=function(){return xi&&B(xi)&&yi(),this},dn.destroy=function(){return dn.cancelFullScreen(),dn.stopAutoplay(),xi=dn.data=null,d(),Fi=[],ti(Yt),yi.ok=!1,this},dn.playVideo=function(){var e=Ei,t=e.video,i=Ln;return"object"==typeof t&&e.videoReady&&(Hi&&dn.fullScreen&&dn.cancelFullScreen(),I(function(){return!yt.is()||i!==Ln},function(){i===Ln&&(e.$video=e.$video||n(n.Fotorama.jst.video(t)),e.$video.appendTo(e[Yt]),wn.addClass(pe),Mi=e.$video,h(),$n.blur(),Fn.blur(),oi("loadvideo"))})),this},dn.stopVideo=function(){return fi(Mi,!0,!0),this},gn.on("mousemove",hi),An=ne(vn,{onStart:ri,onMove:function(e,t){ui(gn,t.edge)},onTouchEnd:si,onEnd:function(e){ui(gn);var t=(At&&!sn||e.touch)&&a.arrows&&"always"!==a.arrows;if(e.moved||t&&e.pos!==e.newPos&&!e.control){var i=g(e.newPos,On.w,a.margin,Pi);dn.show({index:i,time:qi?Qi:e.time,overPos:e.overPos,user:!0})}else e.aborted||e.control||_i(e.startEvent,t)},timeLow:1,timeHigh:1,friction:2,select:"."+Ye+", ."+Ye+" *",$wrap:gn}),Rn=ne(Sn,{onStart:ri,onMove:function(e,t){ui(Cn,t.edge)},onTouchEnd:si,onEnd:function(e){function t(){Ht.l=e.newPos,li(),di(),bt(e.newPos,!0)}if(e.moved)e.pos!==e.newPos?(nn=!0,Z(Sn,{time:e.time,pos:e.newPos,overPos:e.overPos,onEnd:t}),bt(e.newPos),Yi&&ui(Cn,L(e.newPos,Rn.min,Rn.max))):t();else{var i=e.$target.closest("."+Oe,Sn)[0];i&&gi.call(i,e.startEvent)}},timeLow:.5,timeHigh:2,friction:5,$wrap:Cn}),Bn=ae(gn,{shift:!0,onEnd:function(e,t){ri(),si(),dn.show({index:t,slow:e.altKey})}}),Un=ae(Cn,{onEnd:function(e,t){ri(),si();var i=y(Sn)+.25*t;Sn.css(c(s(i,Rn.min,Rn.max))),Yi&&ui(Cn,L(i,Rn.min,Rn.max)),Un.prevent={"<":i>=Rn.max,">":i<=Rn.min},clearTimeout(Un.t),Un.t=setTimeout(function(){Ht.l=i,bt(i,!0)},Rt),bt(i)}}),wn.hover(function(){setTimeout(function(){rn||pi(!(sn=!0))},0)},function(){sn&&pi(!(sn=!1))}),O($n,function(e){K(e),vi.call(this,e)},{onStart:function(){ri(),An.control=!0},onTouchEnd:si}),$n.each(function(){G(this,function(e){vi.call(this,e)}),bi(this)}),G(Pn,dn.toggleFullScreen),bi(Pn),n.each("load push pop shift unshift reverse sort splice".split(" "),function(e,t){dn[t]=function(){return xi=xi||[],"load"!==t?Array.prototype[t].apply(xi,arguments):arguments[0]&&"object"==typeof arguments[0]&&arguments[0].length&&(xi=R(arguments[0])),yi(),dn}}),yi()},n.fn.fotorama=function(t){return this.each(function(){var i=this,a=n(this),o=a.data(),r=o.fotorama;r?r.setOptions(t,!0):I(function(){return!F(i)},function(){o.urtext=a.html(),new n.Fotorama(a,n.extend({},ii,e.fotoramaDefaults,t,o))})})},n.Fotorama.instances=[],n.Fotorama.cache={},n.Fotorama.measures={},n=n||{},n.Fotorama=n.Fotorama||{},n.Fotorama.jst=n.Fotorama.jst||{},n.Fotorama.jst.style=function(e){var t,i="";return vt.escape,i+=".fotorama"+(null==(t=e.s)?"":t)+" .fotorama__nav--thumbs .fotorama__nav__frame{\npadding:"+(null==(t=e.m)?"":t)+"px;\nheight:"+(null==(t=e.h)?"":t)+"px}\n.fotorama"+(null==(t=e.s)?"":t)+" .fotorama__thumb-border{\nheight:"+(null==(t=e.h-e.b*(e.q?0:2))?"":t)+"px;\nborder-width:"+(null==(t=e.b)?"":t)+"px;\nmargin-top:"+(null==(t=e.m)?"":t)+"px}"},n.Fotorama.jst.video=function(e){function t(){i+=n.call(arguments,"")}var i="",n=(vt.escape,Array.prototype.join);return i+='<div class="fotorama__video"><iframe src="',t(("youtube"==e.type?e.p+"youtube.com/embed/"+e.id+"?autoplay=1":"vimeo"==e.type?e.p+"player.vimeo.com/video/"+e.id+"?autoplay=1&badge=0":e.id)+(e.s&&"custom"!=e.type?"&"+e.s:"")),i+='" frameborder="0" allowfullscreen></iframe></div>\n'},n(function(){n("."+le+':not([data-auto="false"])').fotorama()})}(window,document,location,"undefined"!=typeof jQuery&&jQuery),function(){function e(){this.location="",this.sitesAjax=null,this._used_domains=[],this.siteExpandSpeed=200,this.siteExpandMargins=20,this.tarifMaxSites=0,this.tarifMaxPages=0,this.tarifMaxDomains=0,this.countDomains=0,this.tarifCurSites=0,this.sitePrice=0,this.userSiteCount=0,this.draggingSiteData={},this.hasTariffDaily=!1,this.urlToTariffs="profile/tarifs",this.in_preview=!1,this.max_file_fields=null,this.siteIsEnabled=null,this.is_ready=!1,this.isEditor=i.hasClass("body_pages_edit")}function t(){this.ajaxHandlers={},this.flagIsReady=!1,this.isReady=function(){return this.flagIsReady};var e=this;this.init=function(t){function i(){userHasTag("LPM-575")||$.post(window.baseUrl+"sites/ajax/frm:addOnboardingTag",function(e){e&&(1==e.res||(e.err?alert(e.err):alert("Ошибка при подключении тега онбординга [#4205]")))},"JSON")}e.id=t.form_id,e.el=document.getElementById(e.id),e.$el=$(e.el),e.initial_screen_id=$(".initial-screen").attr("id"),e.current_screen_id=e.initial_screen_id,e.previous_screen_id=e.initial_screen_id,e.$tpl_field=e.$el.find("#"+e.id+"__tpl"),e.$tpl_preview_field=e.$el.find("#tpl-id-in-preview"),e.$empty_tpl_field=e.$el.find("#"+e.id+"__empty_tpl"),e.$phone_field=e.$el.find("#"+e.id+"__phone"),e.$phone_output_error=e.$el.find("#sp6_create_site_output_phone_error"),e.$phone_continue_btn=e.$el.find(".create-phone-next-btn"),e.$name_field=e.$el.find("#"+e.id+"__name"),e.$phone_field.on("change",function(){e.$phone_output_error.empty(),e.validatePhone()}),e.$el.on("submit",function(t){if(!e._is_allow_submit)return t.preventDefault(),!1}),e.$el.find("#generator-content").on("click",".sp6-go-to-step",function(){var t,i=$(this),n=i.attr("data-actions").toString().split(",");for(t=0;t<n.length;t++)switch(n[t]){case"showScreen":if(0==e.showScreen(i.attr("data-screen-id")))return!1}}),e.$el.find(".sp6-go-to-step").on("click",function(){var t,n=$(this),a=n.attr("data-actions").toString().split(",");for(t=0;t<a.length;t++)switch(a[t]){case"ajax":var o=n.attr("data-ajax-handler");e.runAjaxHandler(o);break;case"showPreviousScreen":e.previous_screen_id!=e.current_screen_id&&e.showScreen(e.previous_screen_id);break;case"showScreen":switch(e.current_screen_id){case"sp6_create_site_input_name":tracerSendEvent("creating site: typed name",{first:0==sitesMan.userSiteCount})}var r=n.attr("data-carrot-event");if(r&&r.length>0&&analyticSendEvent(r),!1===e.showScreen(n.attr("data-screen-id")))return!1;break;case"setCategoryFilter":if(0==e.setCategoryFilter(n))return!1;break;case"setTpl":var s=n.attr("data-site");if(0==e.setTpl(s))return!1;tracerSendEvent("chose site template",{"template id":s,first:0==sitesMan.userSiteCount});break;case"setEmptyTpl":"sp6_create_site_generator"!==n.attr("data-screen-id")&&tracerSendEvent("creating site screen",{type:"empty"}),e.$empty_tpl_field.val(0),i(),funnelEvent(3,12);break;case"setNeedTpl":e.$empty_tpl_field.val(1),funnelEvent(2,6);break;case"showCalcScreen":switch(e.initial_screen_id){case"sp6_create_site_init":if(0==e.showScreen(0==e.$empty_tpl_field.val()?"sp6_create_site_init":"sp6_create_site_choose_tpl"))return!1;break;case"sp6_create_site_init_new":if(e.showScreen(0==e.$empty_tpl_field.val()?"sp6_create_site_init_new":"sp6_create_site_choose_tpl_new"))return!1}break;case"back":e.fixBack();break;case"closePreviewTpl":sitesMan.closePreviewTpl();break;case"backAfterCreateOnlyEmptySiteAfterSignUp":1==$.cookie("is_after_signup")&&($.removeCookie("is_after_signup",{path:"/"}),e.previous_screen_id="sp6_create_site_init_HADI1",e.current_screen_id="sp6_create_site_input_phone"),e.previous_screen_id!=e.current_screen_id&&e.showScreen(e.previous_screen_id);break;case"setTplFromPreview":var s=e.$tpl_preview_field.val();if(0==e.setTpl(s))return!1;tracerSendEvent("chose site template",{"template id":s,first:0==sitesMan.userSiteCount}),sitesMan.closePreviewTpl();break;case"clearPhone":e.$phone_field.val("");break;case"submit":switch(e.current_screen_id){case"sp6_create_site_input_name":tracerSendEvent("creating site: typed name",{first:0==sitesMan.userSiteCount});break;case"sp6_create_site_input_phone":tracerSendEvent("creating site: typed phone",{first:0==sitesMan.userSiteCount,typed:$("#frm2__phone").val().trim().length>10?1:0})}if("sp6_create_site_generator"==e.previous_screen_id){if(!e.validatePhone())return!1;GenSiteTpl.redirectToCreateSite()}else e.submit(n);return n=null,!1;case"loadTpls":e.loadVisibleTpls(n);break;case"loadGenerator":var l=$("#generator-content");"0"==l.attr("data-ready")&&$.ajax({url:window.baseUrl+"sites/generator/action:get_html",type:"POST",cache:!1,dataType:"json",timeout:4e4,success:function(e){e.res&&1==e.res&&(l.html(e.html).attr("data-ready","1"),l=null)}})}return n=null,!1}),this.flagIsReady=!0,FE.runAndClr("create_page_form/ready")},this.fixBack=function(){switch(!0){case"block"==$("#sp6_create_site_init").css("display"):sitesMan.goToSites();break;case"block"==$("#sp6_create_site_input_name").css("display"):e.showScreen("sp6_create_site_input_phone");break;case"block"==$("#sp6_create_site_input_phone").css("display"):window.newGetPhoneWindow?window.newGetPhoneWindow.btn.trigger("click"):e.submit($("#sp6_create_site_input_phone .btn-1.sp6-go-to-step"))}},this.setTpl=function(t){return!!t&&(e.$tpl_field.val(t),e.$empty_tpl_field.val(1),!0)},this.validateName=function(){return!0},this.validatePhone=function(){if(userHasTag("LPM-842"))return!0;var t=phoneHelper.formatPhoneToNumeric(e.$phone_field.val());if(0===t.length)return!0;var i=phoneHelper.validatePhone(t);return!(i.length>0)||(e.$phone_output_error.html('<div class="ui_error">'+i+"</div>"),!1)},this.submit=function(t){return!t.hasClass("disabled")&&(!!e.validateName()&&(!!e.validatePhone()&&(t.addClass("disabled"),e.$tpl_preview_field.remove(),e._is_allow_submit=!0,lockScreen("Создание сайта...",{show_animation:!0}),"1"==e.$empty_tpl_field.val()&&(userHasTag("LPDEV-73-b")||userHasTag("LPDEV-73-c"))&&sitesMan.createSiteInHybrid()&&$(e.el).attr("target","converting-iframe"),e.el.submit(),!1)))},this.setCategoryFilter=function(t){var n=t.attr("data-class"),a=n.match(/[\d]*$/),o=sitesMan.$tplsList.children(".not-loaded."+n);e.$el.find(".btn-category.selected").removeClass("selected"),sitesMan.$tplsList.removeClass(),sitesMan.$tplsList.addClass("clearfix show_"+n),t.addClass("selected");for(var r=0;r<7&&o[r];r++)sitesMan.loadSiteTplImage(o[r]);return a.length&&a[0].length&&tracerSendEvent("chose site templates category",{"category id":a[0],first:0==sitesMan.userSiteCount}),i.scrollTop(0),o=null,!0},this.showScreen=function(t){if(!t)return!1;var i=(userHasTag("LPM-706"),!1);switch(t){case"sp6_create_site_init":break;case"sp6_create_site_init_new":break;case"sp6_create_site_input_name":break;case"sp6_create_site_input_phone":userHasTag("LPM-842")&&window.phoneMask&&(i=!0)}return e.$el.find("#"+e.current_screen_id).fadeOut(100,function(){e.$el.find("#"+t).fadeIn(100,function(){switch(e.previous_screen_id=e.current_screen_id,e.current_screen_id=t,t){case"sp6_create_site_generator":tracerSendEvent("creating site screen",{type:"generator"});break;case"sp6_create_site_input_name":e.$name_field.focus();break;case"sp6_create_site_input_phone":if(i){window.phoneMask.init();var n=window.phoneMask.getPhoneCountry();n?window.phoneMask.applyMask(n):window.phoneMask.applyMask("rus")}else e.$phone_field.focus();tracerSendEvent("creating site: phone screen");break;case"sp6_create_site_choose_tpl":sitesMan.initChooseTpl(),tracerSendEvent("creating site screen",{type:"templates"})}})}),!0},this.loadVisibleTpls=function(e){var t=$(".tpls-list-to-load"),i=e.attr("data-cat-id");t.attr("class",t.attr("class").replace(/show_cat_(all|[0-9]+)/g,"").replace(/\s+/g," ")),t.addClass("show_cat_"+i);var n=t.find(".site-preview-template.not-loaded.cat_"+i);n.length>0&&ImgListLoader.create(n,{onload_callback:function(){var e=$(this);e.closest(".site-preview-template").removeClass("not-loaded")}}).run()},this.setAjaxHandler=function(e,t){this.ajaxHandlers[e]=t},this.runAjaxHandler=function(e){if(!this.ajaxHandlers[e])throw new Error("Не существующее имя обработчика [#3557]");this.ajaxHandlers[e]()}}var i=$("body");e.prototype.setUrlToTariffs=function(e){this.urlToTariffs=e.replace(window.baseUrl,"")},e.prototype.ready=function(){consoleDbg("INIT: sites man"),this.$sitesList=$("#sites_list1"),this.$is_tpl_changed=$("#frmnotifymail__is_tpl_changed"),this.initSiteHeaderClick(),this.bindOpengraphEvents(),$("table.file_config").length&&this.initFilesTab(),this.initEditSiteName(),this.initQuiz(null,!0),this.enableQuizNav(),this.initIphone(),this.is_ready=!0,FE.runAndClr("sitesMan/ready")},e.prototype.isReady=function(){return this.is_ready},e.prototype.initFilesTab=function(){$(".file_ops .edit_file").click(sitesMan.startEditFileName),$(".file_name_h_span").dblclick(sitesMan.startEditFileName),$(".file_name_rollback").click(function(){$(this).closest(".file_name").removeClass("edit-mode")}),$(".file_name_save").click(sitesMan.finishEditFileName),$(".file_name_inp").keydown(function(e){13==e.keyCode&&sitesMan.finishEditFileName.call(this)})},e.prototype.startEditFileName=function(){var e=$(this).hasClass("edit_file")?$(this).closest("tr").find(".file_name"):$(this).closest(".file_name");e.addClass("edit-mode"),e.find(".file_name_inp").focus()},e.prototype.finishEditFileName=function(){var e=$(this).closest(".file_name"),t=e.find(".file_name_edit .file_name_inp"),i=$(this).closest("tr.file_row").find(".file_upload_state div");ajaxLoad({url:t.attr("site_id")+"/sites/rename_site_file/id:"+t.attr("file_id"),data:{name:t.val()},success:function(e){"undefined"!=typeof e.res&&0==e.res&&"undefined"==typeof e.mes&&alert("Ошибка! "+mes)}}),e.find(".file_name_h_span").text(t.val()),e.removeClass("edit-mode"),i.removeClass("ok not-pub").addClass("sync"),e=t=null},e.prototype.initSiteHeaderClick=function(){this.$sitesList.children(".one_site").find(".site_expander a").click(function(){var e=$(this).closest(".one_site"),t=e.attr("id").replace("site-",""),i=$.cookie("sites_expanded");isset(i)||(i=""),e.hasClass("collapsed")?(-1==i.indexOf(t)&&(i+=","+t),e.removeClass("collapsed")):(-1!==i.indexOf(t)&&(i=i.replace(t,"")),e.addClass("collapsed")),i=i.replace(/[,]+/g,","),i=i.replace(/^[,]+/,""),setStateCookie("sites_expanded",i),i=e=t=null})},e.prototype.initSiteTabs=function(){this.$sitesList.children(".one_site").find(".one_site_tabs .td_one_site_tab").click(function(){$(this).parent().children(".td_one_site_tab.sel").removeClass("sel"),$(this).addClass("sel"),$(this).closest(".one_site_cont").find(".one_site_tabcont > .one_site_tab").hide().filter("#"+$(this).attr("tab")).show()}),this.$sitesList.find(".one_site").find(".one_site_tabs .td_one_site_tab:first").click()},e.prototype.initSiteLinks=function(){this.$sitesList.find(".site_links a").click(function(){return"undefined"==typeof $(this).data("clicked")&&($(this).animate({paddingLeft:26},100,function(){$(this).addClass("loading")}),$(this).data("clicked",!0),!0)})},e.prototype.collapseAllSites=function(){$(".one_site").addClass("collapsed"),setStateCookie("sites_expanded","")},e.prototype.initStatChart=function(e,t,i){$("#"+e).highcharts({chart:{type:"column",renderTo:"container",showAxes:!0,style:{fontSize:"16"},spacingTop:0,spacingRight:0,spacingBottom:10,spacingLeft:0,height:"250",width:"668"},title:{text:"Посещаемость сайта"},credits:{enabled:!1},xAxis:{categories:t,gridLineWidth:1,gridLineColor:"#EDEDED",tickmarkPlacement:"on",min:0,max:30,labels:{step:2}},scrollbar:{enabled:!0},yAxis:{title:{text:"Посетители",style:{fontFamily:"Verdana",color:"#CCC",fontWeight:"normal"}},labels:{step:1},gridLineColor:"#EDEDED"},series:[{name:"Посетителей",data:i}],tooltip:{headerFormat:'<span style="font-size: 14px">{point.key}</span><br/>',
pointFormat:'<span style="font-size: 14px">{series.name} <b>{point.y}</b></span>',useHTML:!0},plotOptions:{column:{animation:!1}},legend:{enabled:!1},colors:["#C3B0FA"]})},e.prototype.initDatePiker=function(e){"string"==typeof e&&(e=$(e)),e.datepicker({showAnim:"show",prevText:"Предыдущий месяц",nextText:"Следующий месяц",monthNames:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],dayNamesMin:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],dateFormat:"dd.mm.yy",firstDay:1,showButtonPanel:!0,currentText:"Сегодня",closeText:"Закрыть",constrainInput:!0,beforeShow:function(e,t){$(e).attr("disabled","disabled").blur()},onClose:function(e,t){$(this).removeAttr("disabled")}})},e.prototype.sendDeclarationForm=function(e){var t=$(e),i=t.closest("form"),n=i.attr("id"),a={},o={};a.sum=i.find('input[name="'+n+'[sum]"]'),a.d_start=i.find('input[name="'+n+'[date_start]"]'),a.d_end=i.find('input[name="'+n+'[date_end]"]'),a.check=i.find('input[name="'+n+'[avg_check]"]'),a.conv=i.find('input[name="'+n+'[conversion]"]');for(var r in a)if("d_start"==r||"d_end"==r){var s=a[r].val().match(/^(\d{2})\.(\d{2})\.(\d{4})$/);if(!s)return alert("Необходимо ввести правильную дату"),void a[r].focus();o[r]=parseInt(s[3]+s[2]+s[1])}else if(o[r]=a[r].val(),!a[r].val().match(/^\d+$/))return alert("Необходимо ввести правильное число"),void a[r].focus();return o.d_start>o.d_end?void alert("Дата начала должна быть раньше даты окончания"):void $.ajax({url:window.baseUrl+"sites/ajax/frm:frmdeclaration/id:"+n,type:"POST",cache:!1,dataType:"json",data:i.serialize(),timeout:4e4})},e.prototype.changeDeclaration=function(e){var t=$(e).closest(".declaration_view");t.hide(),t.prev(".declaration_edit_form").show()},e.prototype.cancelDeclarationEditting=function(e){var t=$(e).closest(".declaration_edit_form");t.hide(),t.next(".declaration_view").show()},e.prototype.createSiteChooseTpl=function(e){var t=$(e);t.closest("#tpls_list").children(".active").removeClass("active"),t.closest(".one_tpl").addClass("active"),t=null},e.prototype.createInit=function(){$("#frmonesite__empty_tpl input[type=radio]").click(function(){var e=$("#tpls_list"),t=$("#sites_create_blk"),i=$("#td_before_btn"),n=e.find(".one_tpl");t.is(":animated")||(1==parseInt($(this).val())?803>t.width()&&!e.is(":visible")&&(n.hide(),e.show(),t.animate({width:803},600,function(){$("#tpls_list .one_tpl").show()}),i.animate({width:0},600)):e.is(":visible")&&(n.hide(),e.hide(),t.animate({width:700},600),i.animate({width:60},600))),e=t=i=n=null}),helpSlider("#tplslide_helper")},e.prototype.createSiteCheckboxEmptyClick=function(){var e=$("#frmonesite__empty_tpl input[type=radio]:checked"),t=$("#sites_create_blk"),i=$("#td_before_btn");1==e.val()?(e.show(),t.animate({width:803},600),i.animate({width:0},600)):(e.hide(),t.animate({width:700},600),i.animate({width:60},600)),e=t=i=null},e.prototype.initNewList=function(){$("#sitesTutorialVideo").wind("setShowFunc",function(e){var t=e.$el.find(".wind-body"),i=e.$el.find(".pat");return t.html("<iframe "+i.html()+"></iframe>"),t=i=null,!0}).wind("setAfterCloseFunc",function(e){return e.$el.find(".wind-body").html(""),setcookie("sites_tutorial_closed",1,(new Date).getTime()+2592e3,"/"),!0}),sitesMan.initSiteListSortable(),sitesMan.initSitesWithAccess(),sitesMan.initSiteListOld()},e.prototype.initSiteListSortable=function(){$(".tbody_sites").length>0&&$(".tbody_sites").sortable({connectWith:".tbody_sites",handle:".site_lbl",placeholder:"sort_ph",opacity:1,cursor:"move",tolerance:"pointer",dropOnEmpty:!0,start:function(e,t){$(this).sortable("refreshPositions"),t.placeholder.addClass("tr_site fnt2").html('<td colspan="6"><div>ПОМЕСТИТЬ САЙТ ЗДЕСЬ</div></td>'),t.helper.css({width:"auto",height:"auto"}),sitesMan.draggingSiteData[t.item.attr("id-site")]={parent:t.item.parent(),prev:t.item.prev(),item:t.item},sitesMan._used_domains=sitesMan.getUsedDomains(),projectManager.startDragSite()},stop:function(e,t){if(projectManager.stopDragSite(),null!==sitesMan.sitesAjax)return jAlert("Подождите, когда завершится предыдущая команда перемещения."),void sitesMan.moveSiteBack(t.item.attr("id-site"));var i=t.item.closest(".iblk").attr("id");if(sitesMan.tarifMaxPages>0&&"iblk-monthly"==i&&sitesMan.getMonthlyPagesCount()>sitesMan.tarifMaxPages)sitesMan.moveSiteBack(t.item.attr("id-site")),sitesMan.alertTarifIsFull(sitesMan.tarifMaxPages);else if(sitesMan.tarifMaxDomains>0&&t.item.attr("data-root_domain")&&-1==$.inArray(t.item.attr("data-root_domain"),sitesMan._used_domains)&&"iblk-monthly"==i&&sitesMan.getActiveDomainsCount()>sitesMan.tarifMaxDomains)sitesMan.moveSiteBack(t.item.attr("id-site")),sitesMan.alertDomainsLimitIsFull(sitesMan.tarifMaxDomains);else if("iblk-daily"==i){var n=parseInt(t.item.attr("last-pay"));isNaN(n)||n<sitesMan.curCronDate?sitesMan.alertDailySiteNeedPayment(function(){sitesMan.updateSiteSwitch(t.item,i),sitesMan.recountSitesPos()},function(){sitesMan.moveSiteBack(t.item.attr("id-site"))}):(sitesMan.updateSiteSwitch(t.item,i),sitesMan.recountSitesPos())}else sitesMan.updateSiteSwitch(t.item,i),sitesMan.recountSitesPos();i=null},over:function(e,t){sitesMan.showHideEmptyBlocks(),sitesMan.recountDailyExpense()}})},e.prototype.initSitesWithAccess=function(){var e=$(".tbody_sites_draggable");e.length&&e.sortable({connectWith:".user-projects__droppable",handle:".site_lbl",placeholder:"sort_ph",opacity:1,cursor:"move",tolerance:"pointer",dropOnEmpty:!0,start:function(e,t){t.placeholder.addClass("tr_site fnt2").html('<td colspan="5"><div>ПОМЕСТИТЬ САЙТ ЗДЕСЬ</div></td>'),t.helper.css({width:"auto",height:"auto"}),projectManager.startDragSite()},stop:function(e,t){projectManager.stopDragSite()},over:function(e,t){sitesMan.showHideEmptyBlocks()}}),"undefined"!=typeof access&&(access.onAddAccess=function(){var e=access.accessData.site_id,t=$(".access-site[site_id="+e+"]");if(t.hasClass("hidden"))t.removeClass("hidden").prev().addClass("hidden"),t.children(".count-access").html("1");else{var i=parseInt(t.children(".count-access").html());t.children(".count-access").html(i+1)}},access.onRemoveAccess=function(e){var t=$(".access-site[site_id="+e+"]");if(t.hasClass("hidden"));else{var i=parseInt(t.children(".count-access").text().trim());isNaN(i)||i-1<=0?(t.addClass("hidden").prev().removeClass("hidden"),t.children(".count-access").text(" ")):t.children(".count-access").text(i-1)}}),$(document).on("click",".info-new-access",function(e){e.preventDefault(),e.stopPropagation();var t=$(this),i=t.children(".popup_info"),n=function(e){$(".popup_info").hide(),$(document).unbind("click",n)};"block"==i.css("display")?$(document).unbind("click",n):($(".popup_info").hide(),i.show(),$(document).bind("click",n))}),$(document).on("click",".add-new-access",function(){access.data.site_id=$(this).attr("site_id"),access.addEmailAccess()}),$(document).on("click",".access-site",function(){access.data.site_id=$(this).attr("site_id"),$.get(window.baseUrl+"access/ajax/frm:getsiteaccess/id:"+access.data.site_id,function(e){var t=$("#myModal"),i=t.find(".access-user-item.hidden"),n=$(".tr_site[id-site="+access.data.site_id+"] .site_name_h span");if(t.find(".access-site-name").text(n.text()),t.find(".access-user-item:not(.hidden, .add)").remove(),t.modal(),e.hasOwnProperty("accesses"))for(var a=0,o=e.accesses.length;a<o;a++){var r=i.clone().removeClass("hidden"),s=e.accesses[a].email;i.before(r),r.children(".access-user-item__email").html(s)}})}),$(document).on("click",".access-user-item:not(.add)",function(){var e=$(this).children(".access-user-item__email").html();$("#myModal").modal("hide"),access.accessData={email:e,site_id:access.data.site_id},access.openModal()})},e.prototype.initSiteListOld=function(){$(document).on("click",".vl-item",function(e){var t=0;$("input.vl-item").each(function(){$(this).prop("checked")&&t++}),t>1?$("#vl-btn-start").removeClass("disabled"):$("#vl-btn-start").addClass("disabled")}),$("#vl-btn-start").unbind("click").bind("click",function(){var e=[];$("input.vl-item").each(function(){$(this).prop("checked")&&e.push($(this).attr("id-site"))}),e.length>1&&(lockScreen(),$.ajax({url:window.baseUrl+window.siteId+"/sites/abtest",method:"post",data:{list:e,do:"set_list"},success:function(e){if(1==e){unlockScreen(),$("#Start_test").modal("hide");var t=$("#ABTestIsStarted");t.off("hidden.bs.modal").on("hidden.bs.modal",function(){lockScreen("Перезагружаем раздел",{show_animation:!0}),location.reload()}),t.modal("show")}else console.log(e)}}))}),$("#vl-btn-stop").unbind("click").bind("click",function(){lockScreen(),$.ajax({url:window.baseUrl+window.siteId+"/sites/abtest",method:"post",data:{do:"stop"},success:function(e){1==e?location.reload():console.log(e)}})}),$(".disable-variant").unbind("click").bind("click",function(){lockScreen(),$.ajax({url:window.baseUrl+window.siteId+"/sites/abtest",method:"post",data:{variant_id:$(this).closest(".abtest_item").attr("variant-id"),do:"disable_variant"},success:function(e){1==e?location.reload():console.log(e)}})}),$(".enable-variant").unbind("click").bind("click",function(){lockScreen(),$.ajax({url:window.baseUrl+window.siteId+"/sites/abtest",method:"post",data:{variant_id:$(this).closest(".abtest_item").attr("variant-id"),do:"enable_variant"},success:function(e){1==e?location.reload():console.log(e)}})}),$(".delete-variant").unbind("click").bind("click",function(){$("#vl-btn-delete").attr("variant-id",$(this).closest(".abtest_item").attr("variant-id")),$("#delete_variant").modal("show")}),$("#vl-btn-delete").unbind("click").bind("click",function(){lockScreen();var e=$(this).attr("variant-id");return $.ajax({url:window.baseUrl+window.siteId+"/sites/abtest",method:"post",data:{variant_id:e,do:"delete_variant"},success:function(t){1==t?sitesMan.afterVariantDelete(e):console.log(t)}}),!1}),$(".set-base-variant").unbind("click").bind("click",function(){lockScreen(),$.ajax({url:window.baseUrl+window.siteId+"/sites/abtest",method:"post",data:{variant_id:$(this).closest(".abtest_item").attr("variant-id"),do:"set_base_variant"},success:function(e){1==e?location.reload():console.log(e)}})}),this.curCronDate=null,this.dailyExpenseBlock=$("#daily_expense"),this.dailySitesList=$("#iblk-daily .tbody_sites:first"),this.monthlySitesList=$("#iblk-monthly .tbody_sites:first")},e.prototype.createEmptyVariant=function(e){return lockScreen("Создаем пустой вариант",{show_animation:!0,show_btn_close:!1}),window.location.href=window.baseUrl+siteId+"/sites/create_empty_variant/variant_for:"+e,!1},e.prototype.cloneVariant=function(e){return lockScreen("Копируем вариант",{show_animation:!0,show_btn_close:!1}),window.location.href=window.baseUrl+e+"/sites/clone_site/variant_for:"+siteId+"/redirect_to:tab_abtest",!1},e.prototype.cloneSiteFromVariant=function(e){return lockScreen("Копируем сайт",{show_animation:!0,show_btn_close:!1}),window.location.href=window.baseUrl+e+"/sites/clone_site/variant_for:"+siteId+"/redirect_to:tab_abtest/set_variant_for:"+siteId,!1},e.prototype.initEditSiteName=function(){$(document).on("click",".tr_site .site_name .site_name_h div.edit_name, .abtest_item .abtest_name .site_name_h div.edit_name",function(e){e.preventDefault(),e.stopPropagation();var t=$(this).closest(".site_name"),i=t.find(".site_name_edit .site_name_inp");window.siteList||i.val($(this).closest(".site_name_h").children("span").text().trim()),t.addClass("edit-mode"),i.focus(),t=i=null}),$(document).on("click",".tr_site .site_name .site_name_save",function(e){var t=$(this).closest(".site_name"),i=t.find(".site_name_edit .site_name_inp"),n=i.val().trim();i.val(n),n.length<=200&&n.length>0?(ajaxLoad({url:i.attr("site_id")+"/sites/ajax/frm:frmsitename",data:{frmsitename:{name:n},from_list:1}}),window.siteList||t.find(".site_name_h span").text(n),t.removeClass("edit-mode")):alert("Рабочее имя сайта не должно превышать 200 символов и обязательно к заполнению")}),$(document).on("click",".abtest_item .abtest_name .site_name_save",function(e){var t=$(this).closest(".site_name"),i=t.find(".site_name_edit .site_name_inp"),n=$(this).closest(".abtest_item").attr("variant-id"),a=i.val().trim();i.val(a),a.length<=200&&a.length>0?(ajaxLoad({url:i.attr("site_id")+"/sites/ajax/frm:frmvariantname",data:{frmvariantname:{name:a,variant_id:n},from_list:1}}),t.find(".site_name_h span").text(a),t.removeClass("edit-mode")):alert("Рабочее имя сайта не должно превышать 200 символов и обязательно к заполнению")}),$(document).on("click",".tr_site .site_name .site_name_rollback, .abtest_item .abtest_name .site_name_rollback",function(e){$(this).closest(".site_name").removeClass("edit-mode")})},e.prototype.alertDailySiteNeedPayment=function(e,t){jAlert('<div class="title_for_message">Этот сайт еще не публиковался сегодня</div><div class="text_for_message">За него сразу будет списана оплата за 1 день</div>',{width:600,btnCls:"btn-success",btnWidth:160,okText:"Продолжить",onOk:e||function(){},onCancel:t||function(){}})},e.prototype.alertOnlySiteOwner=function(e){var t="Это действие может совершить только владелец сайта!";switch(e){case"on_site_publish":t="Опубликовать сайт может только владелец!";break;case"off_site_publish":t="Отключить сайт может только владелец!"}jAlert('<div class="title_for_message">'+t+"</div>",{width:600,btnCls:"btn-success",btnWidth:160,okText:"Хорошо",onOk:function(){},onCancel:function(){}})},e.prototype.alertDomainsLimitIsFull=function(e){var t='<div class="img_for_message img_off"></div><div class="title_for_message">На текущем тарифе можно запустить <br/><strong>максимум '+e+" домен"+plural(e,"","а","ов")+'</strong></div><hr class="mv3"/><div class="text_for_message">Запустите сайт на поддомене или<br/>прикрепите к другому сайту как страницу.</br/>Также вы можете перейти на более "мощный" тариф.</div>';jAlert(t,{width:500,btnWidth:200,btnCls:"btn btn-success",okText:"Перейти к тарифам",headerText:"",onOk:function(){return mxt("btn balance",{"источник":mxGetSourceLink()}),setTimeout("goTo('"+sitesMan.urlToTariffs+"');",200),!1}})},e.prototype.alertTarifIsFull=function(e){var t='<div class="img_for_message img_off"></div><div class="title_for_message">На текущем тарифе можно запустить<br/><strong>максимум '+e+" сайт"+plural(e,"","а","ов")+'</strong></div><hr class="mv3"/><div class="text_for_message">Выключите один из сайтов или</br>перейдите на более высокий тариф.</div>';jAlert(t,{width:500,btnWidth:200,btnCls:"btn btn-success",okText:"Перейти к тарифам",headerText:"",alertClass:"alert-max-sites-constraint",onOk:function(){return mxt("btn balance",{"источник":mxGetSourceLink()}),setTimeout("goTo('"+sitesMan.urlToTariffs+"');",200),!1}})},e.prototype.alertTarifIsFullInTest=function(e){jAlert('<div class="img_for_message img_off"></div><p class="title_for_message">На текущем тарифе вы можете запустить<br/><strong> максимум '+e+" сайт"+plural(e,"","а","ов")+'</strong></p><hr/><div class="text_for_message"><a href="'+baseUrl+'sites/list">Выключите</a> один из сайтов </br> или </br>Перейдите на более "мощный" тариф  в разделе Баланс.</div>',{width:700,btnWidth:200,btnCls:"btn btn-success",okText:"Перейти в Баланс",headerText:"",onOk:function(){return mxt("btn balance",{"источник":mxGetSourceLink()}),setTimeout("goTo('profile/balance');",200),!1}})},e.prototype.moveSiteBack=function(e,t){if(this.draggingSiteData[e]&&(this.draggingSiteData[e].prev.length?this.draggingSiteData[e].item.insertAfter(this.draggingSiteData[e].prev):this.draggingSiteData[e].item.prependTo(this.draggingSiteData[e].parent),this.draggingSiteData[e].item.attr("cur-grp",this.draggingSiteData[e].item.closest(".iblk").attr("id"))),this.showHideEmptyBlocks(),this.recountDailyExpense(),"undefined"!=typeof t){for(var i in t)$(".tr_site[id-site="+i+"]").attr("pos",t[i]);i=null}},e.prototype.getMonthlySitesCount=function(){return isset(window.siteList)?siteList.getSitesList(window.SITES_LIST_PUBLISHED_BY_MONTHLY_TARIFF).length:this.monthlySitesList.children("tr.tr_site:not(.ui-sortable-helper):not(.sort_ph)").length},e.prototype.getMonthlyPagesCount=function(){return isset(window.siteList)?siteList.getSitesList(window.SITES_LIST_PUBLISHED_BY_MONTHLY_TARIFF).length:this.monthlySitesList.children("tr.tr_site:not(.ui-sortable-helper):not(.sort_ph)").length},e.prototype.getUsedDomains=function(){if(isset(window.siteList))return siteList.getUsedDomains();var e=[];return this.monthlySitesList.children("tr[data-root_domain]:not(.ui-sortable-helper):not(.sort_ph)").each(function(){var t=$(this).attr("data-root_domain");-1==$.inArray(t,e)&&e.push(t)}),e},e.prototype.getActiveDomainsCount=function(){return this.getUsedDomains().length},e.prototype.showHideEmptyBlocks=function(){var e=$(".tbody_sites .tr_empty, .tbody_sites_draggable .tr_empty");e.each(function(){var e=$(this);if("projects"==projectManager.getProjectsViewState()){var t=projectManager.currentProject.id,i=e.parent(),n=i.find(".tr_site[data-project-id="+t+"]:not(.ui-sortable-helper)"),a=i.find(".sort_ph:not(.hidden)");n.length||a.length?e.hide():e.show()}else e.parent().children("tr.tr_site:not(.ui-sortable-helper)").length>0?e.hide():e.show();e=null})},e.prototype.recountDailyExpense=function(){this.dailyExpenseBlock.length&&this.dailyExpenseBlock.text(this.dailySitesList.find(".tr_site:not(.ui-sortable-helper)").length*this.sitePrice)},e.prototype.recountSitesPos=function(){var e=null,t={},i=0,n=null,a=null,o=null,r=null;$("#sites_list").children(".iblk").each(function(){a=$(this).attr("id"),$(this).find(".tbody_sites .tr_site").each(function(r){++r,e=parseInt($(this).attr("pos")),o=$(this).attr("cur-grp"),(isNaN(e)||e!=r||a!=o)&&(n=parseInt($(this).attr("id-site")),isNaN(n)||(i++,t[n]={pos:r,oldPos:isNaN(e)?"":e,newParent:a},$(this).attr({pos:r,"cur-grp":a})))})}),i>0&&this.saveSitesPositions(t),e=t=i=n=a=o=r=null},e.prototype.saveSitesPositions=function(e,t){var i=window.location.href.match(/user:(\d+)/);this.sitesAjax=ajaxLoad({url:"sites/ajax/frm:frmsitespos"+(null!==i?"/user:"+i[1]:""),data:{list:e,from:this.location},onBeforeSuccess:function(e){return"undefined"!=typeof e.err?(e.error=e.err,e.res=0):0!=e.res||e.script||(e.error="Возникла ошибка [#4777]!"),!0},onSuccess:function(e,i){1==e.res&&e.siteUrl&&e.siteUrlDecoded&&(trialTariff.showModal(e),isset(window.siteList)&&e.trialDays>0&&isset(e.tariff)&&siteList.$emit("sites-list--tariff-attached",e.tariff)),t&&"function"==typeof t&&t(e)}})},e.prototype.showNotEnoughMoneyForDailySite=function(e){jConfirm("<p>На вашем балансе недостаточно средств.</p><p>Для запуска сайта за <strong>"+e.substr(4,2)+"."+e.substr(2,2)+".20"+e.substr(0,2)+"</strong> нужно, чтобы на балансе было минимум <strong>"+number_format(this.sitePrice,0)+" руб</strong>.</p><p>Пополните баланс и повторите операцию.</p>",{okText:"Пополнить",btnWidth:110,onOk:function(){mxt("btn balance",{"источник":mxGetSourceLink()}),setTimeout("goTo('profile/balance');",200)}})},e.prototype.errTplPublish=function(){jAlert("<p>Данный сайт является шаблоном, его нельзя опубликовать.</p><p>Вы можете нажать на шестеренку, выбрать пункт &laquo;Клонировать&raquo; и уже клонированный сайт сможете опубликовать.</p>")},e.prototype.errNeedTariffAttach=function(){jAlert('<div class="img_for_message img_off mb2"></div><div class="title_for_message">Для запуска сайта вам нужно перейти в раздел &laquo;Баланс&raquo; и подключить тариф.</div>',{width:600,btnWidth:200,btnCls:"btn-success btn-alert-need-tarif",okText:"Перейти в Баланс",headerText:"Запуск сайта",alertClass:"alert-need-tarif",onOk:function(){mxt("btn balance",{"источник":mxGetSourceLink()}),setTimeout("goTo('"+sitesMan.urlToTariffs+"');",200)}})},e.prototype.onFaviconUpload=function(e,t){if(console.log(e.target.files[0]),!e.target.files[0].type.match(/^image\/(png|ico|x-icon|icon|vnd.microsoft.icon)/))return alert("Нужно выбрать картинку с расширением ICO или PNG."),!1;if(e.target.files[0].size>12e4)return void alert("Максимальный размер файла - 120 Кб.");0==$("#upload_target").length&&$("body").append('<iframe id="upload_target" name="upload_target" style="width:1px;height:1px;border:0;position:absolute;left:-9999px;visibility:hidden;"></iframe>');var i=$(t).closest("form");i.submit(),i=null},e.prototype.faviconUploadOk=function(e){$("img#favicon_img").attr("src",e.url),$(".favicon_edit").removeClass("empty")},e.prototype.goToSites=function(){location.href=window.baseUrl+"sites/list"},e.prototype.onSiteDelete=function(e,t,i){var n="Удалить этот "+("variant"==i?"вариант":"сайт")+"?";jConfirm(n,{site:e,width:330,okClass:"ibtn-red",okText:"Да, удалить",btnWidth:114,onOk:function(){var i=lockScreen("Удаление...",{show_animation:!0});ajaxLoad({url:"sites/ajax/frm:delete_site/id:"+e,onSuccess:function(e){i&&unlockScreen(i),"function"==typeof t&&t(e)}})}})},e.prototype.afterSiteDelete=function(e){if(showDoneBox("Сайт удален",{width:200,cls:"c_text",showTime:1e3}),!isset(window.siteList)){var t=$("#sites_list .tr_site[id-site="+e+"]");t.animate({opacity:0},1e3,function(){var e=t.siblings(".tr_site"),i=t.siblings(".tr_empty");$(this).remove(),e.length<1&&i.show(),t=null,e=null,i=null})}},e.prototype.afterVariantDelete=function(e){location.reload()},e.prototype.siteTransfer=function(e,t,i){$("#transver_site_name h5").text(i),$("#transver_site_name a").attr("href","http://"+t).text(t),$("#frmtransfer__site").val(e),$("#wndTransfer .ui_error").hide(),$("#wndTransfer").wind("show"),$("#frmtransfer__mail").val("").focus()},e.prototype.confirmSiteTransfer=function(){jConfirm("Переносим сайт?",{width:330,btnWidth:109,okClass:"ibtn-red",okText:"Да, переносим",onOk:function(){ajaxLoad({url:"sites/ajax/frm:frmtransfer/ok:1"+(location.href.indexOf("/sites/view")>=0?"/goto:sites":""),data:$("#frmtransfer").serializeArray()})}})},e.prototype.siteTransferDone=function(e,t,i,n){isset(window.siteList)?siteList.$emit("sites-list-item--transferred",e,i):($("#sites_list .tr_site[id-site="+e+"]").remove(),alert('Сайт "'+t+'" успешно перенесен пользователю '+i+"!")),$(".wind#wndTransfer").wind("hide"),"function"==typeof n&&n()},e.prototype.updateSiteSwitch=function(e,t){e.find(".site_publish .switch")["iblk-disabled"==t?"removeClass":"addClass"]("on")["iblk-disabled"==t?"addClass":"removeClass"]("off"),e.stop().css("background-color","#FFF7C2").animate({backgroundColor:"#fff"},5e3)},e.prototype.setPublished=function(e,t){var i=$(t),n=window.location.href.match(/user:(\d+)/),a=i.attr("data-entry-point");i.hasClass("on")?jConfirm("Вы уверены, что хотите выключить сайт?",{width:330,btnWidth:109,okClass:"ibtn-red",okText:"Да, выключить",onOk:function(){isset(window.siteList)&&siteList.$emit("sites-list-item--before-move-in-other-list",e,window.SITES_LIST_DRAFTS),ajaxLoad({url:"sites/ajax/frm:frmpublish2"+(null!==n?"/user:"+n[1]:""),data:{id:e,action:"off"},onBeforeSuccess:function(e){return"undefined"!=typeof e.err?(e.error=e.err,e.res=0):0==e.res&&(e.error="Возникла ошибка [#4778]!"),!0},onSuccess:function(e){if(1==e.res)switch(e.mes){case"ok_site_off":if(showDoneBox("Сайт выключен",{width:200,cls:"c_text",showTime:1e3}),isset(window.siteList))return void siteList.$emit("sites-list-item--successful-move-in-other-list",e.id,e.pos);var t=$(".tr_site[id-site="+e.id+"]");t.attr("cur-grp","iblk-disabled"),t.appendTo($("#iblk-disabled .tbody_sites")),sitesMan.updateSiteSwitch(t,t.closest(".iblk").attr("id")),t.attr("pos",e.pos),sitesMan.showHideEmptyBlocks(),sitesMan.recountDailyExpense(),t=null}isset(window.siteList)&&siteList.$emit("sites-list-item--failure-move-in-other-list")}})}}):sitesMan.hasTariffDaily?jConfirm("Выберите месячный или дневной тариф для запуска сайта",{width:400,btnWidth:155,okText:"Тариф по месяцам",cancelText:"По дням",headerText:"Запуск сайта",onOk:function(){sitesMan.setPublishedOn(e,{entry_point:a,run_type:"monthly"})},onCancel:function(){sitesMan.setPublishedOn(e,{entry_point:a,run_type:"daily"})},onClose:function(){return!0}}):this.setPublishedOn(e,{entry_point:a,run_type:"monthly"}),n=i=null},e.prototype.setPublishedInTest=function(e){window.location.href.match(/user:(\d+)/);sitesMan.hasTariffDaily?jConfirm("Выберите месячный или дневной тариф для запуска сайта",{width:400,btnWidth:155,okText:"Тариф по месяцам",cancelText:"По дням",headerText:"Запуск сайта",onOk:function(){sitesMan.setPublishedOnInTest(e)},onCancel:function(){sitesMan.setPublishedOnInTest(e,"daily")},onClose:function(){return!0}}):this.setPublishedOnInTest(e)},e.prototype.setPublishedOn=function(e,t){t||(t={}),t.run_type||(t.run_type="monthly"),"undefined"==typeof t.forced&&(t.forced=0);var i=window.location.href.match(/user:(\d+)/);isset(window.siteList)&&siteList.$emit("sites-list-item--before-move-in-other-list",e,t.run_type),ajaxLoad({url:"sites/ajax/frm:frmpublish2"+(null!==i?"/user:"+i[1]:""),data:{id:e,action:"on",type:t.run_type,force:t.forced},withCredentials:!0,onSuccess:function(i){if(1==i.res)switch(i.mes){case"ok_site_on":if(i.siteUrl&&i.siteUrlDecoded){var n="undefined"!=typeof window.MODULE_ACTION&&"sites/list"==window.MODULE_ACTION&&0==$("#iblk-"+i.type+" .tbody_sites").length;if(isset(window.siteList)&&(n=!1,i.trialDays>0&&isset(i.tariff)&&siteList.$emit("sites-list--tariff-attached",i.tariff)),trialTariff.showModal(i,n),n)return}switch(t.entry_point){case"editor":$(".btn[data-entry-point=editor]").remove();break;case"preview":i.siteUrl&&i.siteUrlDecoded&&($(".site__status--unpublished").remove(),$(".site__published-link").attr("href",i.siteUrl).text(i.siteUrlDecoded),$(".site__status--published").removeClass("hidden"));break;default:if(showDoneBox("Сайт запущен"+("undefined"!=typeof i.is_paid&&1==i.is_paid?" и оплачен":"")+"!",{width:200,cls:"c_text",showTime:1e3}),isset(window.siteList))return void siteList.$emit("sites-list-item--successful-move-in-other-list",i.id,i.pos);var a=$(".tr_site[id-site="+i.id+"]");a.length&&(a.attr("cur-grp","iblk-"+t.run_type),a.appendTo($("#iblk-"+i.type+" .tbody_sites")),"daily"==i.type&&sitesMan.recountDailyExpense(),sitesMan.updateSiteSwitch(a,a.closest(".iblk").attr("id")),a.attr("pos",i.pos),sitesMan.showHideEmptyBlocks()),a=null,sitesMan.in_preview&&(window.location.href=window.location.href)}break;case"tarif_is_full":sitesMan.alertTarifIsFull(i.max_sites);break;case"domains_limit_is_full":sitesMan.alertDomainsLimitIsFull(i.max_domains);break;case"only_site_owner":sitesMan.alertOnlySiteOwner(i.action);break;case"need_tarif_activate":sitesMan.errNeedTariffAttach();break;case"daily_tarif_is_off":jConfirm('<p>Чтобы запустить сайт <strong>по дням</strong>, вам нужно активировать режим для PRO.</p><p>Для этого перейдите в раздел Баланс и в блоке с названием "ДЛЯ PRO" нажмите кнопку "Подключить".</p>',{width:450,btnWidth:120,okClass:"ibtn-green",okText:"Перейти в Баланс",onOk:function(){mxt("btn balance",{"источник":mxGetSourceLink()}),setTimeout("goTo('profile/balance');",200)}});break;case"daily_site_need_payment":if(sitesMan.alertDailySiteNeedPayment(function(){t.forced=1,sitesMan.setPublishedOn(e,t)},function(){isset(window.siteList)&&siteList.$emit("sites-list-item--failure-move-in-other-list")}),isset(window.siteList))return;break;case"need_balance":sitesMan.showNotEnoughMoneyForDailySite(i.curCronDate)}isset(window.siteList)&&siteList.$emit("sites-list-item--failure-move-in-other-list")}}),i=null},e.prototype.setPublishedOnInTest=function(e,t,i){var n=window.location.href.match(/user:(\d+)/);ajaxLoad({url:"sites/ajax/frm:frmpublish2"+(null!==n?"/user:"+n[1]:""),data:{id:e,action:"on",type:t||"monthly",force:i||0},withCredentials:!0,onSuccess:function(i){if(1==i.res){switch(i.mes){case"ok_site_on":$("#btn-start-test").attr("href","#Start_test"),i.siteUrl&&i.siteUrlDecoded,showDoneBox("Сайт запущен"+("undefined"!=typeof i.is_paid&&1==i.is_paid?" и оплачен":"")+"!",{width:200,cls:"c_text",showTime:1e3});break;case"tarif_is_full":sitesMan.alertTarifIsFullInTest(i.max_sites);break;case"domains_limit_is_full":sitesMan.alertDomainsLimitIsFull(i.max_domains);break;case"only_site_owner":sitesMan.alertOnlySiteOwner(i.action);break;case"need_tarif_activate":sitesMan.errNeedTariffAttach();break;case"daily_tarif_is_off":jAlert('<div class="img_for_message img_pro"></div><div class="title_for_message">Чтобы запустить сайт <strong>по дням</strong>, вам нужно активировать режим для PRO</div><div class="text_for_message">Для этого перейдите в раздел Баланс и в блоке с названием "ДЛЯ PRO" нажмите кнопку "Подключить"</div>',{width:600,btnWidth:160,btnCls:"btn-success",okText:"Перейти в Баланс",onOk:function(){mxt("btn balance",{"источник":mxGetSourceLink()}),setTimeout("goTo('profile/balance');",200)}});break;case"daily_site_need_payment":sitesMan.alertDailySiteNeedPayment(function(){sitesMan.setPublishedOn(e,{forced:1,run_type:t})});break;case"need_balance":sitesMan.showNotEnoughMoneyForDailySite(i.curCronDate)}$("#Start_test3").find("button.close:first").click()}}}),n=null},e.prototype.createSiteInHybrid=function(){if(!userHasTag("LPDEV-73-b")&&!userHasTag("LPDEV-73-c"))return!1;var e=$('<iframe name="converting-iframe" class="converting-iframe"/>'),t=!1;return $("body").append(e),e.load(function(){var e=this,i="startup-mist--visible";return!t&&(t=!0,void FE.runOnReady(function(){var t=e.contentWindow,n=t.$,a=n("."+i);a.length&&a.removeClass(i),t.hybridConverter.convertSiteToAbsolute(function(e){e.redirect_to?window.location.href=e.redirect_to:window.location.href="/"})}))}),!0},e.prototype.loadSiteTplImage=function(e){var t=$(e),i=t.find(".tpl-img");i.attr("src",i.attr("data-src")),i.removeAttr("data-src"),t.removeClass("not-loaded"),i=t=null},e.prototype.onSuccessSubmitFrmNeedSiteTpl=function(){$("#frmneedsitetpl__iwant").val("").closest(".modal").modal("hide"),alert("Спасибо!\n\nВозможно, именно ваша тематика попадет в следующее обновление!")},e.prototype.initChooseTpl=function(){},e.prototype.initCreatePage=function(e){this.initChooseTpl(),userHasTag("LPM-842")&&(setTimeout(function(){$("#onboard-m1").addClass("appear")},100),setTimeout(function(){$("#onboard-m2").addClass("appear")},2e3),setTimeout(function(){$("#onboard-m2-btn").addClass("appear")},2e3)),this.$tplsList=$("#tpls-list"),e=e||{},this.create_page_form=new t,this.create_page_form.init(e),$(document).on("mousedown",".btn-tpl-choose",function(){sitesMan.create_page_form.$tpl_field.val($(this).attr("data-site"))}).on("click","img.tpl-img, .btn-tpl-preview",this.previewTpl);var i,n=7,a=this.$tplsList.find(".tpl-container.not-loaded");for(i=0;i<n&&a[i];i++)this.loadSiteTplImage(a[i]);a=null,$(window).on("scroll.tpl-load",function(){if("block"==$("#sp6_create_site_choose_tpl").css("display")){var e=sitesMan.$tplsList.find(".tpl-container.not-loaded");if(e.length){var t,i=$(window),n=i.scrollTop(),a=i.height();for(var o in e){if(!(e[o].offsetTop-(n+a)<20))break;sitesMan.loadSiteTplImage(e[o])}i=n=a=o=t=null}else $(window).off("scroll.tpl-load")}}),$(window).scroll(),userHasTag("test-new-reg-screen-templates")&&$(".after-reg-popup__wrap").length&&($(document).on("click",".after-reg-popup__wrap",function(){return sitesMan.closeAfterRegPopup(),!1}),$(document).on("click",".after-reg-popup",function(){return!1}),$(document).on("click",".after-reg-popup__btn",function(){return sitesMan.closeAfterRegPopup(),!1}));var o=$(".initial-screen");if(o.length){var r=o.attr("id");if(r)switch(r){case"sp6_create_site_choose_tpl":tracerSendEvent("creating site screen",{type:"templates"});break;case"sp6_create_site_init_HADI1":tracerSendEvent("creating site screen",{type:"three options"})}}},e.prototype.closeAfterRegPopup=function(){tracerSendEvent("new site: reg popup closed"),userAddTag("new-reg-screen-watched"),$(".after-reg-popup__wrap").remove()},e.prototype.setPageState=function(e,t){if($(".site_choose_btn[data-screen-id="+e+"]:first").click(),t){var i=$(".tpl-category__btn[data-class=cat_"+t+"]:first");i.length>0&&i.click()}},e.prototype.previewTpl=function(){var e=$(this).closest(".tpl-container"),t=parseInt(e.attr("id").replace("tpl-",""));$("body").addClass("no_overflow");var i=$("#tpl-preview-wrap"),n=i.find("#tpl-preview-iframe-wrap");i.addClass("visible"),n.children("iframe:visible").hide();
var a=n.children("iframe[data-site="+t+"]");a.length?a.show():($("#tpl-loader").show(),$('<iframe src="'+window.baseUrl+t+'/pages/preview_tpl" data-site="'+t+'" onload="$(\'#tpl-loader\').hide()"></iframe>').appendTo(n)),$("#frm3__name").val($("#frm2__name").val()),$("#tpl-id-in-preview").val(t),$(this).hasClass("btn-tpl-preview")&&$(this).addClass("disabled"),tracerSendEvent("opened site template preview",{"template id":t,first:0==sitesMan.userSiteCount})},e.prototype.closePreviewTpl=function(){$("body").removeClass("no_overflow"),$("#tpl-preview-wrap").removeClass("visible")},e.prototype.chooseTpl=function(){var e=$(this).closest(".tpl-container");parseInt(e.attr("id").replace("tpl-",""))},e.prototype.afterGenTelegramCode=function(e){$("#telegram_code_span").text(e),$("#telegram_code").show(),$("#telegram_ready").hide()},e.prototype.afterGenVkCode=function(e){$("#vk_code_span").text(e),$("#vk_code").show(),$("#vk_ready").hide()},e.prototype.afterVkTurnOff=function(e){},e.prototype.uploadOpengraphImg=function(e,t){return e.target.files[0]?e.target.files[0].type.match(/^image\//)?0==e.target.files[0].size?(alert("Ошибка. Файл картинки пустой"),t.reset(),!1):e.target.files[0].size>1048576?(alert("Файл слишком большой. Максимальный размер = 1 Мегабайт."),t.reset(),!1):(lockScreen("Загружаем картинку",{show_animation:!0,delay_before:1e3}),void t.submit()):(alert("Нужно выбрать файл изображения."),t.reset(),!1):(alert("Форма не может быть отправлена пустой"),t.reset(),!1)},e.prototype.opengraphUploadOk=function(e){if(isset(e.ops)){var t=$(".og_preview_image");return t.length?void t.find("#og_image").attr({src:e.url,"data-orig-w":e.extra.w,"data-orig-h":e.extra.h}):(t=null,void consoleDbg("Картинка загружена, но не найден ее блок"))}},e.prototype.saveOpengraphData=function(){var e=$("#og_header").val(),t=$("#og_description").val(),i=$("#save_opengraph"),n=$(".descr_wrapper");$.ajax({url:window.baseUrl+window.siteId+"/sites/ajax/frm:saveopengraph",method:"POST",dataType:"json",data:{title:e,description:t},success:function(e){return e.res&&1==e.res?(i.text("Сохранено"),void n.text(t)):void alert(e.error)}})},e.prototype.initSocialLocker=function(){var e=$(".to-lock");if(e.sociallocker){var t=$(".to-lock").sociallocker({demo:!0,text:{header:'Нажмите "поделиться", чтобы активировать<br/>реферальные хвосты.',message:""},theme:"flat",buttons:{order:["vk-share"],counter:!0},vk:{appId:"5203064",like:{pageUrl:"http://lpmotor.ru",requireSharing:!0,title:"Нравится"},share:{pageUrl:"http://lpmotor.ru",pageTitle:"LPmotor – Конструктор сайтов и лендингов",pageDescription:"Сейчас создаю себе сайт на конструкторе http://LPmotor.ru! Кто хочет посмотреть на результат? ))",pageImage:"http://lpmotor.s3.amazonaws.com/6/9/a/69aed0d3470e28a8574ac644456cf649.png",title:"Поделиться"},subscribe:{group_id:"lpmotor",title:"Подписаться"}}});lockerHeight=t.outerHeight(),t.on("unlock.sociallocker.onp",function(e,t,i){console.log("unlocked"),$.ajax({url:window.baseUrl+"sites/ajax",method:"POST",dataType:"JSON",data:{block:"activate_ref_tails"},success:function(e){if("undefined"!=typeof e.res&&1==e.res){var t=$(".success_mes");$(".activate_reftails").hide(),t.html("Спасибо за ваш репост! <br><br>Реф-хвосты будут подключены в течение часа <br>По факту подключения вам придет письмо на <b>"+e.email+"</b>"),t.fadeIn()}else alert("Ошибка #2258\nНапишите пожалуйста нам в тех-поддержку support@lpmotor.ru")}})})}},e.prototype.tryPublishSite=function(e){$.post(window.baseUrl+window.siteId+"/sites/ajax/frm:tryPublishSite",{id:window.siteId,action:"on",type:"monthly",force:0},function(t){if(t.res&&1==t.res)switch(t.mes){case"ok_site_on":$("#success_publish").modal("show"),e.onOk();break;default:jAlert("<br>Ошибка при публикации сайта [#2821]")}else if(t.mes)switch(t.mes){case"no_tarif":case"need_tarif_activate":$("#no_tarif_modal").modal("show");break;case"tarif_is_full":sitesMan.alertTarifIsFull2(t.max_sites);break;default:jAlert("<br>Необработанный ответ от сервера[#2831]")}else t.err&&jAlert("<br>"+t.err)},"JSON")},e.prototype.setIndexing=function(e){var t=e.find("#site_indexing"),i=(e.hasClass("on")?"on":"off",e.hasClass("on")?"off":"on",t.val()),n=$("#ref_follow_switch"),a=$("#ref_follow_section");$.post(window.baseUrl+window.siteId+"/sites/ajax/frm:siteindexing",{site_indexing:i},function(t){return"undefined"!=typeof t.res&&"index_on"==t.res?(n.removeClass("off").addClass("on"),void a.slideDown()):("undefined"!=typeof t.res&&"index_off"==t.res?(n.removeClass("on").addClass("off"),a.slideUp()):t.fail||t.error?1==t.fail?($("#not_published_modal").modal("show"),e.removeClass("on").addClass("off")):2==t.fail?($("#no_tarif_modal").modal("show"),e.removeClass("on").addClass("off")):alert(t.error):alert("ошибка при отключении/подключении индексирования сайта #2266"),!1)},"json")},e.prototype.watchType404=function(){"use strict";var e=$("#frmerrortype");e.on("change",function(){$.ajax({url:window.baseUrl+window.siteId+"/sites/ajax/frm:siteErrorType",method:"post",dataType:"json",data:e.serialize(),success:function(e){0==e.res?alert(e.error):showDoneBox("Включен "+e.message,{width:300,cls:"c_text"})}})})},e.prototype.setRefFollow=function(e){var t=e.find("#ref_follow").val(),i=e.hasClass("on")?"on":"off",n=e.hasClass("on")?"off":"on";$.post(window.baseUrl+window.siteId+"/sites/ajax/frm:ref_follow",{ref_follow:t},function(t){if(!t.res||1!=t.res)return t.error?alert(t.error):alert("ошибка при отключении/подключении передачи веса ссылок #2270"),e.removeClass(i).addClass(n),!1},"json")},e.prototype.publishSiteFromIndexing=function(e){ajaxLoad({url:"sites/ajax/frm:frmpublish2",data:{id:e,action:"on",type:"monthly",force:0},withCredentials:!0,onSuccess:function(e){if(1==e.res)switch(e.mes){case"ok_site_on":window.location.href=window.location.href;break;case"tarif_is_full":sitesMan.alertTarifIsFull2(e.max_sites)}}})},e.prototype.generateHTMLforPreview=function(e){var t="",i=e,n=$(".tip.small_img");n.hide();var a=$("#og_image"),o=intval(a.attr("data-orig-w")),r=intval(a.attr("data-orig-h")),s={vk:$(".btn-vk"),fb:$(".btn-facebook")};o<=500&&"vk"==i&&(i="vk_mini"),("fb"==i&&o<=400&&o>=200||r/o>3||o/r>3)&&(i="fb_mini");var l=$(".preview_window");switch(l.hide(),i){case"vk":t+='<div class="preview_window_vk clearfix" >',t=this.generatePreviewHTML(t),s.fb.removeAttr("disabled"),s.vk.attr("disabled","disabled");break;case"vk_mini":t+='<div class="preview_window_vk_mini clearfix" >',t=this.generatePreviewHTML(t),s.fb.removeAttr("disabled"),s.vk.attr("disabled","disabled");break;case"fb":t+='<div class="preview_window_fb" >',t=this.generateFbPreviewHTML(t),s.vk.removeAttr("disabled"),s.fb.attr("disabled","disabled");break;case"fb_mini":t+='<div class="preview_window_fb_mini" >',t=this.generatePreviewHTML(t),s.vk.removeAttr("disabled"),s.fb.attr("disabled","disabled")}var d=a.attr("src");"undefined"==typeof d||"fb"==i&&o<200&&r<200?(n.show(),t=strtr(t,{":SRC":"http://lpmotor.s3.amazonaws.com/6/9/a/69aed0d3470e28a8574ac644456cf649.png"})):t=strtr(t,{":SRC":d}),l.html(t),"fb"==i&&o/r>=2.1?(document.getElementsByClassName("img_wrapper")[0].style.backgroundPosition="center center",document.getElementsByClassName("img_wrapper")[0].style.backgroundSize="auto 100%"):(document.getElementsByClassName("img_wrapper")[0].style.backgroundPosition="0 50%",document.getElementsByClassName("img_wrapper")[0].style.backgroundSize="100%"),l.fadeIn()},e.prototype.generateFbPreviewHTML=function(e){var t='<div class="img_wrapper" style="background: url(:SRC)" >',i='<div class="title_wrapper" >',n='<div class="descr_wrapper" >';e+=t+"</div>";var a=$("#og_header").val();e+=i+a+"</div>";var o=$("#og_description").val();return e+=n+o+"</div>",e+="</div>"},e.prototype.generatePreviewHTML=function(e){var t='<div class="img_wrapper" >',i='<div class="title_wrapper" >',n='<div class="descr_wrapper" >',a='<img src=":SRC">';e+=t+a+"</div>";var o=$("#og_header").val();e+=i+htmlspecialchars(o)+"</div>";var r=$("#og_description").val();return e+=n+htmlspecialchars(r)+"</div>",e+="</div>"},e.prototype.bindOpengraphEvents=function(){var e="",t=this,i=$("#og_header, #og_description");i.bind("keyup keydown blur",function(i){if(13==i.keyCode&&!i.shiftKey)return i.preventDefault(),!1;var n=$(this).val(),a=$(this).attr("id");"og_header"==a&&(e=t.countMessageLength(n,70)),"og_description"==a&&(e=t.countMessageLength(n,300)),$("#"+a+"_left").text(e)}),i.trigger("blur")},e.prototype.countMessageLength=function(e,t){var i=t-e.length;return i},e.prototype.alertTarifIsFull2=function(e){jAlert("<p>На текущем тарифе вы можете запустить максимум<br/><strong>"+e+" сайт"+plural(e,"","а","ов")+'</strong>.</p><hr/><p class="fw_bold pt1" style="color: #f58f36;">Что теперь делать?</p><table class="mb2"><tr><td style="width:42%">Выключите один из сайтов, нажав на переключатель <span id="switch_example"></span> в <a href="'+window.baseUrl+'">главном меню </a>.</td><td class="vam c_text fw_bold" style="width:16%;">ИЛИ</td><td style="width:42%">Перейдите на более "мощный" тариф в разделе <a href="'+window.baseUrl+'profile/balance">Баланс </a>.</td></tr></table>',{width:550,btnWidth:200,okClass:"ibtn-green",okText:"Не сейчас",headerText:"Количество запущенных сайтов превышено"})},e.prototype.updateVariantLabels=function(e,t){$("label[for=ab_st_item_"+e+"]").find(".abtest_name_var:first").text(t),$("#variant-list-1[name=variant-list-1]").children("option[value="+e+"]").text(t)},e.prototype.confirmCloneSite=function(e,t){var i=$("#abtest__modal_copy"),n=i.find(".wrap_abtest_clone:first"),a=i.find(".wrap_integrations_clone:first"),o=i.find("#clone_integrations:first");o.prop("checked",!1),n.hide(),a.hide(),i.attr("site-id",e).wind("show"),"undefined"!=typeof t.has_abtest&&n.show(),"undefined"!=typeof t.has_int&&a.show()},e.prototype.cloneSite=function(e,t,i){var n={};n.type="ajax","undefined"!=typeof t&&(n.check_module=t),"undefined"!=typeof i&&i&&(n.check_int=1),ajaxLoad({url:e+"/sites/clone_site",data:n,withCredentials:!0,onSuccess:function(t){if(1==t.res)if("undefined"!=typeof t.check_data)sitesMan.confirmCloneSite(e,t.check_data);else switch(t.mes){case"go_to":window.location.href=t.redirect_to}}})},e.prototype.doCloneSiteSpa=function(e,t,i){var n=lockScreen("Клонирование...",{show_animation:!0});i.type="ajax",ajaxLoad({url:t,data:i,withCredentials:!0,onSuccess:function(t){if(n&&unlockScreen(n),1==t.res){if("undefined"!=typeof t.check_data)return void sitesMan.confirmCloneSite(e,t.check_data);if(isset(window.siteList)&&t.site_list_item)return void siteList.$emit("sites-list-item--created",t.site_list_item)}console.log(t),alert("Wrong response from server #4825. Watch info in console")}})},e.prototype.doCloneSite=function(){var e=$("#abtest__modal_copy"),t=e.find("#clone_integrations:first"),i=t.prop("checked"),n=e.attr("site-id"),a=n+"/sites/clone_site";if(i&&(a+="/copy_int:true"),"site_list_spa"==sitesMan.location){var o={};return o.from=sitesMan.location,sitesMan.doCloneSiteSpa(n,a,o),e.wind("hide"),!1}return window.location.href=window.baseUrl+a,!1},e.prototype.loadTextareas=function(){$(".textarea_load.need_load").each(function(e,t){var i=$(t),n=i.attr("data-id");if(n){var a=$("#textarea_data__"+n);if(a.length){var o=i.find("textarea:first");o.length&&(o.val(LpmBase64.decode(a.text())),$("#frmseo__"+n+"_allow").val("1"),i.removeClass("need_load"))}}})},e.prototype.initQuiz=function(e,t){var i=$(".quiz-form");e&&(i=e.find(".quiz-form"));var n=function(){var e=$(this);if(e.find(".user_form_fields_list .field:last").attr("pos")!==e.find(".field.active").attr("pos"))return e.find(".quiz__nav_next").trigger("click"),!1};t&&i.each(function(){sitesMan.initQuizForm($(this))}),i.find(".user_form").on("submit",n),this.enableQuizNav()},e.prototype.initQuizForm=function(e){var t=sitesMan.quizForm(e);0!==t.totalSteps&&t.totalSteps<2?(t.$btn.next.addClass("quiz__disabled"),t.$btn.submit.removeClass("quiz__disabled")):(t.$btn.next.removeClass("quiz__disabled"),t.$btn.submit.addClass("quiz__disabled")),sitesMan.toQuizStep(t,0)},e.prototype.quizForm=function(e){var t=e.find(".quiz"),i=e.find(".quiz.active"),n=e.find(".quiz__progress_container");return{$form:e,$steps:t,totalSteps:t.length,$activeStep:i,activeIndex:t.index(i),$progressContainer:n,$pSteps:{all:n.find(".quiz__progress_dot"),inactive:n.find(".quiz__progress_dot:not(.active)"),active:n.find(".quiz__progress_dot.active")},$indicator:{current:e.find("#steps_bar"),all:e.find("#all_steps")},$btn:{prev:e.find(".quiz__nav_prev"),next:e.find(".quiz__nav_next"),submit:e.find(".btn-new.ie_css3.btn-submit")},$regulation:e.find(".user_form_regulation")}};var n=function(e){var t=e.hasClass("is_required"),i=e.data("type"),n=["input[type=text]","input[type=tel]","input[type=radio]:checked","input[type=checkbox]:checked","option:not([hidden]):selected","textarea"],a=e.find(n.join(", ")),o=e.find(".ui_error"),r={required:"Это поле нужно заполнить",phone:"Телефон содержит неверные символы",email:"Введите корректный адрес электронной почты"},s=function(e){if(-1!==["fcheckbox","fradio","fselect"].indexOf(i))return 0===e.length;var t=e.val().trim();return 0===t.length||!t},l=function(e){var t=e.val().trim(),i=/^\+?[1-9]{1}[\d\s()-]*$/i;return!(t.length>0)||t.length>5&&i.test(t)},d=function(e){var t=e.val().trim(),i=/^[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i;return i.test(t)},c=function(t){FE.run("quiz-validate-error",{step:e}),o.text(t)};if(o.addClass("hidden"),t&&s(a))return o.removeClass("hidden"),c(r.required),!1;if("ftextbox"===i&&!s(a)){var u=a.closest(".field"),f=u.data("cls");if("femail"===f&&!d(a))return o.removeClass("hidden"),c(r.email),!1;if("fphone"===f&&!l(a))return o.removeClass("hidden"),c(r.phone),!1}return!0};e.prototype.nextQuiz=function(e){var t=this.quizForm(e),i=t.activeIndex+1;return!(!sitesMan.isEditor&&!0!==n(t.$activeStep))&&void sitesMan.toQuizStep(t,i)},e.prototype.prevQuiz=function(e){var t=this.quizForm(e),i=t.activeIndex-1;i<0&&(i=0),sitesMan.toQuizStep(t,i)},e.prototype.adaptQuizContent=function(e){var t=i.find(".wind-body .body_content"),n=e.$form.find(".wind-footer"),a=parseInt(n.outerHeight(!0));t.css("padding-bottom",a)},e.prototype.toQuizStep=function(e,t){var i=e.$form.find(".wind-body"),n=0===t,a=e.totalSteps-1===t,o=1===e.$form.data("is-regulation-enabled");e.$steps.removeClass("active"),e.$steps.eq(t).addClass("active"),n?e.$btn.prev.addClass("quiz__disabled"):e.$btn.prev.removeClass("quiz__disabled"),a?(e.$btn.submit.removeClass("quiz__disabled"),e.$btn.next.addClass("quiz__disabled"),o&&e.$regulation.removeClass("hidden")):(e.$btn.submit.addClass("quiz__disabled"),e.$btn.next.removeClass("quiz__disabled"),e.$regulation.addClass("hidden"));var r=e.$progressContainer.attr("data-progress-color")||"aaa";e.$pSteps.active.removeClass("active"),e.$pSteps.all.removeAttr("style"),e.$pSteps.all.eq(t).addClass("active").css("background-color","#"+r),e.$indicator.all.text(e.totalSteps),e.$indicator.current.text(t+1);var s=e.$steps.eq(t).find("input[type=text]:visible, textarea");e.activeIndex!==-1&&s.length&&s.trigger("focus"),a||($(".wrap-for-formPopover").animate({scrollTop:0},300),i.animate({scrollTop:0},300)),this.adaptQuizContent(e)},e.prototype.enableQuizNav=function(e){var t=$(".quiz__nav_next"),i=$(".quiz__nav_prev");"undefined"!=typeof e&&e.length&&(t=e.find(".quiz__nav_next"),i=e.find(".quiz__nav_prev")),t.off("click").on("click",function(){var e=$(this).closest(".user_form");sitesMan.nextQuiz(e)}),i.off("click").on("click",function(){var e=$(this).closest(".user_form");sitesMan.prevQuiz(e)})},e.prototype.initIphone=function(){var e={w:$(window).width(),h:screen.height,wC:$(window).width()/2,hC:screen.height/2},t=$("#sections_list"),i=t.find("> .is_iphone"),n={x:0,y:0};return 0!=i.length&&(i.find(".section-image").css({backgroundSize:"cover"}),void i.on("mousemove",function(t){var i=$(this).find(".section-image:first");n.x=(t.pageX-e.w+e.wC)/(e.wC/10),n.y=(t.pageY-e.h+e.hC)/(e.hC/10),i.css("transform","translate("+n.x*-.75+"px, "+n.y*-.75+"px)")}))},e.prototype.disableIphone=function(e){e.off("mousemove"),e.find(".section-image:first").css({"background-size":"",transform:""})},FE.runOnReady(function(){window.sitesMan=new e,window.sitesMan.ready(),FE.add("file_uploaded_favicon",function(e){sitesMan.faviconUploadOk(e)}),FE.add("file_uploaded_opengraph_image",function(e){sitesMan.opengraphUploadOk(e)})})}(),function(){"use strict";function e(e,t,i){this.complete=!1,this.ptr=e,this.killTimer=null,!t.shift&&t.selector&&(t=t.toArray()),this.list=t,this.ops=i||{},"undefined"==typeof this.ops.max_loading&&(this.ops.max_loading=3),"undefined"==typeof this.ops.onload_callback&&(this.ops.onload_callback=!1),n&&console.log("[ LOADER ] init",this)}var t=0,i={},n=!1;e.prototype.loadCycle=function(){if(0!=this.list.length){var e=this.list.shift(),t=$(e).find("img[data-src]");1==t.length?(t.load(function(){var e=ImgListLoader.get($(this).attr("loader-ptr")),t=ImgListLoader.isDebug();return e?(t&&console.log("[ LOADER ] image loaded",this),e.ops.onload_callback&&e.ops.onload_callback.apply(this),e.list.length>0?setTimeout("var L=ImgListLoader.get("+e.ptr+"); if (null!==L){L.loadCycle();}",1):e.complete||(e.complete=!0,t&&console.log("Loader #"+e.ptr+" completed")),void(e=null)):void console.log("[ LOADER ] not found #"+$(this).attr("loader-ptr"))}),t.attr("src",t.attr("data-src")),t.attr("loader-ptr",this.ptr),t.removeAttr("data-src")):ImgListLoader.isDebug()&&console.log("[ LOADER ] not 1 image found. ",t)}},e.prototype.run=function(){for(var e=0,t=Math.min(this.list.length,this.ops.max_loading);e<t;e++)this.loadCycle();this.killTimer=setInterval("var loader = ImgListLoader.get("+this.ptr+"); if (null!==loader && loader.complete){ ImgListLoader.kill("+this.ptr+") }",5e3)},e.prototype.removeTimer=function(){clearInterval(this.killTimer),this.killTimer=null},window.ImgListLoader={create:function(n,a){return i[++t]=new e(t,n,a),i[t]},get:function(e){return"undefined"!=typeof i[e]?i[e]:null},getAll:function(){return i},setDebug:function(e){n=e},isDebug:function(){return n},kill:function(e){"undefined"!=typeof i[e]&&(n&&console.log("[ LOADER ] kill #"+e),i[e].removeTimer(),delete i[e])}}}(),window.animManager=new FanimManager,window.animManager.ready(),function(){"use strict";function e(){this.trialInfoTpl="<br>И подключен тариф на {{trialDays}} дней",this.template='<div class="wind hidden wnd-trial-tariff" id="js-wnd-trial-tariff" tabindex="-1" style="width: 530px;">\n    <div class="wind-header">\n        <a class="wind-close">\n            <div></div>\n        </a>\n    </div>\n    <div class="wind-body">\n        <div class="clearfix wnd-trial-tariff__content">\n            <div class="wnd-trial-tariff__image"></div>\n            <div class="wnd-trial-tariff__input">                <div class="wnd-trial-tariff__text">Сайт запущен по адресу <a class="wnd-trial-tariff__link" target="_blank" href="{{siteUrl}}">{{siteUrlDecoded}}</a></div>                <div><a class="wnd-trial-tariff__link-edit" href="'+window.baseUrl+'{{siteId}}/sites/conf/tab:domains" target="_blank">адрес можно изменить в настройках</a></div>                <div class="mt3"><a class="btn btn-success btn-round wnd-trial-tariff__btn" target="_blank" href="{{siteUrl}}">Открыть сайт</a></div>            </div>\n            <div class="wnd-trial-tariff__trial-desc {{trialInfoClass}}">\n                <div class="wnd-trial-tariff__trial-desc-header">А еще вам подключен <span class="wnd-trial-tariff__trial-desc-header-hilight">пробный тариф</span> на {{trialDays}} {{trialDaysText}} ;)</div>\n                <div class="c_text mt1"><a class="wnd-trial-tariff__description-title js-wnd-trial-tariff__description-title">Зачем нужен тариф?</a></div>\n                <div class="wnd-trial-tariff__description-text js-wnd-trial-tariff__description-text wnd-trial-tariff__description-text--hidden">                Чтобы ваш сайт показывался в интернете и на него могли зайти посетители - его нужно запустить (что вы только что и сделали).                 Для запуска сайта и поддержания его в запущенном состоянии необходим подключенный тариф<br/>                Тариф - это платная улуга, которая осуществляется путем ежемесячной (или ежегодной) абонентской платы.                 В эту плату включены услуги хостинга, возможность запуска нескольких сайтов, смс-оповещения, CRM-система и много других мелочей.                 Ознакомьтесь с тарифными планами подробнее на странице Тарифов                </div>\n            </div>\n        </div>\n    </div>\n</div>',this.showModal=function(e,t){var i=$("#js-wnd-trial-tariff");i.length>0&&i.remove(),i=$(trialTariff.template.replace(/{{siteId}}/g,e.siteId).replace(/{{trialDays}}/g,e.trialDays).replace(/{{trialDaysText}}/g,plural(e.trialDays,"день","дня","дней")).replace(/{{trialInfoClass}}/g,e.trialDays&&e.trialDays>0?"wnd-trial-tariff__trial-desc--visible":"").replace(/{{siteUrl}}/g,e.siteUrl).replace(/{{siteUrlDecoded}}/g,e.siteUrlDecoded)),i.appendTo($("#wind_container")),trialTariff.initWindowEvents(),i.on("click",function(e){e.stopPropagation()}),i.wind("show");var n=function(){$(document).off("click",n),i.wind("hide")};$(document).on("click",n),i.wind("setAfterCloseFunc",function(){$(document).off("click",n),t&&(lockScreen(),window.location.href=window.location.href)})},this.toggleDescription=function(){$(".js-wnd-trial-tariff__description-text").toggleClass("wnd-trial-tariff__description-text--hidden")},this.initWindowEvents=function(){$(".js-wnd-trial-tariff__description-title").on("click",trialTariff.toggleDescription)},this.init=function(){},this.onReady=function(){consoleDbg("init: TrialTariff"),this.init(),this.ready=!0,FE.runAndClr("trialTariff/ready")},this.isReady=function(){return this.ready}}window.trialTariff=new e,window.trialTariff.onReady()}(),function(){var e={},t=ge("bs_cont_wrap");e.setBlockData=function(t){if(null==t||null==t.id)return!1;var i={},n=$(ge(t.id));if(0===n.length)return!1;var a=e.getRelatedBlockData(n,!0);if(a.blk_height==t.blk_height&&a.blk_width==t.blk_width&&a.pos_left==t.pos_left&&a.pos_top==t.pos_top&&a.rotate==t.rotate&&a.parent_id==t.parent_id)return!0;null!=t.blk_height&&(i.height=t.blk_height),null!=t.blk_width&&(i.width=t.blk_width),null!=t.pos_left&&(i.left=t.pos_left),null!=t.pos_top&&(i.top=t.pos_top),null!=t.rotate&&(i.transform=0==t.rotate?"":"rotate("+t.rotate+"deg)");var o=0,r=ge(t.section_cell_id),s=hasClass(domPN(domPN(r)),"is_absolute");a.section_cell_id!=t.section_cell_id&&(null==t.parent_id&&$(r).append(n),o=t.section_cell_id);var l=t.parent_id;if(a.parent_id!=t.parent_id){var d=null==t.parent_id?t.section_cell_id:t.parent_id,c=ge(d),u=$(c);null!=t.parent_id&&hasClass(c,"slide")&&hasClass(c,"hidden-slide")&&pages_editor.setSlide(u.closest(".blk_box_slider"),d),u.append(n),l=t.parent_id}switch(n.attr("blk_class")){case"blk_text":case"blk_image":null!=i.height&&delete i.height;break;case"blk_form":var f=n.find(".blk_form_wrap form:visible");f.length&&(i.height=f.first().get(0).offsetHeight)}n.css(i),FE.run("section/resized"),FE.run("hybrid/resized"),hybridBlockResizer.processingBlockAfterResize(n);var p=!1;if(null!=t.parent_id){var h=n.parents(".slide.hidden-slide");0!==h.length&&(p=!0,h.removeClass("hidden-slide"))}return hybridManager.saveBlockData(n,o,l),s||dndHelper.clearBlockStyles(n,!1,$(ge(t.section_cell_id)),!0),p&&h.addClass("hidden-slide"),!0},e.getBlockData=function(t){var i={id:t.attr("id"),block_name:t.attr("blk_class"),rotate:0};switch("section"!==i.block_name&&(i.rotate=e.getRotateAngle(t)),i.block_name){case"blk_yandex_map":t=t.find(".yandex_map:first");break;case"blk_button_popup":t=t.find(".blk_button_data_wrap:first a:first");break;case"blk_html":t=t.find(".blk-data:first");break;case"blk_video":t=t.find(".blk_video_data_wrap:first"),t.hasClass("empty")||(t=t.find("iframe:first"));break;case"blk_divider":t=t.find(".blk_divider_self:first");break;case"blk_text":t=t.find(".blk-data:first");break;case"blk_form":var n=t.find(".blk_form_wrap:first a.btn-form-popover:first");t=n.length>0?n:t.find(".blk_form_wrap:first form:first");break;case"blk_button":t=t.find(".blk_button_data_wrap:first a:first");break;case"blk_box_slider":t=t.find(".blk_box_slider_self:first");break;case"blk_image":case"blk_image_ext":t=t.find(".blk_image_data_wrap"),t.hasClass("empty")||(t=t.find("div.img_container:first"))}if("section"==i.block_name)i.blk_height=Math.round(t.outerHeight());else{var a=this.getPosition(t);i.pos_top=a.top,i.pos_left=a.left,i.blk_height=Math.round(t.outerHeight()),i.blk_width=Math.round(t.outerWidth())}return i},e.getRelatedBlockData=function(t,i){var n=e.getBlockData(t),a=t.parent();if(a.hasClass("slide cell")){var o=e.getRelatedBlockData(a);null!=n.pos_left&&(n.pos_left-=o.pos_left,n.pos_top-=o.pos_top)}return n.parent_id=null,n.section_cell_id=null,i&&(a.hasClass("section-cell")?n.section_cell_id=a.attr("id"):(n.parent_id=a.attr("id"),n.section_cell_id=a.closest(".section-cell").attr("id"))),n},e.getPosition=function(e){var t=e,i=0,n=0,a=!0;null==e.nodeType&&(t=e.get(0));var o=hasClass(t,"is_hidden");if(o){var r=t;removeClass(t,"is_hidden")}for(;null!=t&&!hasClass(t,"blk_section_inner");)(a||"static"!==getComputedStyle(t).getPropertyValue("position"))&&(i+=t.offsetTop,n+=t.offsetLeft,a=!1),t=domPN(t);return o&&addClass(r,"is_hidden"),{top:Math.round(i),left:Math.round(n)}},e.getRotateAngle=function(e){null==e.nodeType&&(e=e.get(0));var t=e.style.transform;return null==t||""==t?t=0:(t=/rotate\s?\((-?\d*)deg\)/.exec(t),null==t||t.length<2?t=0:(t=parseInt(t[1]),isNaN(t)&&(t=0))),t},e.getRotatedPosition=function(e,t,i){var n=0,a=0;if(0!=i){var o=Math.sqrt(Math.pow(e,2)+Math.pow(t,2));if(0!=o){var r=i-Math.atan2(t,e);n=o*Math.cos(r),a=-o*Math.sin(r)}}else n=e,a=t;return{x:n,y:a}},e.getRealOffset=function(e){for(var t=0,i=0,n=e,a=0;n&&"body"!==n.nodeName.toLowerCase()&&++a<=100;)t+=n.offsetTop-n.scrollTop,i+=n.offsetLeft-n.scrollLeft,n=n.offsetParent;return{top:t,left:i}},e.isPointInPolygon=function(e,t,i){for(var n=!1,a=e.length,o=a-1,r=0;r<a;o=r++)e[r][1]>i!=e[o][1]>i&&t<(e[o][0]-e[r][0])*(i-e[r][1])/(e[o][1]-e[r][1])+e[r][0]&&(n=!n);return n};var i=function(e,t,i,n,a,o,r,s){var l=(s-o)*(i-e)-(r-a)*(n-t);if(0==l)return!1;var d=((r-a)*(t-o)-(s-o)*(e-a))/l,c=((i-e)*(t-o)-(n-t)*(e-a))/l;return d>=0&&d<=1&&c>=0&&c<=1};e.isIntersectPolygons=function(t,n){for(var a=n.length,o=0;o<a;o++)if(e.isPointInPolygon(t,n[o][0],n[o][1]))return!0;var r=t.length;for(o=0;o<r;o++)if(e.isPointInPolygon(n,t[o][0],t[o][1]))return!0;for(o=0;o<r;o++){var s=o+1;s>=r&&(s=0);for(var l=0;l<a;l++){var d=l+1;if(d>=a&&(d=0),i(t[o][0],t[o][1],t[s][0],t[s][1],n[l][0],n[l][1],n[d][0],n[d][1]))return!0}}return!1},e.getBlockRelatedAngle=function(t){null==t.nodeType&&(t=t.get(0));for(var i=0;null!=t;)i+=e.getRotateAngle(t),t=closest(domPN(t),"blk_box_slider");return i},e.isRotatedBlock=function(t){for(;null!=t;){var i=e.getRotateAngle(t);if(0!==i)return!0;t=closest(domPN(t),"blk_box_slider")}return!1},e.getBlockPolygon=function(i,n){var a=i.getBoundingClientRect(),o=e.getBlockRelatedAngle(i);if(0===o)return[[a.x,a.y],[a.x+a.width,a.y],[a.x+a.width,a.y+a.height],[a.x,a.y+a.height]];null==n&&(n=!1);var r=0,s=0;n&&(r=t.scrollTop,s=t.scrollLeft);var l=i.offsetWidth,d=i.offsetHeight,c=l/2,u=d/2,f=Math.PI*o/180,p={x:a.x+a.width/2,y:a.y+a.height/2},h=e.getRotatedPosition(-c,u,f),m=e.getRotatedPosition(c,u,f),_=e.getRotatedPosition(c,-u,f),w=e.getRotatedPosition(-c,-u,f);return[[p.x+h.x+s,p.y-h.y+r],[p.x+m.x+s,p.y-m.y+r],[p.x+_.x+s,p.y-_.y+r],[p.x+w.x+s,p.y-w.y+r]]},e.getPolygonFromRotatedRect=function(t,i,n,a,o){var r=t/2,s=i/2,l=Math.PI*n/180,d={x:a+r,y:o+s},c=e.getRotatedPosition(-r,s,l),u=e.getRotatedPosition(r,s,l),f=e.getRotatedPosition(r,-s,l),p=e.getRotatedPosition(-r,-s,l);return[[d.x+c.x,d.y-c.y],[d.x+u.x,d.y-u.y],[d.x+f.x,d.y-f.y],[d.x+p.x,d.y-p.y]]},e.getBoundingClientRotatedRect=function(t,i,n,a,o){for(var r=e.getPolygonFromRotatedRect(t,i,n,a,o),s=r.length,l=null,d=null,c=null,u=null,f=0;f<s;f++){var p=r[f];(null===l||l>p[1])&&(l=p[1]),(null===c||c<p[1])&&(c=p[1]),(null===d||d>p[0])&&(d=p[0]),(null===u||u<p[0])&&(u=p[0])}return{top:l,left:d,width:u-d,height:c-l}},FE.runOnReady(function(){window.hybridData=e})}();